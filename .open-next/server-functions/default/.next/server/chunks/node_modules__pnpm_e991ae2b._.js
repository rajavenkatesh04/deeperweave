module.exports=[24168,(e,t,r)=>{"use strict";let n;Object.defineProperty(r,"__esModule",{value:!0}),r.parseCookie=h,r.parse=h,r.stringifyCookie=function(e,t){let r=t?.encode||encodeURIComponent,n=[];for(let t of Object.keys(e)){let i=e[t];if(void 0===i)continue;if(!s.test(t))throw TypeError(`cookie name is invalid: ${t}`);let o=r(i);if(!a.test(o))throw TypeError(`cookie val is invalid: ${i}`);n.push(`${t}=${o}`)}return n.join("; ")},r.stringifySetCookie=d,r.serialize=d,r.parseSetCookie=function(e,t){let r=t?.decode||m,n=e.length,s=f(e,0,n),a=p(e,0,s),i=-1===a?{name:"",value:r(g(e,0,s))}:{name:g(e,0,a),value:r(g(e,a+1,s))},o=s+1;for(;o<n;){let t=f(e,o,n),r=p(e,o,t),s=-1===r?g(e,o,t):g(e,o,r),a=-1===r?void 0:g(e,r+1,t);switch(s.toLowerCase()){case"httponly":i.httpOnly=!0;break;case"secure":i.secure=!0;break;case"partitioned":i.partitioned=!0;break;case"domain":i.domain=a;break;case"path":i.path=a;break;case"max-age":a&&l.test(a)&&(i.maxAge=Number(a));break;case"expires":if(!a)break;let u=new Date(a);Number.isFinite(u.valueOf())&&(i.expires=u);break;case"priority":if(!a)break;let c=a.toLowerCase();("low"===c||"medium"===c||"high"===c)&&(i.priority=c);break;case"samesite":if(!a)break;let h=a.toLowerCase();("lax"===h||"strict"===h||"none"===h)&&(i.sameSite=h)}o=t+1}return i},r.stringifySetCookie=d,r.serialize=d;let s=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,a=/^[\u0021-\u003A\u003C-\u007E]*$/,i=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,o=/^[\u0020-\u003A\u003D-\u007E]*$/,l=/^-?\d+$/,u=Object.prototype.toString,c=((n=function(){}).prototype=Object.create(null),n);function h(e,t){let r=new c,n=e.length;if(n<2)return r;let s=t?.decode||m,a=0;do{let t=p(e,a,n);if(-1===t)break;let i=f(e,a,n);if(t>i){a=e.lastIndexOf(";",t-1)+1;continue}let o=g(e,a,t);void 0===r[o]&&(r[o]=s(g(e,t+1,i))),a=i+1}while(a<n)return r}function d(e,t,r){let n="object"==typeof e?e:{...r,name:e,value:String(t)},l=("object"==typeof t?t:r)?.encode||encodeURIComponent;if(!s.test(n.name))throw TypeError(`argument name is invalid: ${n.name}`);let c=n.value?l(n.value):"";if(!a.test(c))throw TypeError(`argument val is invalid: ${n.value}`);let h=n.name+"="+c;if(void 0!==n.maxAge){if(!Number.isInteger(n.maxAge))throw TypeError(`option maxAge is invalid: ${n.maxAge}`);h+="; Max-Age="+n.maxAge}if(n.domain){if(!i.test(n.domain))throw TypeError(`option domain is invalid: ${n.domain}`);h+="; Domain="+n.domain}if(n.path){if(!o.test(n.path))throw TypeError(`option path is invalid: ${n.path}`);h+="; Path="+n.path}if(n.expires){var d;if(d=n.expires,"[object Date]"!==u.call(d)||!Number.isFinite(n.expires.valueOf()))throw TypeError(`option expires is invalid: ${n.expires}`);h+="; Expires="+n.expires.toUTCString()}if(n.httpOnly&&(h+="; HttpOnly"),n.secure&&(h+="; Secure"),n.partitioned&&(h+="; Partitioned"),n.priority)switch("string"==typeof n.priority?n.priority.toLowerCase():void 0){case"low":h+="; Priority=Low";break;case"medium":h+="; Priority=Medium";break;case"high":h+="; Priority=High";break;default:throw TypeError(`option priority is invalid: ${n.priority}`)}if(n.sameSite)switch("string"==typeof n.sameSite?n.sameSite.toLowerCase():n.sameSite){case!0:case"strict":h+="; SameSite=Strict";break;case"lax":h+="; SameSite=Lax";break;case"none":h+="; SameSite=None";break;default:throw TypeError(`option sameSite is invalid: ${n.sameSite}`)}return h}function f(e,t,r){let n=e.indexOf(";",t);return -1===n?r:n}function p(e,t,r){let n=e.indexOf("=",t);return n<r?n:-1}function g(e,t,r){let n=t,s=r;do{let t=e.charCodeAt(n);if(32!==t&&9!==t)break}while(++n<s)for(;s>n;){let t=e.charCodeAt(s-1);if(32!==t&&9!==t)break;s--}return e.slice(n,s)}function m(e){if(-1===e.indexOf("%"))return e;try{return decodeURIComponent(e)}catch(t){return e}}},8502,(e,t,r)=>{},66895,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={ActionDidNotRevalidate:function(){return a},ActionDidRevalidateDynamicOnly:function(){return o},ActionDidRevalidateStaticAndDynamic:function(){return i}};for(var s in n)Object.defineProperty(r,s,{enumerable:!0,get:n[s]});let a=0,i=1,o=2},38472,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={MutableRequestCookiesAdapter:function(){return p},ReadonlyRequestCookiesError:function(){return u},RequestCookiesAdapter:function(){return c},appendMutableCookies:function(){return f},areCookiesMutableInCurrentPhase:function(){return m},createCookiesWithMutableAccessCheck:function(){return g},getModifiedCookieValues:function(){return d},responseCookiesToRequestCookies:function(){return b}};for(var s in n)Object.defineProperty(r,s,{enumerable:!0,get:n[s]});let a=e.r(39029),i=e.r(59524),o=e.r(56704),l=e.r(66895);class u extends Error{constructor(){super("Cookies can only be modified in a Server Action or Route Handler. Read more: https://nextjs.org/docs/app/api-reference/functions/cookies#options")}static callable(){throw new u}}class c{static seal(e){return new Proxy(e,{get(e,t,r){switch(t){case"clear":case"delete":case"set":return u.callable;default:return i.ReflectAdapter.get(e,t,r)}}})}}let h=Symbol.for("next.mutated.cookies");function d(e){let t=e[h];return t&&Array.isArray(t)&&0!==t.length?t:[]}function f(e,t){let r=d(t);if(0===r.length)return!1;let n=new a.ResponseCookies(e),s=n.getAll();for(let e of r)n.set(e);for(let e of s)n.set(e);return!0}class p{static wrap(e,t){let r=new a.ResponseCookies(new Headers);for(let t of e.getAll())r.set(t);let n=[],s=new Set,u=()=>{let e=o.workAsyncStorage.getStore();if(e&&(e.pathWasRevalidated=l.ActionDidRevalidateStaticAndDynamic),n=r.getAll().filter(e=>s.has(e.name)),t){let e=[];for(let t of n){let r=new a.ResponseCookies(new Headers);r.set(t),e.push(r.toString())}t(e)}},c=new Proxy(r,{get(e,t,r){switch(t){case h:return n;case"delete":return function(...t){s.add("string"==typeof t[0]?t[0]:t[0].name);try{return e.delete(...t),c}finally{u()}};case"set":return function(...t){s.add("string"==typeof t[0]?t[0]:t[0].name);try{return e.set(...t),c}finally{u()}};default:return i.ReflectAdapter.get(e,t,r)}}});return c}}function g(e){let t=new Proxy(e.mutableCookies,{get(r,n,s){switch(n){case"delete":return function(...n){return y(e,"cookies().delete"),r.delete(...n),t};case"set":return function(...n){return y(e,"cookies().set"),r.set(...n),t};default:return i.ReflectAdapter.get(r,n,s)}}});return t}function m(e){return"action"===e.phase}function y(e,t){if(!m(e))throw new u}function b(e){let t=new a.RequestCookies(new Headers);for(let r of e.getAll())t.set(r);return t}},78774,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"createDedupedByCallsiteServerErrorLoggerDev",{enumerable:!0,get:function(){return l}});let n=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=s(void 0);if(r&&r.has(e))return r.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var o=a?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=e[i]}return n.default=e,r&&r.set(e,n),n}(e.r(35825));function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(s=function(e){return e?r:t})(e)}let a={current:null},i="function"==typeof n.cache?n.cache:e=>e,o=console.warn;function l(e){return function(...t){o(e(...t))}}i(e=>{try{o(a.current)}finally{a.current=null}})},73985,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"cookies",{enumerable:!0,get:function(){return f}});let n=e.r(38472),s=e.r(39029),a=e.r(56704),i=e.r(32319),o=e.r(2803),l=e.r(15650),u=e.r(6816),c=e.r(78774),h=e.r(6978),d=e.r(57969);function f(){let e="cookies",t=a.workAsyncStorage.getStore(),r=i.workUnitAsyncStorage.getStore();if(t){if(r&&"after"===r.phase&&!(0,h.isRequestAPICallableInsideAfter)())throw Object.defineProperty(Error(`Route ${t.route} used \`cookies()\` inside \`after()\`. This is not supported. If you need this data inside an \`after()\` callback, use \`cookies()\` outside of the callback. See more info here: https://nextjs.org/docs/canary/app/api-reference/functions/after`),"__NEXT_ERROR_CODE",{value:"E843",enumerable:!1,configurable:!0});if(t.forceStatic)return g(n.RequestCookiesAdapter.seal(new s.RequestCookies(new Headers({}))));if(t.dynamicShouldError)throw Object.defineProperty(new l.StaticGenBailoutError(`Route ${t.route} with \`dynamic = "error"\` couldn't be rendered statically because it used \`cookies()\`. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E849",enumerable:!1,configurable:!0});if(r)switch(r.type){case"cache":let a=Object.defineProperty(Error(`Route ${t.route} used \`cookies()\` inside "use cache". Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use \`cookies()\` outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`),"__NEXT_ERROR_CODE",{value:"E831",enumerable:!1,configurable:!0});throw Error.captureStackTrace(a,f),t.invalidDynamicUsageError??=a,a;case"unstable-cache":throw Object.defineProperty(Error(`Route ${t.route} used \`cookies()\` inside a function cached with \`unstable_cache()\`. Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use \`cookies()\` outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/app/api-reference/functions/unstable_cache`),"__NEXT_ERROR_CODE",{value:"E846",enumerable:!1,configurable:!0});case"prerender":var c=t,m=r;let i=p.get(m);if(i)return i;let y=(0,u.makeHangingPromise)(m.renderSignal,c.route,"`cookies()`");return p.set(m,y),y;case"prerender-client":let b="`cookies`";throw Object.defineProperty(new d.InvariantError(`${b} must not be used within a Client Component. Next.js should be preventing ${b} from being included in Client Components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E832",enumerable:!1,configurable:!0});case"prerender-ppr":return(0,o.postponeWithTracking)(t.route,e,r.dynamicTracking);case"prerender-legacy":return(0,o.throwToInterruptStaticGeneration)(e,t,r);case"prerender-runtime":return(0,o.delayUntilRuntimeStage)(r,g(r.cookies));case"private-cache":return g(r.cookies);case"request":return(0,o.trackDynamicDataInDynamicRender)(r),g((0,n.areCookiesMutableInCurrentPhase)(r)?r.userspaceMutableCookies:r.cookies)}}(0,i.throwForMissingRequestStore)(e)}e.r(84904);let p=new WeakMap;function g(e){let t=p.get(e);if(t)return t;let r=Promise.resolve(e);return p.set(e,r),r}(0,c.createDedupedByCallsiteServerErrorLoggerDev)(function(e,t){let r=e?`Route "${e}" `:"This route ";return Object.defineProperty(Error(`${r}used ${t}. \`cookies()\` returns a Promise and must be unwrapped with \`await\` or \`React.use()\` before accessing its properties. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis`),"__NEXT_ERROR_CODE",{value:"E830",enumerable:!1,configurable:!0})})},45267,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={HeadersAdapter:function(){return o},ReadonlyHeadersError:function(){return i}};for(var s in n)Object.defineProperty(r,s,{enumerable:!0,get:n[s]});let a=e.r(59524);class i extends Error{constructor(){super("Headers cannot be modified. Read more: https://nextjs.org/docs/app/api-reference/functions/headers")}static callable(){throw new i}}class o extends Headers{constructor(e){super(),this.headers=new Proxy(e,{get(t,r,n){if("symbol"==typeof r)return a.ReflectAdapter.get(t,r,n);let s=r.toLowerCase(),i=Object.keys(e).find(e=>e.toLowerCase()===s);if(void 0!==i)return a.ReflectAdapter.get(t,i,n)},set(t,r,n,s){if("symbol"==typeof r)return a.ReflectAdapter.set(t,r,n,s);let i=r.toLowerCase(),o=Object.keys(e).find(e=>e.toLowerCase()===i);return a.ReflectAdapter.set(t,o??r,n,s)},has(t,r){if("symbol"==typeof r)return a.ReflectAdapter.has(t,r);let n=r.toLowerCase(),s=Object.keys(e).find(e=>e.toLowerCase()===n);return void 0!==s&&a.ReflectAdapter.has(t,s)},deleteProperty(t,r){if("symbol"==typeof r)return a.ReflectAdapter.deleteProperty(t,r);let n=r.toLowerCase(),s=Object.keys(e).find(e=>e.toLowerCase()===n);return void 0===s||a.ReflectAdapter.deleteProperty(t,s)}})}static seal(e){return new Proxy(e,{get(e,t,r){switch(t){case"append":case"delete":case"set":return i.callable;default:return a.ReflectAdapter.get(e,t,r)}}})}merge(e){return Array.isArray(e)?e.join(", "):e}static from(e){return e instanceof Headers?e:new o(e)}append(e,t){let r=this.headers[e];"string"==typeof r?this.headers[e]=[r,t]:Array.isArray(r)?r.push(t):this.headers[e]=t}delete(e){delete this.headers[e]}get(e){let t=this.headers[e];return void 0!==t?this.merge(t):null}has(e){return void 0!==this.headers[e]}set(e,t){this.headers[e]=t}forEach(e,t){for(let[r,n]of this.entries())e.call(t,n,r,this)}*entries(){for(let e of Object.keys(this.headers)){let t=e.toLowerCase(),r=this.get(t);yield[t,r]}}*keys(){for(let e of Object.keys(this.headers)){let t=e.toLowerCase();yield t}}*values(){for(let e of Object.keys(this.headers)){let t=this.get(e);yield t}}[Symbol.iterator](){return this.entries()}}},42607,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"headers",{enumerable:!0,get:function(){return d}});let n=e.r(45267),s=e.r(56704),a=e.r(32319),i=e.r(2803),o=e.r(15650),l=e.r(6816),u=e.r(78774),c=e.r(6978),h=e.r(57969);function d(){let e="headers",t=s.workAsyncStorage.getStore(),r=a.workUnitAsyncStorage.getStore();if(t){if(r&&"after"===r.phase&&!(0,c.isRequestAPICallableInsideAfter)())throw Object.defineProperty(Error(`Route ${t.route} used \`headers()\` inside \`after()\`. This is not supported. If you need this data inside an \`after()\` callback, use \`headers()\` outside of the callback. See more info here: https://nextjs.org/docs/canary/app/api-reference/functions/after`),"__NEXT_ERROR_CODE",{value:"E839",enumerable:!1,configurable:!0});if(t.forceStatic)return p(n.HeadersAdapter.seal(new Headers({})));if(r)switch(r.type){case"cache":{let e=Object.defineProperty(Error(`Route ${t.route} used \`headers()\` inside "use cache". Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use \`headers()\` outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`),"__NEXT_ERROR_CODE",{value:"E833",enumerable:!1,configurable:!0});throw Error.captureStackTrace(e,d),t.invalidDynamicUsageError??=e,e}case"unstable-cache":throw Object.defineProperty(Error(`Route ${t.route} used \`headers()\` inside a function cached with \`unstable_cache()\`. Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use \`headers()\` outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/app/api-reference/functions/unstable_cache`),"__NEXT_ERROR_CODE",{value:"E838",enumerable:!1,configurable:!0})}if(t.dynamicShouldError)throw Object.defineProperty(new o.StaticGenBailoutError(`Route ${t.route} with \`dynamic = "error"\` couldn't be rendered statically because it used \`headers()\`. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E828",enumerable:!1,configurable:!0});if(r)switch(r.type){case"prerender":var u=t,g=r;let s=f.get(g);if(s)return s;let a=(0,l.makeHangingPromise)(g.renderSignal,u.route,"`headers()`");return f.set(g,a),a;case"prerender-client":let m="`headers`";throw Object.defineProperty(new h.InvariantError(`${m} must not be used within a client component. Next.js should be preventing ${m} from being included in client components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E693",enumerable:!1,configurable:!0});case"prerender-ppr":return(0,i.postponeWithTracking)(t.route,e,r.dynamicTracking);case"prerender-legacy":return(0,i.throwToInterruptStaticGeneration)(e,t,r);case"prerender-runtime":return(0,i.delayUntilRuntimeStage)(r,p(r.headers));case"private-cache":return p(r.headers);case"request":return(0,i.trackDynamicDataInDynamicRender)(r),p(r.headers)}}(0,a.throwForMissingRequestStore)(e)}e.r(84904);let f=new WeakMap;function p(e){let t=f.get(e);if(t)return t;let r=Promise.resolve(e);return f.set(e,r),r}(0,u.createDedupedByCallsiteServerErrorLoggerDev)(function(e,t){let r=e?`Route "${e}" `:"This route ";return Object.defineProperty(Error(`${r}used ${t}. \`headers()\` returns a Promise and must be unwrapped with \`await\` or \`React.use()\` before accessing its properties. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis`),"__NEXT_ERROR_CODE",{value:"E836",enumerable:!1,configurable:!0})})},82274,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"draftMode",{enumerable:!0,get:function(){return c}});let n=e.r(32319),s=e.r(56704),a=e.r(2803),i=e.r(78774),o=e.r(15650),l=e.r(3044),u=e.r(57969);function c(){let e=s.workAsyncStorage.getStore(),t=n.workUnitAsyncStorage.getStore();switch((!e||!t)&&(0,n.throwForMissingRequestStore)("draftMode"),t.type){case"prerender-runtime":return(0,a.delayUntilRuntimeStage)(t,h(t.draftMode,e));case"request":return h(t.draftMode,e);case"cache":case"private-cache":case"unstable-cache":let r=(0,n.getDraftModeProviderForCacheScope)(e,t);if(r)return h(r,e);case"prerender":case"prerender-client":case"prerender-ppr":case"prerender-legacy":return h(null,e);default:return t}}function h(e,t){let r=f.get(e??d);return r||Promise.resolve(new p(e))}e.r(59524);let d={},f=new WeakMap;class p{constructor(e){this._provider=e}get isEnabled(){return null!==this._provider&&this._provider.isEnabled}enable(){g("draftMode().enable()",this.enable),null!==this._provider&&this._provider.enable()}disable(){g("draftMode().disable()",this.disable),null!==this._provider&&this._provider.disable()}}function g(e,t){let r=s.workAsyncStorage.getStore(),i=n.workUnitAsyncStorage.getStore();if(r){if((null==i?void 0:i.phase)==="after")throw Object.defineProperty(Error(`Route ${r.route} used "${e}" inside \`after()\`. The enabled status of \`draftMode()\` can be read inside \`after()\` but you cannot enable or disable \`draftMode()\`. See more info here: https://nextjs.org/docs/app/api-reference/functions/after`),"__NEXT_ERROR_CODE",{value:"E845",enumerable:!1,configurable:!0});if(r.dynamicShouldError)throw Object.defineProperty(new o.StaticGenBailoutError(`Route ${r.route} with \`dynamic = "error"\` couldn't be rendered statically because it used \`${e}\`. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E553",enumerable:!1,configurable:!0});if(i)switch(i.type){case"cache":case"private-cache":{let n=Object.defineProperty(Error(`Route ${r.route} used "${e}" inside "use cache". The enabled status of \`draftMode()\` can be read in caches but you must not enable or disable \`draftMode()\` inside a cache. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`),"__NEXT_ERROR_CODE",{value:"E829",enumerable:!1,configurable:!0});throw Error.captureStackTrace(n,t),r.invalidDynamicUsageError??=n,n}case"unstable-cache":throw Object.defineProperty(Error(`Route ${r.route} used "${e}" inside a function cached with \`unstable_cache()\`. The enabled status of \`draftMode()\` can be read in caches but you must not enable or disable \`draftMode()\` inside a cache. See more info here: https://nextjs.org/docs/app/api-reference/functions/unstable_cache`),"__NEXT_ERROR_CODE",{value:"E844",enumerable:!1,configurable:!0});case"prerender":case"prerender-runtime":{let t=Object.defineProperty(Error(`Route ${r.route} used ${e} without first calling \`await connection()\`. See more info here: https://nextjs.org/docs/messages/next-prerender-sync-headers`),"__NEXT_ERROR_CODE",{value:"E126",enumerable:!1,configurable:!0});return(0,a.abortAndThrowOnSynchronousRequestDataAccess)(r.route,e,t,i)}case"prerender-client":let n="`draftMode`";throw Object.defineProperty(new u.InvariantError(`${n} must not be used within a Client Component. Next.js should be preventing ${n} from being included in Client Components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E832",enumerable:!1,configurable:!0});case"prerender-ppr":return(0,a.postponeWithTracking)(r.route,e,i.dynamicTracking);case"prerender-legacy":i.revalidate=0;let s=Object.defineProperty(new l.DynamicServerError(`Route ${r.route} couldn't be rendered statically because it used \`${e}\`. See more info here: https://nextjs.org/docs/messages/dynamic-server-error`),"__NEXT_ERROR_CODE",{value:"E558",enumerable:!1,configurable:!0});throw r.dynamicUsageDescription=e,r.dynamicUsageStack=s.stack,s;case"request":(0,a.trackDynamicDataInDynamicRender)(i)}}}(0,i.createDedupedByCallsiteServerErrorLoggerDev)(function(e,t){let r=e?`Route "${e}" `:"This route ";return Object.defineProperty(Error(`${r}used ${t}. \`draftMode()\` returns a Promise and must be unwrapped with \`await\` or \`React.use()\` before accessing its properties. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis`),"__NEXT_ERROR_CODE",{value:"E835",enumerable:!1,configurable:!0})})},57174,(e,t,r)=>{t.exports.cookies=e.r(73985).cookies,t.exports.headers=e.r(42607).headers,t.exports.draftMode=e.r(82274).draftMode},54211,(e,t,r)=>{"use strict";t.exports=e.r(43197).vendored["react-rsc"].ReactServerDOMTurbopackServer},69171,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"registerServerReference",{enumerable:!0,get:function(){return n.registerServerReference}});let n=e.r(54211)},63713,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n,s,a,i,o,l,u,c,h,d,f,p,g={AppRenderSpan:function(){return S},AppRouteRouteHandlersSpan:function(){return O},BaseServerSpan:function(){return y},LoadComponentsSpan:function(){return b},LogSpanAllowList:function(){return P},MiddlewareSpan:function(){return A},NextNodeServerSpan:function(){return v},NextServerSpan:function(){return _},NextVanillaSpanAllowlist:function(){return C},NodeSpan:function(){return T},RenderSpan:function(){return E},ResolveMetadataSpan:function(){return k},RouterSpan:function(){return R},StartServerSpan:function(){return w}};for(var m in g)Object.defineProperty(r,m,{enumerable:!0,get:g[m]});var y=((n=y||{}).handleRequest="BaseServer.handleRequest",n.run="BaseServer.run",n.pipe="BaseServer.pipe",n.getStaticHTML="BaseServer.getStaticHTML",n.render="BaseServer.render",n.renderToResponseWithComponents="BaseServer.renderToResponseWithComponents",n.renderToResponse="BaseServer.renderToResponse",n.renderToHTML="BaseServer.renderToHTML",n.renderError="BaseServer.renderError",n.renderErrorToResponse="BaseServer.renderErrorToResponse",n.renderErrorToHTML="BaseServer.renderErrorToHTML",n.render404="BaseServer.render404",n),b=((s=b||{}).loadDefaultErrorComponents="LoadComponents.loadDefaultErrorComponents",s.loadComponents="LoadComponents.loadComponents",s),_=((a=_||{}).getRequestHandler="NextServer.getRequestHandler",a.getRequestHandlerWithMetadata="NextServer.getRequestHandlerWithMetadata",a.getServer="NextServer.getServer",a.getServerRequestHandler="NextServer.getServerRequestHandler",a.createServer="createServer.createServer",a),v=((i=v||{}).compression="NextNodeServer.compression",i.getBuildId="NextNodeServer.getBuildId",i.createComponentTree="NextNodeServer.createComponentTree",i.clientComponentLoading="NextNodeServer.clientComponentLoading",i.getLayoutOrPageModule="NextNodeServer.getLayoutOrPageModule",i.generateStaticRoutes="NextNodeServer.generateStaticRoutes",i.generateFsStaticRoutes="NextNodeServer.generateFsStaticRoutes",i.generatePublicRoutes="NextNodeServer.generatePublicRoutes",i.generateImageRoutes="NextNodeServer.generateImageRoutes.route",i.sendRenderResult="NextNodeServer.sendRenderResult",i.proxyRequest="NextNodeServer.proxyRequest",i.runApi="NextNodeServer.runApi",i.render="NextNodeServer.render",i.renderHTML="NextNodeServer.renderHTML",i.imageOptimizer="NextNodeServer.imageOptimizer",i.getPagePath="NextNodeServer.getPagePath",i.getRoutesManifest="NextNodeServer.getRoutesManifest",i.findPageComponents="NextNodeServer.findPageComponents",i.getFontManifest="NextNodeServer.getFontManifest",i.getServerComponentManifest="NextNodeServer.getServerComponentManifest",i.getRequestHandler="NextNodeServer.getRequestHandler",i.renderToHTML="NextNodeServer.renderToHTML",i.renderError="NextNodeServer.renderError",i.renderErrorToHTML="NextNodeServer.renderErrorToHTML",i.render404="NextNodeServer.render404",i.startResponse="NextNodeServer.startResponse",i.route="route",i.onProxyReq="onProxyReq",i.apiResolver="apiResolver",i.internalFetch="internalFetch",i),w=((o=w||{}).startServer="startServer.startServer",o),E=((l=E||{}).getServerSideProps="Render.getServerSideProps",l.getStaticProps="Render.getStaticProps",l.renderToString="Render.renderToString",l.renderDocument="Render.renderDocument",l.createBodyResult="Render.createBodyResult",l),S=((u=S||{}).renderToString="AppRender.renderToString",u.renderToReadableStream="AppRender.renderToReadableStream",u.getBodyResult="AppRender.getBodyResult",u.fetch="AppRender.fetch",u),R=((c=R||{}).executeRoute="Router.executeRoute",c),T=((h=T||{}).runHandler="Node.runHandler",h),O=((d=O||{}).runHandler="AppRouteRouteHandlers.runHandler",d),k=((f=k||{}).generateMetadata="ResolveMetadata.generateMetadata",f.generateViewport="ResolveMetadata.generateViewport",f),A=((p=A||{}).execute="Middleware.execute",p);let C=new Set(["Middleware.execute","BaseServer.handleRequest","Render.getServerSideProps","Render.getStaticProps","AppRender.fetch","AppRender.getBodyResult","Render.renderDocument","Node.runHandler","AppRouteRouteHandlers.runHandler","ResolveMetadata.generateMetadata","ResolveMetadata.generateViewport","NextNodeServer.createComponentTree","NextNodeServer.findPageComponents","NextNodeServer.getLayoutOrPageModule","NextNodeServer.startResponse","NextNodeServer.clientComponentLoading"]),P=new Set(["NextNodeServer.findPageComponents","NextNodeServer.createComponentTree","NextNodeServer.clientComponentLoading"])},76550,(e,t,r)=>{"use strict";function n(e){return null!==e&&"object"==typeof e&&"then"in e&&"function"==typeof e.then}Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"isThenable",{enumerable:!0,get:function(){return n}})},57177,(e,t,r)=>{"use strict";let n,s;Object.defineProperty(r,"__esModule",{value:!0});var a={BubbledError:function(){return m},SpanKind:function(){return p},SpanStatusCode:function(){return f},getTracer:function(){return S},isBubbledError:function(){return y}};for(var i in a)Object.defineProperty(r,i,{enumerable:!0,get:a[i]});let o=e.r(63713),l=e.r(76550),u=process.env.NEXT_OTEL_PERFORMANCE_PREFIX;try{n=e.r(70406)}catch(t){n=e.r(87679)}let{context:c,propagation:h,trace:d,SpanStatusCode:f,SpanKind:p,ROOT_CONTEXT:g}=n;class m extends Error{constructor(e,t){super(),this.bubble=e,this.result=t}}function y(e){return"object"==typeof e&&null!==e&&e instanceof m}let b=(e,t)=>{y(t)&&t.bubble?e.setAttribute("next.bubble",!0):(t&&(e.recordException(t),e.setAttribute("error.type",t.name)),e.setStatus({code:f.ERROR,message:null==t?void 0:t.message})),e.end()},_=new Map,v=n.createContextKey("next.rootSpanId"),w=0,E={set(e,t,r){e.push({key:t,value:r})}},S=(s=new class e{getTracerInstance(){return d.getTracer("next.js","0.0.1")}getContext(){return c}getTracePropagationData(){let e=c.active(),t=[];return h.inject(e,t,E),t}getActiveScopeSpan(){return d.getSpan(null==c?void 0:c.active())}withPropagatedContext(e,t,r){let n=c.active();if(d.getSpanContext(n))return t();let s=h.extract(n,e,r);return c.with(s,t)}trace(...e){let[t,r,n]=e,{fn:s,options:a}="function"==typeof r?{fn:r,options:{}}:{fn:n,options:{...r}},i=a.spanName??t;if(!o.NextVanillaSpanAllowlist.has(t)&&"1"!==process.env.NEXT_OTEL_VERBOSE||a.hideSpan)return s();let h=this.getSpanContext((null==a?void 0:a.parentSpan)??this.getActiveScopeSpan());h||(h=(null==c?void 0:c.active())??g);let d=h.getValue(v),f="number"!=typeof d||!_.has(d),p=w++;return a.attributes={"next.span_name":i,"next.span_type":t,...a.attributes},c.with(h.setValue(v,p),()=>this.getTracerInstance().startActiveSpan(i,a,e=>{let r;u&&t&&o.LogSpanAllowList.has(t)&&(r="performance"in globalThis&&"measure"in performance?globalThis.performance.now():void 0);let n=!1,i=()=>{!n&&(n=!0,_.delete(p),r&&performance.measure(`${u}:next-${(t.split(".").pop()||"").replace(/[A-Z]/g,e=>"-"+e.toLowerCase())}`,{start:r,end:performance.now()}))};if(f&&_.set(p,new Map(Object.entries(a.attributes??{}))),s.length>1)try{return s(e,t=>b(e,t))}catch(t){throw b(e,t),t}finally{i()}try{let t=s(e);if((0,l.isThenable)(t))return t.then(t=>(e.end(),t)).catch(t=>{throw b(e,t),t}).finally(i);return e.end(),i(),t}catch(t){throw b(e,t),i(),t}}))}wrap(...e){let t=this,[r,n,s]=3===e.length?e:[e[0],{},e[1]];return o.NextVanillaSpanAllowlist.has(r)||"1"===process.env.NEXT_OTEL_VERBOSE?function(){let e=n;"function"==typeof e&&"function"==typeof s&&(e=e.apply(this,arguments));let a=arguments.length-1,i=arguments[a];if("function"!=typeof i)return t.trace(r,e,()=>s.apply(this,arguments));{let n=t.getContext().bind(c.active(),i);return t.trace(r,e,(e,t)=>(arguments[a]=function(e){return null==t||t(e),n.apply(this,arguments)},s.apply(this,arguments)))}}:s}startSpan(...e){let[t,r]=e,n=this.getSpanContext((null==r?void 0:r.parentSpan)??this.getActiveScopeSpan());return this.getTracerInstance().startSpan(t,r,n)}getSpanContext(e){return e?d.setSpan(c.active(),e):void 0}getRootSpanAttributes(){let e=c.active().getValue(v);return _.get(e)}setRootSpanAttribute(e,t){let r=c.active().getValue(v),n=_.get(r);n&&!n.has(e)&&n.set(e,t)}withSpan(e,t){let r=d.setSpan(c.active(),e);return c.with(r,t)}},()=>s)},99333,(e,t,r)=>{"use strict";let n;Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"cloneResponse",{enumerable:!0,get:function(){return a}});let s=()=>{};function a(e){if(!e.body)return[e,e];let[t,r]=e.body.tee(),s=new Response(t,{status:e.status,statusText:e.statusText,headers:e.headers});Object.defineProperty(s,"url",{value:e.url,configurable:!0,enumerable:!0,writable:!1}),n&&s.body&&n.register(s,new WeakRef(s.body));let a=new Response(r,{status:e.status,statusText:e.statusText,headers:e.headers});return Object.defineProperty(a,"url",{value:e.url,configurable:!0,enumerable:!0,writable:!1}),[s,a]}globalThis.FinalizationRegistry&&(n=new FinalizationRegistry(e=>{let t=e.deref();t&&!t.locked&&t.cancel("Response object has been garbage collected").then(s)}))},73615,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"createDedupeFetch",{enumerable:!0,get:function(){return l}});let n=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=i(void 0);if(r&&r.has(e))return r.get(e);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=s?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}return n.default=e,r&&r.set(e,n),n}(e.r(35825)),s=e.r(99333),a=e.r(57969);function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(i=function(e){return e?r:t})(e)}let o=new Set(["traceparent","tracestate"]);function l(e){let t=n.cache(e=>[]);return function(r,n){let i,l;if(n&&n.signal)return e(r,n);if("string"!=typeof r||n){let t,s="string"==typeof r||r instanceof URL?new Request(r,n):r;if("GET"!==s.method&&"HEAD"!==s.method||s.keepalive)return e(r,n);t=Array.from(s.headers.entries()).filter(([e])=>!o.has(e.toLowerCase())),l=JSON.stringify([s.method,t,s.mode,s.redirect,s.credentials,s.referrer,s.referrerPolicy,s.integrity]),i=s.url}else l='["GET",[],null,"follow",null,null,null,null]',i=r;let u=t(i);for(let e=0,t=u.length;e<t;e+=1){let[t,r]=u[e];if(t===l)return r.then(()=>{let t=u[e][2];if(!t)throw Object.defineProperty(new a.InvariantError("No cached response"),"__NEXT_ERROR_CODE",{value:"E579",enumerable:!1,configurable:!0});let[r,n]=(0,s.cloneResponse)(t);return u[e][2]=n,r})}let c=e(r,n),h=[l,c,null];return u.push(h),c.then(e=>{let[t,r]=(0,s.cloneResponse)(e);return h[2]=r,t})}}},64651,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n,s,a={CachedRouteKind:function(){return o},IncrementalCacheKind:function(){return l}};for(var i in a)Object.defineProperty(r,i,{enumerable:!0,get:a[i]});var o=((n={}).APP_PAGE="APP_PAGE",n.APP_ROUTE="APP_ROUTE",n.PAGES="PAGES",n.FETCH="FETCH",n.REDIRECT="REDIRECT",n.IMAGE="IMAGE",n),l=((s={}).APP_PAGE="APP_PAGE",s.APP_ROUTE="APP_ROUTE",s.PAGES="PAGES",s.FETCH="FETCH",s.IMAGE="IMAGE",s)},15727,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"DetachedPromise",{enumerable:!0,get:function(){return n}});class n{constructor(){let e,t;this.promise=new Promise((r,n)=>{e=r,t=n}),this.resolve=e,this.reject=t}}},3031,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"Batcher",{enumerable:!0,get:function(){return s}});let n=e.r(15727);class s{constructor(e,t=e=>e()){this.cacheKeyFn=e,this.schedulerFn=t,this.pending=new Map}static create(e){return new s(null==e?void 0:e.cacheKeyFn,null==e?void 0:e.schedulerFn)}async batch(e,t){let r=this.cacheKeyFn?await this.cacheKeyFn(e):e;if(null===r)return t({resolve:e=>Promise.resolve(e),key:e});let s=this.pending.get(r);if(s)return s;let{promise:a,resolve:i,reject:o}=new n.DetachedPromise;return this.pending.set(r,a),this.schedulerFn(async()=>{try{let r=await t({resolve:i,key:e});i(r)}catch(e){o(e)}finally{this.pending.delete(r)}}),a}}},97649,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"LRUCache",{enumerable:!0,get:function(){return a}});class n{constructor(e,t,r){this.prev=null,this.next=null,this.key=e,this.data=t,this.size=r}}class s{constructor(){this.prev=null,this.next=null}}class a{constructor(e,t,r){this.cache=new Map,this.totalSize=0,this.maxSize=e,this.calculateSize=t,this.onEvict=r,this.head=new s,this.tail=new s,this.head.next=this.tail,this.tail.prev=this.head}addToHead(e){e.prev=this.head,e.next=this.head.next,this.head.next.prev=e,this.head.next=e}removeNode(e){e.prev.next=e.next,e.next.prev=e.prev}moveToHead(e){this.removeNode(e),this.addToHead(e)}removeTail(){let e=this.tail.prev;return this.removeNode(e),e}set(e,t){let r=(null==this.calculateSize?void 0:this.calculateSize.call(this,t))??1;if(r>this.maxSize)return void console.warn("Single item size exceeds maxSize");let s=this.cache.get(e);if(s)s.data=t,this.totalSize=this.totalSize-s.size+r,s.size=r,this.moveToHead(s);else{let s=new n(e,t,r);this.cache.set(e,s),this.addToHead(s),this.totalSize+=r}for(;this.totalSize>this.maxSize&&this.cache.size>0;){let e=this.removeTail();this.cache.delete(e.key),this.totalSize-=e.size,null==this.onEvict||this.onEvict.call(this,e.key,e.data)}}has(e){return this.cache.has(e)}get(e){let t=this.cache.get(e);if(t)return this.moveToHead(t),t.data}*[Symbol.iterator](){let e=this.head.next;for(;e&&e!==this.tail;){let t=e;yield[t.key,t.data],e=e.next}}remove(e){let t=this.cache.get(e);t&&(this.removeNode(t),this.cache.delete(e),this.totalSize-=t.size)}get size(){return this.cache.size}get currentSize(){return this.totalSize}}},40764,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n,s={bgBlack:function(){return C},bgBlue:function(){return N},bgCyan:function(){return I},bgGreen:function(){return j},bgMagenta:function(){return $},bgRed:function(){return P},bgWhite:function(){return D},bgYellow:function(){return x},black:function(){return _},blue:function(){return S},bold:function(){return d},cyan:function(){return O},dim:function(){return f},gray:function(){return A},green:function(){return w},hidden:function(){return y},inverse:function(){return m},italic:function(){return p},magenta:function(){return R},purple:function(){return T},red:function(){return v},reset:function(){return h},strikethrough:function(){return b},underline:function(){return g},white:function(){return k},yellow:function(){return E}};for(var a in s)Object.defineProperty(r,a,{enumerable:!0,get:s[a]});let{env:i,stdout:o}=(null==(n=globalThis)?void 0:n.process)??{},l=i&&!i.NO_COLOR&&(i.FORCE_COLOR||(null==o?void 0:o.isTTY)&&!i.CI&&"dumb"!==i.TERM),u=(e,t,r,n)=>{let s=e.substring(0,n)+r,a=e.substring(n+t.length),i=a.indexOf(t);return~i?s+u(a,t,r,i):s+a},c=(e,t,r=e)=>l?n=>{let s=""+n,a=s.indexOf(t,e.length);return~a?e+u(s,t,r,a)+t:e+s+t}:String,h=l?e=>`\x1b[0m${e}\x1b[0m`:String,d=c("\x1b[1m","\x1b[22m","\x1b[22m\x1b[1m"),f=c("\x1b[2m","\x1b[22m","\x1b[22m\x1b[2m"),p=c("\x1b[3m","\x1b[23m"),g=c("\x1b[4m","\x1b[24m"),m=c("\x1b[7m","\x1b[27m"),y=c("\x1b[8m","\x1b[28m"),b=c("\x1b[9m","\x1b[29m"),_=c("\x1b[30m","\x1b[39m"),v=c("\x1b[31m","\x1b[39m"),w=c("\x1b[32m","\x1b[39m"),E=c("\x1b[33m","\x1b[39m"),S=c("\x1b[34m","\x1b[39m"),R=c("\x1b[35m","\x1b[39m"),T=c("\x1b[38;2;173;127;168m","\x1b[39m"),O=c("\x1b[36m","\x1b[39m"),k=c("\x1b[37m","\x1b[39m"),A=c("\x1b[90m","\x1b[39m"),C=c("\x1b[40m","\x1b[49m"),P=c("\x1b[41m","\x1b[49m"),j=c("\x1b[42m","\x1b[49m"),x=c("\x1b[43m","\x1b[49m"),N=c("\x1b[44m","\x1b[49m"),$=c("\x1b[45m","\x1b[49m"),I=c("\x1b[46m","\x1b[49m"),D=c("\x1b[47m","\x1b[49m")},59643,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={bootstrap:function(){return c},error:function(){return d},errorOnce:function(){return w},event:function(){return m},info:function(){return g},prefixes:function(){return o},ready:function(){return p},trace:function(){return y},wait:function(){return h},warn:function(){return f},warnOnce:function(){return _}};for(var s in n)Object.defineProperty(r,s,{enumerable:!0,get:n[s]});let a=e.r(40764),i=e.r(97649),o={wait:(0,a.white)((0,a.bold)("○")),error:(0,a.red)((0,a.bold)("⨯")),warn:(0,a.yellow)((0,a.bold)("⚠")),ready:"▲",info:(0,a.white)((0,a.bold)(" ")),event:(0,a.green)((0,a.bold)("✓")),trace:(0,a.magenta)((0,a.bold)("»"))},l={log:"log",warn:"warn",error:"error"};function u(e,...t){(""===t[0]||void 0===t[0])&&1===t.length&&t.shift();let r=e in l?l[e]:"log",n=o[e];0===t.length?console[r](""):1===t.length&&"string"==typeof t[0]?console[r](n+" "+t[0]):console[r](n,...t)}function c(e){console.log(e)}function h(...e){u("wait",...e)}function d(...e){u("error",...e)}function f(...e){u("warn",...e)}function p(...e){u("ready",...e)}function g(...e){u("info",...e)}function m(...e){u("event",...e)}function y(...e){u("trace",...e)}let b=new i.LRUCache(1e4,e=>e.length);function _(...e){let t=e.join(" ");b.has(t)||(b.set(t,t),f(...e))}let v=new i.LRUCache(1e4,e=>e.length);function w(...e){let t=e.join(" ");v.has(t)||(v.set(t,t),d(...e))}},2815,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"ENCODED_TAGS",{enumerable:!0,get:function(){return n}});let n={OPENING:{HTML:new Uint8Array([60,104,116,109,108]),BODY:new Uint8Array([60,98,111,100,121])},CLOSED:{HEAD:new Uint8Array([60,47,104,101,97,100,62]),BODY:new Uint8Array([60,47,98,111,100,121,62]),HTML:new Uint8Array([60,47,104,116,109,108,62]),BODY_AND_HTML:new Uint8Array([60,47,98,111,100,121,62,60,47,104,116,109,108,62])},META:{ICON_MARK:new Uint8Array([60,109,101,116,97,32,110,97,109,101,61,34,194,171,110,120,116,45,105,99,111,110,194,187,34])}}},87407,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={indexOfUint8Array:function(){return a},isEquivalentUint8Arrays:function(){return i},removeFromUint8Array:function(){return o}};for(var s in n)Object.defineProperty(r,s,{enumerable:!0,get:n[s]});function a(e,t){if(0===t.length)return 0;if(0===e.length||t.length>e.length)return -1;for(let r=0;r<=e.length-t.length;r++){let n=!0;for(let s=0;s<t.length;s++)if(e[r+s]!==t[s]){n=!1;break}if(n)return r}return -1}function i(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function o(e,t){let r=a(e,t);if(0===r)return e.subarray(t.length);if(!(r>-1))return e;{let n=new Uint8Array(e.length-t.length);return n.set(e.slice(0,r)),n.set(e.slice(r+t.length),r),n}}},52483,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"MISSING_ROOT_TAGS_ERROR",{enumerable:!0,get:function(){return n}});let n="NEXT_MISSING_ROOT_TAGS";("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},83586,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"insertBuildIdComment",{enumerable:!0,get:function(){return s}});let n="<!DOCTYPE html>";function s(e,t){return t.includes("-->")||!e.startsWith(n)?e:e.replace(n,n+"<!--"+t.slice(0,24).replace(/-/g,"_")+"-->")}},52385,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={ACTION_HEADER:function(){return i},FLIGHT_HEADERS:function(){return p},NEXT_ACTION_NOT_FOUND_HEADER:function(){return w},NEXT_ACTION_REVALIDATED_HEADER:function(){return R},NEXT_DID_POSTPONE_HEADER:function(){return y},NEXT_HMR_REFRESH_HASH_COOKIE:function(){return h},NEXT_HMR_REFRESH_HEADER:function(){return c},NEXT_HTML_REQUEST_ID_HEADER:function(){return S},NEXT_IS_PRERENDER_HEADER:function(){return v},NEXT_REQUEST_ID_HEADER:function(){return E},NEXT_REWRITTEN_PATH_HEADER:function(){return b},NEXT_REWRITTEN_QUERY_HEADER:function(){return _},NEXT_ROUTER_PREFETCH_HEADER:function(){return l},NEXT_ROUTER_SEGMENT_PREFETCH_HEADER:function(){return u},NEXT_ROUTER_STALE_TIME_HEADER:function(){return m},NEXT_ROUTER_STATE_TREE_HEADER:function(){return o},NEXT_RSC_UNION_QUERY:function(){return g},NEXT_URL:function(){return d},RSC_CONTENT_TYPE_HEADER:function(){return f},RSC_HEADER:function(){return a}};for(var s in n)Object.defineProperty(r,s,{enumerable:!0,get:n[s]});let a="rsc",i="next-action",o="next-router-state-tree",l="next-router-prefetch",u="next-router-segment-prefetch",c="next-hmr-refresh",h="__next_hmr_refresh_hash__",d="next-url",f="text/x-component",p=[a,o,l,c,u],g="_rsc",m="x-nextjs-stale-time",y="x-nextjs-postponed",b="x-nextjs-rewritten-path",_="x-nextjs-rewritten-query",v="x-nextjs-prerender",w="x-nextjs-action-not-found",E="x-nextjs-request-id",S="x-nextjs-html-request-id",R="x-action-revalidated";("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},66557,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={djb2Hash:function(){return a},hexHash:function(){return i}};for(var s in n)Object.defineProperty(r,s,{enumerable:!0,get:n[s]});function a(e){let t=5381;for(let r=0;r<e.length;r++)t=(t<<5)+t+e.charCodeAt(r)|0;return t>>>0}function i(e){return a(e).toString(36).slice(0,5)}},21055,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"computeCacheBustingSearchParam",{enumerable:!0,get:function(){return s}});let n=e.r(66557);function s(e,t,r,s){return(void 0===e||"0"===e)&&void 0===t&&void 0===r&&void 0===s?"":(0,n.hexHash)([e||"0",t||"0",r||"0",s||"0"].join(","))}},66469,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={chainStreams:function(){return y},continueDynamicHTMLResume:function(){return U},continueDynamicPrerender:function(){return $},continueFizzStream:function(){return N},continueStaticFallbackPrerender:function(){return D},continueStaticPrerender:function(){return I},createBufferedTransformStream:function(){return R},createDocumentClosingStream:function(){return M},createRootLayoutValidatorStream:function(){return x},renderToInitialFizzStream:function(){return O},streamFromBuffer:function(){return _},streamFromString:function(){return b},streamToBuffer:function(){return E},streamToString:function(){return S},streamToUint8Array:function(){return w}};for(var s in n)Object.defineProperty(r,s,{enumerable:!0,get:n[s]});let a=e.r(57177),i=e.r(63713),o=e.r(15727),l=e.r(46961),u=e.r(2815),c=e.r(87407),h=e.r(52483),d=e.r(83586),f=e.r(52385),p=e.r(21055);function g(){}let m=new TextEncoder;function y(...e){if(0===e.length)return new ReadableStream({start(e){e.close()}});if(1===e.length)return e[0];let{readable:t,writable:r}=new TransformStream,n=e[0].pipeTo(r,{preventClose:!0}),s=1;for(;s<e.length-1;s++){let t=e[s];n=n.then(()=>t.pipeTo(r,{preventClose:!0}))}let a=e[s];return(n=n.then(()=>a.pipeTo(r))).catch(g),t}function b(e){return new ReadableStream({start(t){t.enqueue(m.encode(e)),t.close()}})}function _(e){return new ReadableStream({start(t){t.enqueue(e),t.close()}})}async function v(e){let t=e.getReader(),r=[];for(;;){let{done:e,value:n}=await t.read();if(e)break;r.push(n)}return r}async function w(e){var t=await v(e);let r=new Uint8Array(t.reduce((e,t)=>e+t.length,0)),n=0;for(let e of t)r.set(e,n),n+=e.length;return r}async function E(e){return Buffer.concat(await v(e))}async function S(e,t){let r=new TextDecoder("utf-8",{fatal:!0}),n="";for await(let s of e){if(null==t?void 0:t.aborted)return n;n+=r.decode(s,{stream:!0})}return n+r.decode()}function R(e={}){let t,{maxBufferByteLength:r=1/0}=e,n=[],s=0,a=e=>{try{if(0===n.length)return;let t=new Uint8Array(s),r=0;for(let e=0;e<n.length;e++){let s=n[e];t.set(s,r),r+=s.byteLength}n.length=0,s=0,e.enqueue(t)}catch{}};return new TransformStream({transform(e,i){n.push(e),(s+=e.byteLength)>=r?a(i):(e=>{if(t)return;let r=new o.DetachedPromise;t=r,(0,l.scheduleImmediate)(()=>{try{a(e)}finally{t=void 0,r.resolve()}})})(i)},flush:()=>null==t?void 0:t.promise})}function T(e,t){let r=!1;return new TransformStream({transform(n,s){if(e&&!r){r=!0;let e=new TextDecoder("utf-8",{fatal:!0}).decode(n,{stream:!0}),a=(0,d.insertBuildIdComment)(e,t);s.enqueue(m.encode(a));return}s.enqueue(n)}})}function O({ReactDOMServer:e,element:t,streamOptions:r}){return(0,a.getTracer)().trace(i.AppRenderSpan.renderToReadableStream,async()=>e.renderToReadableStream(t,r))}function k(e){let t=-1,r=!1;return new TransformStream({async transform(n,s){let a=-1,i=-1;if(t++,r)return void s.enqueue(n);let o=0;if(-1===a){if(-1===(a=(0,c.indexOfUint8Array)(n,u.ENCODED_TAGS.META.ICON_MARK)))return void s.enqueue(n);47===n[a+(o=u.ENCODED_TAGS.META.ICON_MARK.length)]?o+=2:o++}if(0===t){if(i=(0,c.indexOfUint8Array)(n,u.ENCODED_TAGS.CLOSED.HEAD),-1!==a){if(a<i){let e=new Uint8Array(n.length-o);e.set(n.subarray(0,a)),e.set(n.subarray(a+o),a),n=e}else{let t=await e(),r=m.encode(t),s=r.length,i=new Uint8Array(n.length-o+s);i.set(n.subarray(0,a)),i.set(r,a),i.set(n.subarray(a+o),a+s),n=i}r=!0}}else{let t=await e(),s=m.encode(t),i=s.length,l=new Uint8Array(n.length-o+i);l.set(n.subarray(0,a)),l.set(s,a),l.set(n.subarray(a+o),a+i),n=l,r=!0}s.enqueue(n)}})}function A(e){let t=!1,r=!1;return new TransformStream({async transform(n,s){r=!0;let a=await e();if(t){if(a){let e=m.encode(a);s.enqueue(e)}s.enqueue(n)}else{let e=(0,c.indexOfUint8Array)(n,u.ENCODED_TAGS.CLOSED.HEAD);if(-1!==e){if(a){let t=m.encode(a),r=new Uint8Array(n.length+t.length);r.set(n.slice(0,e)),r.set(t,e),r.set(n.slice(e),e+t.length),s.enqueue(r)}else s.enqueue(n);t=!0}else a&&s.enqueue(m.encode(a)),s.enqueue(n),t=!0}},async flush(t){if(r){let r=await e();r&&t.enqueue(m.encode(r))}}})}function C(e,t){let r=!1,n=null,s=!1;function a(e){return n||(n=i(e)),n}async function i(n){let a=e.getReader();t&&await (0,l.atLeastOneTask)();try{for(;;){let{done:e,value:i}=await a.read();if(e){s=!0;return}t||r||await (0,l.atLeastOneTask)(),n.enqueue(i)}}catch(e){n.error(e)}}return new TransformStream({start(e){t||a(e)},transform(e,r){r.enqueue(e),t&&a(r)},flush(e){if(r=!0,!s)return a(e)}})}let P="</body></html>";function j(){let e=!1;return new TransformStream({transform(t,r){if(e)return r.enqueue(t);let n=(0,c.indexOfUint8Array)(t,u.ENCODED_TAGS.CLOSED.BODY_AND_HTML);if(n>-1){if(e=!0,t.length===u.ENCODED_TAGS.CLOSED.BODY_AND_HTML.length)return;let s=t.slice(0,n);if(r.enqueue(s),t.length>u.ENCODED_TAGS.CLOSED.BODY_AND_HTML.length+n){let e=t.slice(n+u.ENCODED_TAGS.CLOSED.BODY_AND_HTML.length);r.enqueue(e)}}else r.enqueue(t)},flush(e){e.enqueue(u.ENCODED_TAGS.CLOSED.BODY_AND_HTML)}})}function x(){let e=!1,t=!1;return new TransformStream({async transform(r,n){!e&&(0,c.indexOfUint8Array)(r,u.ENCODED_TAGS.OPENING.HTML)>-1&&(e=!0),!t&&(0,c.indexOfUint8Array)(r,u.ENCODED_TAGS.OPENING.BODY)>-1&&(t=!0),n.enqueue(r)},flush(r){let n=[];e||n.push("html"),t||n.push("body"),n.length&&r.enqueue(m.encode(`<html id="__next_error__">
            <template
              data-next-error-message="Missing ${n.map(e=>`<${e}>`).join(n.length>1?" and ":"")} tags in the root layout.
Read more at https://nextjs.org/docs/messages/missing-root-layout-tags"
              data-next-error-digest="${h.MISSING_ROOT_TAGS_ERROR}"
              data-next-error-stack=""
            ></template>
          `))}})}async function N(e,{suffix:t,inlinedDataStream:r,isStaticGeneration:n,isBuildTimePrerendering:s,buildId:a,getServerInsertedHTML:i,getServerInsertedMetadata:u,validateRootLayout:c}){let h,d,f=t?t.split(P,1)[0]:null;n?await e.allReady:await (0,l.waitAtLeastOneReactRenderTask)();var p=[R(),T(s,a),k(u),null!=f&&f.length>0?(d=!1,new TransformStream({transform(e,t){if(t.enqueue(e),!d){let e;d=!0,h=e=new o.DetachedPromise,(0,l.scheduleImmediate)(()=>{try{t.enqueue(m.encode(f))}catch{}finally{h=void 0,e.resolve()}})}},flush(e){if(h)return h.promise;d||e.enqueue(m.encode(f))}})):null,r?C(r,!0):null,c?x():null,j(),A(i)];let g=e;for(let e of p)e&&(g=g.pipeThrough(e));return g}async function $(e,{getServerInsertedHTML:t,getServerInsertedMetadata:r}){return e.pipeThrough(R()).pipeThrough(new TransformStream({transform(e,t){(0,c.isEquivalentUint8Arrays)(e,u.ENCODED_TAGS.CLOSED.BODY_AND_HTML)||(0,c.isEquivalentUint8Arrays)(e,u.ENCODED_TAGS.CLOSED.BODY)||(0,c.isEquivalentUint8Arrays)(e,u.ENCODED_TAGS.CLOSED.HTML)||(e=(0,c.removeFromUint8Array)(e,u.ENCODED_TAGS.CLOSED.BODY),e=(0,c.removeFromUint8Array)(e,u.ENCODED_TAGS.CLOSED.HTML),t.enqueue(e))}})).pipeThrough(A(t)).pipeThrough(k(r))}async function I(e,{inlinedDataStream:t,getServerInsertedHTML:r,getServerInsertedMetadata:n,isBuildTimePrerendering:s,buildId:a}){return e.pipeThrough(R()).pipeThrough(T(s,a)).pipeThrough(A(r)).pipeThrough(k(n)).pipeThrough(C(t,!0)).pipeThrough(j())}async function D(e,{inlinedDataStream:t,getServerInsertedHTML:r,getServerInsertedMetadata:n,isBuildTimePrerendering:s,buildId:a}){let i,o,l,h;return e.pipeThrough(R()).pipeThrough(T(s,a)).pipeThrough(A(r)).pipeThrough((i=(0,p.computeCacheBustingSearchParam)("1","/_full",void 0,void 0),o=`${f.NEXT_RSC_UNION_QUERY}=${i}`,l=`<script>__NEXT_CLIENT_RESUME=fetch(location.pathname+'?${o}',{credentials:'same-origin',headers:{'${f.RSC_HEADER}': '1','${f.NEXT_ROUTER_PREFETCH_HEADER}': '1','${f.NEXT_ROUTER_SEGMENT_PREFETCH_HEADER}': '/_full'}})</script>`,h=!1,new TransformStream({transform(e,t){if(h)return void t.enqueue(e);let r=(0,c.indexOfUint8Array)(e,u.ENCODED_TAGS.CLOSED.HEAD);if(-1===r)return void t.enqueue(e);let n=m.encode(l),s=new Uint8Array(e.length+n.length);s.set(e.slice(0,r)),s.set(n,r),s.set(e.slice(r),r+n.length),t.enqueue(s),h=!0}}))).pipeThrough(k(n)).pipeThrough(C(t,!0)).pipeThrough(j())}async function U(e,{delayDataUntilFirstHtmlChunk:t,inlinedDataStream:r,getServerInsertedHTML:n,getServerInsertedMetadata:s}){return e.pipeThrough(R()).pipeThrough(A(n)).pipeThrough(k(s)).pipeThrough(C(r,t)).pipeThrough(j())}function M(){return b(P)}},72446,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={NEXT_REQUEST_META:function(){return a},addRequestMeta:function(){return l},getRequestMeta:function(){return i},removeRequestMeta:function(){return u},setRequestMeta:function(){return o}};for(var s in n)Object.defineProperty(r,s,{enumerable:!0,get:n[s]});let a=Symbol.for("NextInternalRequestMeta");function i(e,t){let r=e[a]||{};return"string"==typeof t?r[t]:r}function o(e,t){return e[a]=t,t}function l(e,t,r){let n=i(e);return n[t]=r,o(e,n)}function u(e,t){let r=i(e);return delete r[t],o(e,r)}},31459,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={isNodeNextRequest:function(){return o},isNodeNextResponse:function(){return l},isWebNextRequest:function(){return a},isWebNextResponse:function(){return i}};for(var s in n)Object.defineProperty(r,s,{enumerable:!0,get:n[s]});let a=e=>!1,i=e=>!1,o=e=>!0,l=e=>!0},94305,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={NextRequestAdapter:function(){return f},ResponseAborted:function(){return c},ResponseAbortedName:function(){return u},createAbortController:function(){return h},signalFromNodeResponse:function(){return d}};for(var s in n)Object.defineProperty(r,s,{enumerable:!0,get:n[s]});let a=e.r(72446),i=e.r(79668),o=e.r(99337),l=e.r(31459),u="ResponseAborted";class c extends Error{constructor(...e){super(...e),this.name=u}}function h(e){let t=new AbortController;return e.once("close",()=>{e.writableFinished||t.abort(new c)}),t}function d(e){let{errored:t,destroyed:r}=e;if(t||r)return AbortSignal.abort(t??new c);let{signal:n}=h(e);return n}class f{static fromBaseNextRequest(e,t){if((0,l.isNodeNextRequest)(e))return f.fromNodeNextRequest(e,t);throw Object.defineProperty(Error("Invariant: Unsupported NextRequest type"),"__NEXT_ERROR_CODE",{value:"E345",enumerable:!1,configurable:!0})}static fromNodeNextRequest(e,t){let r,n=null;if("GET"!==e.method&&"HEAD"!==e.method&&e.body&&(n=e.body),e.url.startsWith("http"))r=new URL(e.url);else{let t=(0,a.getRequestMeta)(e,"initURL");r=t&&t.startsWith("http")?new URL(e.url,t):new URL(e.url,"http://n")}return new o.NextRequest(r,{method:e.method,headers:(0,i.fromNodeOutgoingHttpHeaders)(e.headers),duplex:"half",signal:t,...t.aborted?{}:{body:n}})}static fromWebNextRequest(e){let t=null;return"GET"!==e.method&&"HEAD"!==e.method&&(t=e.body),new o.NextRequest(e.url,{method:e.method,headers:(0,i.fromNodeOutgoingHttpHeaders)(e.headers),duplex:"half",signal:e.request.signal,...e.request.signal.aborted?{}:{body:t}})}}},62267,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={getClientComponentLoaderMetrics:function(){return u},wrapClientComponentLoader:function(){return l}};for(var s in n)Object.defineProperty(r,s,{enumerable:!0,get:n[s]});let a=0,i=0,o=0;function l(e){return"performance"in globalThis?{require:(...t)=>{let r=performance.now();0===a&&(a=r);try{return o+=1,e.__next_app__.require(...t)}finally{i+=performance.now()-r}},loadChunk:(...t)=>{let r=performance.now(),n=e.__next_app__.loadChunk(...t);return n.finally(()=>{i+=performance.now()-r}),n}}:e.__next_app__}function u(e={}){let t=0===a?void 0:{clientComponentLoadStart:a,clientComponentLoadTimes:i,clientComponentLoadCount:o};return e.reset&&(a=0,i=0,o=0),t}},15434,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={isAbortError:function(){return c},pipeToNodeResponse:function(){return h}};for(var s in n)Object.defineProperty(r,s,{enumerable:!0,get:n[s]});let a=e.r(94305),i=e.r(15727),o=e.r(57177),l=e.r(63713),u=e.r(62267);function c(e){return(null==e?void 0:e.name)==="AbortError"||(null==e?void 0:e.name)===a.ResponseAbortedName}async function h(e,t,r){try{let{errored:n,destroyed:s}=t;if(n||s)return;let c=(0,a.createAbortController)(t),h=function(e,t){let r=!1,n=new i.DetachedPromise;function s(){n.resolve()}e.on("drain",s),e.once("close",()=>{e.off("drain",s),n.resolve()});let a=new i.DetachedPromise;return e.once("finish",()=>{a.resolve()}),new WritableStream({write:async t=>{if(!r){if(r=!0,"performance"in globalThis&&process.env.NEXT_OTEL_PERFORMANCE_PREFIX){let e=(0,u.getClientComponentLoaderMetrics)();e&&performance.measure(`${process.env.NEXT_OTEL_PERFORMANCE_PREFIX}:next-client-component-loading`,{start:e.clientComponentLoadStart,end:e.clientComponentLoadStart+e.clientComponentLoadTimes})}e.flushHeaders(),(0,o.getTracer)().trace(l.NextNodeServerSpan.startResponse,{spanName:"start response"},()=>void 0)}try{let r=e.write(t);"flush"in e&&"function"==typeof e.flush&&e.flush(),r||(await n.promise,n=new i.DetachedPromise)}catch(t){throw e.end(),Object.defineProperty(Error("failed to write chunk to response",{cause:t}),"__NEXT_ERROR_CODE",{value:"E321",enumerable:!1,configurable:!0})}},abort:t=>{e.writableFinished||e.destroy(t)},close:async()=>{if(t&&await t,!e.writableFinished)return e.end(),a.promise}})}(t,r);await e.pipeTo(h,{signal:c.signal})}catch(e){if(c(e))return;throw Object.defineProperty(Error("failed to pipe response",{cause:e}),"__NEXT_ERROR_CODE",{value:"E180",enumerable:!1,configurable:!0})}}},56850,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"default",{enumerable:!0,get:function(){return i}});let n=e.r(66469),s=e.r(15434),a=e.r(57969);class i{static #e=this.EMPTY=new i(null,{metadata:{},contentType:null});static fromStatic(e,t){return new i(e,{metadata:{},contentType:t})}constructor(e,{contentType:t,waitUntil:r,metadata:n}){this.response=e,this.contentType=t,this.metadata=n,this.waitUntil=r}assignMetadata(e){Object.assign(this.metadata,e)}get isNull(){return null===this.response}get isDynamic(){return"string"!=typeof this.response}toUnchunkedString(e=!1){if(null===this.response)return"";if("string"!=typeof this.response){if(!e)throw Object.defineProperty(new a.InvariantError("dynamic responses cannot be unchunked. This is a bug in Next.js"),"__NEXT_ERROR_CODE",{value:"E732",enumerable:!1,configurable:!0});return(0,n.streamToString)(this.readable)}return this.response}get readable(){return null===this.response?new ReadableStream({start(e){e.close()}}):"string"==typeof this.response?(0,n.streamFromString)(this.response):Buffer.isBuffer(this.response)?(0,n.streamFromBuffer)(this.response):Array.isArray(this.response)?(0,n.chainStreams)(...this.response):this.response}coerce(){return null===this.response?[]:"string"==typeof this.response?[(0,n.streamFromString)(this.response)]:Array.isArray(this.response)?this.response:Buffer.isBuffer(this.response)?[(0,n.streamFromBuffer)(this.response)]:[this.response]}unshift(e){this.response=this.coerce(),this.response.unshift(e)}push(e){this.response=this.coerce(),this.response.push(e)}async pipeTo(e){try{await this.readable.pipeTo(e,{preventClose:!0}),this.waitUntil&&await this.waitUntil,await e.close()}catch(t){if((0,s.isAbortError)(t))return void await e.abort(t);throw t}}async pipeToNodeResponse(e){await (0,s.pipeToNodeResponse)(this.readable,e,this.waitUntil)}}},86170,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"RouteKind",{enumerable:!0,get:function(){return s}});var n,s=((n={}).PAGES="PAGES",n.PAGES_API="PAGES_API",n.APP_PAGE="APP_PAGE",n.APP_ROUTE="APP_ROUTE",n.IMAGE="IMAGE",n)},43322,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n,s={fromResponseCacheEntry:function(){return c},routeKindToIncrementalCacheKind:function(){return d},toResponseCacheEntry:function(){return h}};for(var a in s)Object.defineProperty(r,a,{enumerable:!0,get:s[a]});let i=e.r(64651),o=(n=e.r(56850))&&n.__esModule?n:{default:n},l=e.r(86170),u=e.r(61599);async function c(e){var t,r;return{...e,value:(null==(t=e.value)?void 0:t.kind)===i.CachedRouteKind.PAGES?{kind:i.CachedRouteKind.PAGES,html:await e.value.html.toUnchunkedString(!0),pageData:e.value.pageData,headers:e.value.headers,status:e.value.status}:(null==(r=e.value)?void 0:r.kind)===i.CachedRouteKind.APP_PAGE?{kind:i.CachedRouteKind.APP_PAGE,html:await e.value.html.toUnchunkedString(!0),postponed:e.value.postponed,rscData:e.value.rscData,headers:e.value.headers,status:e.value.status,segmentData:e.value.segmentData}:e.value}}async function h(e){var t,r;return e?{isMiss:e.isMiss,isStale:e.isStale,cacheControl:e.cacheControl,value:(null==(t=e.value)?void 0:t.kind)===i.CachedRouteKind.PAGES?{kind:i.CachedRouteKind.PAGES,html:o.default.fromStatic(e.value.html,u.HTML_CONTENT_TYPE_HEADER),pageData:e.value.pageData,headers:e.value.headers,status:e.value.status}:(null==(r=e.value)?void 0:r.kind)===i.CachedRouteKind.APP_PAGE?{kind:i.CachedRouteKind.APP_PAGE,html:o.default.fromStatic(e.value.html,u.HTML_CONTENT_TYPE_HEADER),rscData:e.value.rscData,headers:e.value.headers,status:e.value.status,postponed:e.value.postponed,segmentData:e.value.segmentData}:e.value}:null}function d(e){switch(e){case l.RouteKind.PAGES:return i.IncrementalCacheKind.PAGES;case l.RouteKind.APP_PAGE:return i.IncrementalCacheKind.APP_PAGE;case l.RouteKind.IMAGE:return i.IncrementalCacheKind.IMAGE;case l.RouteKind.APP_ROUTE:return i.IncrementalCacheKind.APP_ROUTE;case l.RouteKind.PAGES_API:throw Object.defineProperty(Error(`Unexpected route kind ${e}`),"__NEXT_ERROR_CODE",{value:"E64",enumerable:!1,configurable:!0});default:return e}}},38983,(e,t,r)=>{"use strict";var n,s;Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"default",{enumerable:!0,get:function(){return g}});let a=e.r(3031),i=e.r(97649),o=e.r(59643),l=e.r(46961),u=e.r(43322);function c(e,t){if(!e)return t;let r=parseInt(e,10);return Number.isFinite(r)&&r>0?r:t}n=e.r(64651),s=r,Object.keys(n).forEach(function(e){"default"===e||Object.prototype.hasOwnProperty.call(s,e)||Object.defineProperty(s,e,{enumerable:!0,get:function(){return n[e]}})});let h=c(process.env.NEXT_PRIVATE_RESPONSE_CACHE_TTL,1e4),d=c(process.env.NEXT_PRIVATE_RESPONSE_CACHE_MAX_SIZE,150),f="__ttl_sentinel__";function p(e,t){return`${e}\0${t??f}`}class g{constructor(e,t=d,r=h){this.getBatcher=a.Batcher.create({cacheKeyFn:({key:e,isOnDemandRevalidate:t})=>`${e}-${t?"1":"0"}`,schedulerFn:l.scheduleOnNextTick}),this.revalidateBatcher=a.Batcher.create({schedulerFn:l.scheduleOnNextTick}),this.evictedInvocationIDs=new Set,this.minimal_mode=e,this.maxSize=t,this.ttl=r,this.cache=new i.LRUCache(t,void 0,e=>{let t=function(e){let t=e.lastIndexOf("\0");if(-1===t)return;let r=e.slice(t+1);return r===f?void 0:r}(e);if(t){if(this.evictedInvocationIDs.size>=100){let e=this.evictedInvocationIDs.values().next().value;e&&this.evictedInvocationIDs.delete(e)}this.evictedInvocationIDs.add(t)}})}async get(e,t,r){if(!e)return t({hasResolved:!1,previousCacheEntry:null});if(this.minimal_mode){let t=p(e,r.invocationID),n=this.cache.get(t);if(n){if(void 0!==r.invocationID)return(0,u.toResponseCacheEntry)(n.entry);let e=Date.now();if(n.expiresAt>e)return(0,u.toResponseCacheEntry)(n.entry);this.cache.remove(t)}r.invocationID&&this.evictedInvocationIDs.has(r.invocationID)&&(0,o.warnOnce)(`Response cache entry was evicted for invocation ${r.invocationID}. Consider increasing NEXT_PRIVATE_RESPONSE_CACHE_MAX_SIZE (current: ${this.maxSize}).`)}let{incrementalCache:n,isOnDemandRevalidate:s=!1,isFallback:a=!1,isRoutePPREnabled:i=!1,isPrefetch:l=!1,waitUntil:c,routeKind:h,invocationID:d}=r,f=await this.getBatcher.batch({key:e,isOnDemandRevalidate:s},({resolve:r})=>{let o=this.handleGet(e,t,{incrementalCache:n,isOnDemandRevalidate:s,isFallback:a,isRoutePPREnabled:i,isPrefetch:l,routeKind:h,invocationID:d},r);return c&&c(o),o});return(0,u.toResponseCacheEntry)(f)}async handleGet(e,t,r,n){let s=null,a=!1;try{if((s=this.minimal_mode?null:await r.incrementalCache.get(e,{kind:(0,u.routeKindToIncrementalCacheKind)(r.routeKind),isRoutePPREnabled:r.isRoutePPREnabled,isFallback:r.isFallback}))&&!r.isOnDemandRevalidate&&(n(s),a=!0,!s.isStale||r.isPrefetch))return s;let i=await this.revalidate(e,r.incrementalCache,r.isRoutePPREnabled,r.isFallback,t,s,null!==s&&!r.isOnDemandRevalidate,void 0,r.invocationID);if(!i){if(this.minimal_mode){let t=p(e,r.invocationID);this.cache.remove(t)}return null}return r.isOnDemandRevalidate,i}catch(e){if(a)return console.error(e),null;throw e}}async revalidate(e,t,r,n,s,a,i,o,l){return this.revalidateBatcher.batch(e,()=>{let u=this.handleRevalidate(e,t,r,n,s,a,i,l);return o&&o(u),u})}async handleRevalidate(e,t,r,n,s,a,i,o){try{let l=await s({hasResolved:i,previousCacheEntry:a,isRevalidating:!0});if(!l)return null;let c=await (0,u.fromResponseCacheEntry)({...l,isMiss:!a});if(c.cacheControl)if(this.minimal_mode){let t=p(e,o);this.cache.set(t,{entry:c,expiresAt:Date.now()+this.ttl})}else await t.set(e,c.value,{cacheControl:c.cacheControl,isRoutePPREnabled:r,isFallback:n});return c}catch(s){if(null==a?void 0:a.cacheControl){let s=Math.min(Math.max(a.cacheControl.revalidate||3,3),30),i=void 0===a.cacheControl.expire?void 0:Math.max(s+3,a.cacheControl.expire);await t.set(e,a.value,{cacheControl:{revalidate:s,expire:i},isRoutePPREnabled:r,isFallback:n})}throw s}}}},73663,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={NEXT_PATCH_SYMBOL:function(){return p},createPatchedFetcher:function(){return v},patchFetch:function(){return w},validateRevalidate:function(){return g},validateTags:function(){return m}};for(var s in n)Object.defineProperty(r,s,{enumerable:!0,get:n[s]});let a=e.r(63713),i=e.r(57177),o=e.r(61599),l=e.r(2803),u=e.r(6816),c=e.r(73615),h=e.r(32319),d=e.r(38983),f=e.r(99333);e.r(84904);let p=Symbol.for("next-patch");function g(e,t){try{let r;if(!1===e)r=o.INFINITE_CACHE;else if("number"==typeof e&&!isNaN(e)&&e>-1)r=e;else if(void 0!==e)throw Object.defineProperty(Error(`Invalid revalidate value "${e}" on "${t}", must be a non-negative number or false`),"__NEXT_ERROR_CODE",{value:"E179",enumerable:!1,configurable:!0});return r}catch(e){if(e instanceof Error&&e.message.includes("Invalid revalidate"))throw e;return}}function m(e,t){let r=[],n=[];for(let s=0;s<e.length;s++){let a=e[s];if("string"!=typeof a?n.push({tag:a,reason:"invalid type, must be a string"}):a.length>o.NEXT_CACHE_TAG_MAX_LENGTH?n.push({tag:a,reason:`exceeded max length of ${o.NEXT_CACHE_TAG_MAX_LENGTH}`}):r.push(a),r.length>o.NEXT_CACHE_TAG_MAX_ITEMS){console.warn(`Warning: exceeded max tag count for ${t}, dropped tags:`,e.slice(s).join(", "));break}}if(n.length>0)for(let{tag:e,reason:r}of(console.warn(`Warning: invalid tags passed to ${t}: `),n))console.log(`tag: "${e}" ${r}`);return r}function y(e,t){e.shouldTrackFetchMetrics&&(e.fetchMetrics??=[],e.fetchMetrics.push({...t,end:performance.timeOrigin+performance.now(),idx:e.nextFetchId||0}))}async function b(e,t,r,n,s,a){let i=await e.arrayBuffer(),o={headers:Object.fromEntries(e.headers.entries()),body:Buffer.from(i).toString("base64"),status:e.status,url:e.url};return r&&await n.set(t,{kind:d.CachedRouteKind.FETCH,data:o,revalidate:s},r),await a(),new Response(i,{headers:e.headers,status:e.status,statusText:e.statusText})}async function _(e,t,r,n,s,a,i,o,l){let[u,c]=(0,f.cloneResponse)(t),h=u.arrayBuffer().then(async e=>{let t=Buffer.from(e),o={headers:Object.fromEntries(u.headers.entries()),body:t.toString("base64"),status:u.status,url:u.url};null==a||a.set(r,o),n&&await s.set(r,{kind:d.CachedRouteKind.FETCH,data:o,revalidate:i},n)}).catch(e=>console.warn("Failed to set fetch cache",o,e)).finally(l),p=`cache-set-${r}`,g=e.pendingRevalidates??={},m=Promise.resolve();return p in g&&(m=g[p]),g[p]=m.then(()=>h).finally(()=>{(null==g?void 0:g[p])&&delete g[p]}),c}function v(e,{workAsyncStorage:t,workUnitAsyncStorage:r}){let n=async function(n,s){var c,p;let v;try{(v=new URL(n instanceof Request?n.url:n)).username="",v.password=""}catch{v=void 0}let w=(null==v?void 0:v.href)??"",S=(null==s||null==(c=s.method)?void 0:c.toUpperCase())||"GET",R=(null==s||null==(p=s.next)?void 0:p.internal)===!0,T="1"===process.env.NEXT_OTEL_FETCH_DISABLED,O=R?void 0:performance.timeOrigin+performance.now(),k=t.getStore(),A=r.getStore(),C=A?(0,h.getCacheSignal)(A):null;C&&C.beginRead();let P=(0,i.getTracer)().trace(R?a.NextNodeServerSpan.internalFetch:a.AppRenderSpan.fetch,{hideSpan:T,kind:i.SpanKind.CLIENT,spanName:["fetch",S,w].filter(Boolean).join(" "),attributes:{"http.url":w,"http.method":S,"net.peer.name":null==v?void 0:v.hostname,"net.peer.port":(null==v?void 0:v.port)||void 0}},async()=>{var t;let r,a,i,c,h,p;if(R||!k||k.isDraftMode)return e(n,s);let v=n&&"object"==typeof n&&"string"==typeof n.method,S=e=>(null==s?void 0:s[e])||(v?n[e]:null),T=e=>{var t,r,a;return void 0!==(null==s||null==(t=s.next)?void 0:t[e])?null==s||null==(r=s.next)?void 0:r[e]:v?null==(a=n.next)?void 0:a[e]:void 0},P=T("revalidate"),j=P,x=m(T("tags")||[],`fetch ${n.toString()}`);if(A)switch(A.type){case"prerender":case"prerender-runtime":case"prerender-client":case"prerender-ppr":case"prerender-legacy":case"cache":case"private-cache":r=A}if(r&&Array.isArray(x)){let e=r.tags??(r.tags=[]);for(let t of x)e.includes(t)||e.push(t)}let N=null==A?void 0:A.implicitTags,$=k.fetchCache;A&&"unstable-cache"===A.type&&($="force-no-store");let I=!!k.isUnstableNoStore,D=S("cache"),U="";"string"==typeof D&&void 0!==j&&("force-cache"===D&&0===j||"no-store"===D&&(j>0||!1===j))&&(a=`Specified "cache: ${D}" and "revalidate: ${j}", only one should be specified.`,D=void 0,j=void 0);let M="no-cache"===D||"no-store"===D||"force-no-store"===$||"only-no-store"===$,q=!$&&!D&&!j&&k.forceDynamic;"force-cache"===D&&void 0===j?j=!1:(M||q)&&(j=0),("no-cache"===D||"no-store"===D)&&(U=`cache: ${D}`),p=g(j,k.route);let L=S("headers"),B="function"==typeof(null==L?void 0:L.get)?L:new Headers(L||{}),H=B.get("authorization")||B.get("cookie"),F=!["get","head"].includes((null==(t=S("method"))?void 0:t.toLowerCase())||"get"),G=void 0==$&&(void 0==D||"default"===D)&&void 0==j,K=!!((H||F)&&(null==r?void 0:r.revalidate)===0),W=!1;if(!K&&G&&(k.isBuildTimePrerendering?W=!0:K=!0),G&&void 0!==A)switch(A.type){case"prerender":case"prerender-runtime":case"prerender-client":return C&&(C.endRead(),C=null),(0,u.makeHangingPromise)(A.renderSignal,k.route,"fetch()")}switch($){case"force-no-store":U="fetchCache = force-no-store";break;case"only-no-store":if("force-cache"===D||void 0!==p&&p>0)throw Object.defineProperty(Error(`cache: 'force-cache' used on fetch for ${w} with 'export const fetchCache = 'only-no-store'`),"__NEXT_ERROR_CODE",{value:"E448",enumerable:!1,configurable:!0});U="fetchCache = only-no-store";break;case"only-cache":if("no-store"===D)throw Object.defineProperty(Error(`cache: 'no-store' used on fetch for ${w} with 'export const fetchCache = 'only-cache'`),"__NEXT_ERROR_CODE",{value:"E521",enumerable:!1,configurable:!0});break;case"force-cache":(void 0===j||0===j)&&(U="fetchCache = force-cache",p=o.INFINITE_CACHE)}if(void 0===p?"default-cache"!==$||I?"default-no-store"===$?(p=0,U="fetchCache = default-no-store"):I?(p=0,U="noStore call"):K?(p=0,U="auto no cache"):(U="auto cache",p=r?r.revalidate:o.INFINITE_CACHE):(p=o.INFINITE_CACHE,U="fetchCache = default-cache"):U||(U=`revalidate: ${p}`),!(k.forceStatic&&0===p)&&!K&&r&&p<r.revalidate){if(0===p){if(A)switch(A.type){case"prerender":case"prerender-client":case"prerender-runtime":return C&&(C.endRead(),C=null),(0,u.makeHangingPromise)(A.renderSignal,k.route,"fetch()")}(0,l.markCurrentScopeAsDynamic)(k,A,`revalidate: 0 fetch ${n} ${k.route}`)}r&&P===p&&(r.revalidate=p)}let z="number"==typeof p&&p>0,{incrementalCache:X}=k,V=!1;if(A)switch(A.type){case"request":case"cache":case"private-cache":V=A.isHmrRefresh??!1,c=A.serverComponentsHmrCache}if(X&&(z||c))try{i=await X.generateCacheKey(w,v?n:s)}catch(e){console.error("Failed to generate cache key for",n)}let J=k.nextFetchId??1;k.nextFetchId=J+1;let Y=()=>{},Q=async(t,r)=>{let l=["cache","credentials","headers","integrity","keepalive","method","mode","redirect","referrer","referrerPolicy","window","duplex",...t?[]:["signal"]];if(v){let e=n,t={body:e._ogBody||e.body};for(let r of l)t[r]=e[r];n=new Request(e.url,t)}else if(s){let{_ogBody:e,body:r,signal:n,...a}=s;s={...a,body:e||r,signal:t?void 0:n}}let u={...s,next:{...null==s?void 0:s.next,fetchType:"origin",fetchIdx:J}};return e(n,u).then(async e=>{if(!t&&O&&y(k,{start:O,url:w,cacheReason:r||U,cacheStatus:0===p||r?"skip":"miss",cacheWarning:a,status:e.status,method:u.method||"GET"}),200===e.status&&X&&i&&(z||c)){let t=p>=o.INFINITE_CACHE?o.CACHE_ONE_YEAR:p,r=z?{fetchCache:!0,fetchUrl:w,fetchIdx:J,tags:x,isImplicitBuildTimeCache:W}:void 0;switch(null==A?void 0:A.type){case"prerender":case"prerender-client":case"prerender-runtime":return b(e,i,r,X,t,Y);case"request":case"prerender-ppr":case"prerender-legacy":case"cache":case"private-cache":case"unstable-cache":case void 0:return _(k,e,i,r,X,c,t,n,Y)}}return await Y(),e}).catch(e=>{throw Y(),e})},Z=!1,ee=!1;if(i&&X){let e;if(V&&c&&(e=c.get(i),ee=!0),z&&!e){Y=await X.lock(i);let t=(k.isOnDemandRevalidate && !globalThis.__openNextAls?.getStore()?.isISRRevalidation)?null:await X.get(i,{kind:d.IncrementalCacheKind.FETCH,revalidate:p,fetchUrl:w,fetchIdx:J,tags:x,softTags:null==N?void 0:N.tags});if(G&&A)switch(A.type){case"prerender":case"prerender-client":case"prerender-runtime":await (E||(E=new Promise(e=>{setTimeout(()=>{E=null,e()},0)})),E)}if(t?await Y():h="cache-control: no-cache (hard refresh)",(null==t?void 0:t.value)&&t.value.kind===d.CachedRouteKind.FETCH)if(k.isStaticGeneration&&t.isStale)Z=!0;else{if(t.isStale&&(k.pendingRevalidates??={},!k.pendingRevalidates[i])){let e=Q(!0).then(async e=>({body:await e.arrayBuffer(),headers:e.headers,status:e.status,statusText:e.statusText})).finally(()=>{k.pendingRevalidates??={},delete k.pendingRevalidates[i||""]});e.catch(console.error),k.pendingRevalidates[i]=e}e=t.value.data}}if(e){O&&y(k,{start:O,url:w,cacheReason:U,cacheStatus:ee?"hmr":"hit",cacheWarning:a,status:e.status||200,method:(null==s?void 0:s.method)||"GET"});let t=new Response(Buffer.from(e.body,"base64"),{headers:e.headers,status:e.status});return Object.defineProperty(t,"url",{value:e.url}),t}}if(k.isStaticGeneration&&s&&"object"==typeof s){let{cache:e}=s;if("no-store"===e){if(A)switch(A.type){case"prerender":case"prerender-client":case"prerender-runtime":return C&&(C.endRead(),C=null),(0,u.makeHangingPromise)(A.renderSignal,k.route,"fetch()")}(0,l.markCurrentScopeAsDynamic)(k,A,`no-store fetch ${n} ${k.route}`)}let t="next"in s,{next:a={}}=s;if("number"==typeof a.revalidate&&r&&a.revalidate<r.revalidate){if(0===a.revalidate){if(A)switch(A.type){case"prerender":case"prerender-client":case"prerender-runtime":return(0,u.makeHangingPromise)(A.renderSignal,k.route,"fetch()")}(0,l.markCurrentScopeAsDynamic)(k,A,`revalidate: 0 fetch ${n} ${k.route}`)}k.forceStatic&&0===a.revalidate||(r.revalidate=a.revalidate)}t&&delete s.next}if(!i||!Z)return Q(!1,h);{let e=i;k.pendingRevalidates??={};let t=k.pendingRevalidates[e];if(t){let e=await t;return new Response(e.body,{headers:e.headers,status:e.status,statusText:e.statusText})}let r=Q(!0,h).then(f.cloneResponse);return(t=r.then(async e=>{let t=e[0];return{body:await t.arrayBuffer(),headers:t.headers,status:t.status,statusText:t.statusText}}).finally(()=>{var t;(null==(t=k.pendingRevalidates)?void 0:t[e])&&delete k.pendingRevalidates[e]})).catch(()=>{}),k.pendingRevalidates[e]=t,r.then(e=>e[1])}});if(C)try{return await P}finally{C&&C.endRead()}return P};return n.__nextPatched=!0,n.__nextGetStaticStore=()=>t,n._nextOriginalFetch=e,globalThis[p]=!0,Object.defineProperty(n,"name",{value:"fetch",writable:!1}),n}function w(e){if(!0===globalThis[p])return;let t=(0,c.createDedupeFetch)(globalThis.fetch);globalThis.fetch=v(t,e)}let E=null},19289,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"unstable_cache",{enumerable:!0,get:function(){return c}});let n=e.r(61599),s=e.r(73663),a=e.r(56704),i=e.r(32319),o=e.r(38983),l=0;async function u(e,t,r,s,a,i,l){await t.set(r,{kind:o.CachedRouteKind.FETCH,data:{headers:{},body:JSON.stringify(e),status:200,url:""},revalidate:"number"!=typeof a?n.CACHE_ONE_YEAR:a},{fetchCache:!0,tags:s,fetchIdx:i,fetchUrl:l})}function c(e,t,r={}){if(0===r.revalidate)throw Object.defineProperty(Error(`Invariant revalidate: 0 can not be passed to unstable_cache(), must be "false" or "> 0" ${e.toString()}`),"__NEXT_ERROR_CODE",{value:"E57",enumerable:!1,configurable:!0});let n=r.tags?(0,s.validateTags)(r.tags,`unstable_cache ${e.toString()}`):[];(0,s.validateRevalidate)(r.revalidate,`unstable_cache ${e.name||e.toString()}`);let h=`${e.toString()}-${Array.isArray(t)&&t.join(",")}`;return async(...t)=>{let s=a.workAsyncStorage.getStore(),c=i.workUnitAsyncStorage.getStore(),d=(null==s?void 0:s.incrementalCache)||globalThis.__incrementalCache;if(!d)throw Object.defineProperty(Error(`Invariant: incrementalCache missing in unstable_cache ${e.toString()}`),"__NEXT_ERROR_CODE",{value:"E469",enumerable:!1,configurable:!0});let f=c?(0,i.getCacheSignal)(c):null;f&&f.beginRead();try{let a=s&&c?function(e,t){switch(t.type){case"request":let r=t.url.pathname,n=new URLSearchParams(t.url.search),s=[...n.keys()].sort((e,t)=>e.localeCompare(t)).map(e=>`${e}=${n.get(e)}`).join("&");return`${r}${s.length?"?":""}${s}`;case"prerender":case"prerender-client":case"prerender-runtime":case"prerender-ppr":case"prerender-legacy":case"cache":case"private-cache":case"unstable-cache":return e.route;default:return t}}(s,c):"",f=`${h}-${JSON.stringify(t)}`,p=await d.generateCacheKey(f),g=`unstable_cache ${a} ${e.name?` ${e.name}`:p}`,m=(s?s.nextFetchId:l)??1,y=null==c?void 0:c.implicitTags,b={type:"unstable-cache",phase:"render",implicitTags:y,draftMode:c&&s&&(0,i.getDraftModeProviderForCacheScope)(s,c)};if(s){s.nextFetchId=m+1;let a=!1;if(c)switch(c.type){case"cache":case"private-cache":case"prerender":case"prerender-runtime":case"prerender-ppr":case"prerender-legacy":"number"==typeof r.revalidate&&(c.revalidate<r.revalidate||(c.revalidate=r.revalidate));let l=c.tags;if(null===l)c.tags=n.slice();else for(let e of n)l.includes(e)||l.push(e);break;case"unstable-cache":a=!0}if(!a&&"force-no-store"!==s.fetchCache&&!(s.isOnDemandRevalidate && !globalThis.__openNextAls?.getStore()?.isISRRevalidation)&&!(d.isOnDemandRevalidate && !globalThis.__openNextAls?.getStore()?.isISRRevalidation)&&!s.isDraftMode){let a=await d.get(p,{kind:o.IncrementalCacheKind.FETCH,revalidate:r.revalidate,tags:n,softTags:null==y?void 0:y.tags,fetchIdx:m,fetchUrl:g});if(a&&a.value)if(a.value.kind!==o.CachedRouteKind.FETCH)console.error(`Invariant invalid cacheEntry returned for ${f}`);else{let o=void 0!==a.value.data.body?JSON.parse(a.value.data.body):void 0;if(a.isStale){if(s.pendingRevalidates||(s.pendingRevalidates={}),!s.pendingRevalidates[f]){let a=i.workUnitAsyncStorage.run(b,e,...t).then(async e=>(await u(e,d,p,n,r.revalidate,m,g),e)).catch(e=>(console.error(`revalidating cache with key: ${f}`,e),o));s.isStaticGeneration&&a.catch(()=>{}),s.pendingRevalidates[f]=a}if(s.isStaticGeneration)return s.pendingRevalidates[f]}return o}}let h=await i.workUnitAsyncStorage.run(b,e,...t);return s.isDraftMode||(s.pendingRevalidates||(s.pendingRevalidates={}),s.pendingRevalidates[f]=u(h,d,p,n,r.revalidate,m,g)),h}{if(l+=1,!(d.isOnDemandRevalidate && !globalThis.__openNextAls?.getStore()?.isISRRevalidation)){let e=await d.get(p,{kind:o.IncrementalCacheKind.FETCH,revalidate:r.revalidate,tags:n,fetchIdx:m,fetchUrl:g,softTags:null==y?void 0:y.tags});if(e&&e.value){if(e.value.kind!==o.CachedRouteKind.FETCH)console.error(`Invariant invalid cacheEntry returned for ${f}`);else if(!e.isStale)return void 0!==e.value.data.body?JSON.parse(e.value.data.body):void 0}}let s=await i.workUnitAsyncStorage.run(b,e,...t);return await u(s,d,p,n,r.revalidate,m,g),s}}finally{f&&f.endRead()}}}},51630,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={getSortedRouteObjects:function(){return o},getSortedRoutes:function(){return i}};for(var s in n)Object.defineProperty(r,s,{enumerable:!0,get:n[s]});class a{insert(e){this._insert(e.split("/").filter(Boolean),[],!1)}smoosh(){return this._smoosh()}_smoosh(e="/"){let t=[...this.children.keys()].sort();null!==this.slugName&&t.splice(t.indexOf("[]"),1),null!==this.restSlugName&&t.splice(t.indexOf("[...]"),1),null!==this.optionalRestSlugName&&t.splice(t.indexOf("[[...]]"),1);let r=t.map(t=>this.children.get(t)._smoosh(`${e}${t}/`)).reduce((e,t)=>[...e,...t],[]);if(null!==this.slugName&&r.push(...this.children.get("[]")._smoosh(`${e}[${this.slugName}]/`)),!this.placeholder){let t="/"===e?"/":e.slice(0,-1);if(null!=this.optionalRestSlugName)throw Object.defineProperty(Error(`You cannot define a route with the same specificity as a optional catch-all route ("${t}" and "${t}[[...${this.optionalRestSlugName}]]").`),"__NEXT_ERROR_CODE",{value:"E458",enumerable:!1,configurable:!0});r.unshift(t)}return null!==this.restSlugName&&r.push(...this.children.get("[...]")._smoosh(`${e}[...${this.restSlugName}]/`)),null!==this.optionalRestSlugName&&r.push(...this.children.get("[[...]]")._smoosh(`${e}[[...${this.optionalRestSlugName}]]/`)),r}_insert(e,t,r){if(0===e.length){this.placeholder=!1;return}if(r)throw Object.defineProperty(Error("Catch-all must be the last part of the URL."),"__NEXT_ERROR_CODE",{value:"E392",enumerable:!1,configurable:!0});let n=e[0];if(n.startsWith("[")&&n.endsWith("]")){let a=n.slice(1,-1),i=!1;if(a.startsWith("[")&&a.endsWith("]")&&(a=a.slice(1,-1),i=!0),a.startsWith("…"))throw Object.defineProperty(Error(`Detected a three-dot character ('…') at ('${a}'). Did you mean ('...')?`),"__NEXT_ERROR_CODE",{value:"E147",enumerable:!1,configurable:!0});if(a.startsWith("...")&&(a=a.substring(3),r=!0),a.startsWith("[")||a.endsWith("]"))throw Object.defineProperty(Error(`Segment names may not start or end with extra brackets ('${a}').`),"__NEXT_ERROR_CODE",{value:"E421",enumerable:!1,configurable:!0});if(a.startsWith("."))throw Object.defineProperty(Error(`Segment names may not start with erroneous periods ('${a}').`),"__NEXT_ERROR_CODE",{value:"E288",enumerable:!1,configurable:!0});function s(e,r){if(null!==e&&e!==r)throw Object.defineProperty(Error(`You cannot use different slug names for the same dynamic path ('${e}' !== '${r}').`),"__NEXT_ERROR_CODE",{value:"E337",enumerable:!1,configurable:!0});t.forEach(e=>{if(e===r)throw Object.defineProperty(Error(`You cannot have the same slug name "${r}" repeat within a single dynamic path`),"__NEXT_ERROR_CODE",{value:"E247",enumerable:!1,configurable:!0});if(e.replace(/\W/g,"")===n.replace(/\W/g,""))throw Object.defineProperty(Error(`You cannot have the slug names "${e}" and "${r}" differ only by non-word symbols within a single dynamic path`),"__NEXT_ERROR_CODE",{value:"E499",enumerable:!1,configurable:!0})}),t.push(r)}if(r)if(i){if(null!=this.restSlugName)throw Object.defineProperty(Error(`You cannot use both an required and optional catch-all route at the same level ("[...${this.restSlugName}]" and "${e[0]}" ).`),"__NEXT_ERROR_CODE",{value:"E299",enumerable:!1,configurable:!0});s(this.optionalRestSlugName,a),this.optionalRestSlugName=a,n="[[...]]"}else{if(null!=this.optionalRestSlugName)throw Object.defineProperty(Error(`You cannot use both an optional and required catch-all route at the same level ("[[...${this.optionalRestSlugName}]]" and "${e[0]}").`),"__NEXT_ERROR_CODE",{value:"E300",enumerable:!1,configurable:!0});s(this.restSlugName,a),this.restSlugName=a,n="[...]"}else{if(i)throw Object.defineProperty(Error(`Optional route parameters are not yet supported ("${e[0]}").`),"__NEXT_ERROR_CODE",{value:"E435",enumerable:!1,configurable:!0});s(this.slugName,a),this.slugName=a,n="[]"}}this.children.has(n)||this.children.set(n,new a),this.children.get(n)._insert(e.slice(1),t,r)}constructor(){this.placeholder=!0,this.children=new Map,this.slugName=null,this.restSlugName=null,this.optionalRestSlugName=null}}function i(e){let t=new a;return e.forEach(e=>t.insert(e)),t.smoosh()}function o(e,t){let r={},n=[];for(let s=0;s<e.length;s++){let a=t(e[s]);r[a]=s,n[s]=a}return i(n).map(t=>e[r[t]])}},15638,(e,t,r)=>{"use strict";function n(e){return e.startsWith("/")?e:`/${e}`}Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"ensureLeadingSlash",{enumerable:!0,get:function(){return n}})},22716,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={DEFAULT_SEGMENT_KEY:function(){return h},NOT_FOUND_SEGMENT_KEY:function(){return d},PAGE_SEGMENT_KEY:function(){return c},addSearchParamsIfPageSegment:function(){return l},computeSelectedLayoutSegment:function(){return u},getSegmentValue:function(){return a},getSelectedLayoutSegmentPath:function(){return function e(t,r,n=!0,s=[]){let i;if(n)i=t[1][r];else{let e=t[1];i=e.children??Object.values(e)[0]}if(!i)return s;let o=a(i[0]);return!o||o.startsWith(c)?s:(s.push(o),e(i,r,!1,s))}},isGroupSegment:function(){return i},isParallelRouteSegment:function(){return o}};for(var s in n)Object.defineProperty(r,s,{enumerable:!0,get:n[s]});function a(e){return Array.isArray(e)?e[1]:e}function i(e){return"("===e[0]&&e.endsWith(")")}function o(e){return e.startsWith("@")&&"@children"!==e}function l(e,t){if(e.includes(c)){let e=JSON.stringify(t);return"{}"!==e?c+"?"+e:c}return e}function u(e,t){if(!e||0===e.length)return null;let r="children"===t?e[0]:e[e.length-1];return r===h?null:r}let c="__PAGE__",h="__DEFAULT__",d="/_not-found"},88793,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={normalizeAppPath:function(){return o},normalizeRscURL:function(){return l}};for(var s in n)Object.defineProperty(r,s,{enumerable:!0,get:n[s]});let a=e.r(15638),i=e.r(22716);function o(e){return(0,a.ensureLeadingSlash)(e.split("/").reduce((e,t,r,n)=>!t||(0,i.isGroupSegment)(t)||"@"===t[0]||("page"===t||"route"===t)&&r===n.length-1?e:`${e}/${t}`,""))}function l(e){return e.replace(/\.rsc($|\?)/,"$1")}},36685,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={INTERCEPTION_ROUTE_MARKERS:function(){return i},extractInterceptionRouteInformation:function(){return l},isInterceptionRouteAppPath:function(){return o}};for(var s in n)Object.defineProperty(r,s,{enumerable:!0,get:n[s]});let a=e.r(88793),i=["(..)(..)","(.)","(..)","(...)"];function o(e){return void 0!==e.split("/").find(e=>i.find(t=>e.startsWith(t)))}function l(e){let t,r,n;for(let s of e.split("/"))if(r=i.find(e=>s.startsWith(e))){[t,n]=e.split(r,2);break}if(!t||!r||!n)throw Object.defineProperty(Error(`Invalid interception route: ${e}. Must be in the format /<intercepting route>/(..|...|..)(..)/<intercepted route>`),"__NEXT_ERROR_CODE",{value:"E269",enumerable:!1,configurable:!0});switch(t=(0,a.normalizeAppPath)(t),r){case"(.)":n="/"===t?`/${n}`:t+"/"+n;break;case"(..)":if("/"===t)throw Object.defineProperty(Error(`Invalid interception route: ${e}. Cannot use (..) marker at the root level, use (.) instead.`),"__NEXT_ERROR_CODE",{value:"E207",enumerable:!1,configurable:!0});n=t.split("/").slice(0,-1).concat(n).join("/");break;case"(...)":n="/"+n;break;case"(..)(..)":let s=t.split("/");if(s.length<=2)throw Object.defineProperty(Error(`Invalid interception route: ${e}. Cannot use (..)(..) marker at the root level or one level up.`),"__NEXT_ERROR_CODE",{value:"E486",enumerable:!1,configurable:!0});n=s.slice(0,-2).concat(n).join("/");break;default:throw Object.defineProperty(Error("Invariant: unexpected marker"),"__NEXT_ERROR_CODE",{value:"E112",enumerable:!1,configurable:!0})}return{interceptingRoute:t,interceptedRoute:n}}},43436,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"isDynamicRoute",{enumerable:!0,get:function(){return i}});let n=e.r(36685),s=/\/[^/]*\[[^/]+\][^/]*(?=\/|$)/,a=/\/\[[^/]+\](?=\/|$)/;function i(e,t=!0){return((0,n.isInterceptionRouteAppPath)(e)&&(e=(0,n.extractInterceptionRouteInformation)(e).interceptedRoute),t)?a.test(e):s.test(e)}},37277,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={getSortedRouteObjects:function(){return a.getSortedRouteObjects},getSortedRoutes:function(){return a.getSortedRoutes},isDynamicRoute:function(){return i.isDynamicRoute}};for(var s in n)Object.defineProperty(r,s,{enumerable:!0,get:n[s]});let a=e.r(51630),i=e.r(43436)},29519,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={refresh:function(){return g},revalidatePath:function(){return m},revalidateTag:function(){return f},updateTag:function(){return p}};for(var s in n)Object.defineProperty(r,s,{enumerable:!0,get:n[s]});let a=e.r(2803),i=e.r(37277),o=e.r(61599),l=e.r(56704),u=e.r(32319),c=e.r(3044),h=e.r(57969),d=e.r(66895);function f(e,t){return t||console.warn('"revalidateTag" without the second argument is now deprecated, add second argument of "max" or use "updateTag". See more info here: https://nextjs.org/docs/messages/revalidate-tag-single-arg'),y([e],`revalidateTag ${e}`,t)}function p(e){let t=l.workAsyncStorage.getStore();if(!t||t.page.endsWith("/route"))throw Object.defineProperty(Error("updateTag can only be called from within a Server Action. To invalidate cache tags in Route Handlers or other contexts, use revalidateTag instead. See more info here: https://nextjs.org/docs/app/api-reference/functions/updateTag"),"__NEXT_ERROR_CODE",{value:"E872",enumerable:!1,configurable:!0});return y([e],`updateTag ${e}`,void 0)}function g(){let e=l.workAsyncStorage.getStore(),t=u.workUnitAsyncStorage.getStore();if(!e||e.page.endsWith("/route")||(null==t?void 0:t.phase)!=="action")throw Object.defineProperty(Error("refresh can only be called from within a Server Action. See more info here: https://nextjs.org/docs/app/api-reference/functions/refresh"),"__NEXT_ERROR_CODE",{value:"E870",enumerable:!1,configurable:!0});e&&(e.pathWasRevalidated=d.ActionDidRevalidateDynamicOnly)}function m(e,t){if(e.length>o.NEXT_CACHE_SOFT_TAG_MAX_LENGTH)return void console.warn(`Warning: revalidatePath received "${e}" which exceeded max length of ${o.NEXT_CACHE_SOFT_TAG_MAX_LENGTH}. See more info here https://nextjs.org/docs/app/api-reference/functions/revalidatePath`);let r=`${o.NEXT_CACHE_IMPLICIT_TAG_ID}${e||"/"}`;t?r+=`${r.endsWith("/")?"":"/"}${t}`:(0,i.isDynamicRoute)(e)&&console.warn(`Warning: a dynamic page path "${e}" was passed to "revalidatePath", but the "type" parameter is missing. This has no effect by default, see more info here https://nextjs.org/docs/app/api-reference/functions/revalidatePath`);let n=[r];return r===`${o.NEXT_CACHE_IMPLICIT_TAG_ID}/`?n.push(`${o.NEXT_CACHE_IMPLICIT_TAG_ID}/index`):r===`${o.NEXT_CACHE_IMPLICIT_TAG_ID}/index`&&n.push(`${o.NEXT_CACHE_IMPLICIT_TAG_ID}/`),y(n,`revalidatePath ${e}`)}function y(e,t,r){var n;let s=l.workAsyncStorage.getStore();if(!s||!s.incrementalCache)throw Object.defineProperty(Error(`Invariant: static generation store missing in ${t}`),"__NEXT_ERROR_CODE",{value:"E263",enumerable:!1,configurable:!0});let i=u.workUnitAsyncStorage.getStore();if(i){if("render"===i.phase)throw Object.defineProperty(Error(`Route ${s.route} used "${t}" during render which is unsupported. To ensure revalidation is performed consistently it must always happen outside of renders and cached functions. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E7",enumerable:!1,configurable:!0});switch(i.type){case"cache":case"private-cache":throw Object.defineProperty(Error(`Route ${s.route} used "${t}" inside a "use cache" which is unsupported. To ensure revalidation is performed consistently it must always happen outside of renders and cached functions. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E181",enumerable:!1,configurable:!0});case"unstable-cache":throw Object.defineProperty(Error(`Route ${s.route} used "${t}" inside a function cached with "unstable_cache(...)" which is unsupported. To ensure revalidation is performed consistently it must always happen outside of renders and cached functions. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E306",enumerable:!1,configurable:!0});case"prerender":case"prerender-runtime":let e=Object.defineProperty(Error(`Route ${s.route} used ${t} without first calling \`await connection()\`.`),"__NEXT_ERROR_CODE",{value:"E406",enumerable:!1,configurable:!0});return(0,a.abortAndThrowOnSynchronousRequestDataAccess)(s.route,t,e,i);case"prerender-client":throw Object.defineProperty(new h.InvariantError(`${t} must not be used within a client component. Next.js should be preventing ${t} from being included in client components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E693",enumerable:!1,configurable:!0});case"prerender-ppr":return(0,a.postponeWithTracking)(s.route,t,i.dynamicTracking);case"prerender-legacy":i.revalidate=0;let r=Object.defineProperty(new c.DynamicServerError(`Route ${s.route} couldn't be rendered statically because it used \`${t}\`. See more info here: https://nextjs.org/docs/messages/dynamic-server-error`),"__NEXT_ERROR_CODE",{value:"E558",enumerable:!1,configurable:!0});throw s.dynamicUsageDescription=t,s.dynamicUsageStack=r.stack,r}}for(let t of(s.pendingRevalidatedTags||(s.pendingRevalidatedTags=[]),e))-1===s.pendingRevalidatedTags.findIndex(e=>e.tag===t&&("string"==typeof e.profile&&"string"==typeof r?e.profile===r:"object"==typeof e.profile&&"object"==typeof r?JSON.stringify(e.profile)===JSON.stringify(r):e.profile===r))&&s.pendingRevalidatedTags.push({tag:t,profile:r});let o=r&&"object"==typeof r?r:r&&"string"==typeof r&&(null==s||null==(n=s.cacheLifeProfiles)?void 0:n[r])?s.cacheLifeProfiles[r]:void 0;r&&(null==o?void 0:o.expire)!==0||(s.pathWasRevalidated=d.ActionDidRevalidateStaticAndDynamic)}},64754,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"unstable_noStore",{enumerable:!0,get:function(){return i}});let n=e.r(56704),s=e.r(32319),a=e.r(2803);function i(){let e=n.workAsyncStorage.getStore(),t=s.workUnitAsyncStorage.getStore();if(e){if(!e.forceStatic){if(e.isUnstableNoStore=!0,t)switch(t.type){case"prerender":case"prerender-client":case"prerender-runtime":return}(0,a.markCurrentScopeAsDynamic)(e,t,"unstable_noStore()")}}}},95360,(e,t,r)=>{"use strict";function n(e){throw Object.defineProperty(Error("`cacheLife()` is only available with the `cacheComponents` config."),"__NEXT_ERROR_CODE",{value:"E887",enumerable:!1,configurable:!0})}Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"cacheLife",{enumerable:!0,get:function(){return n}}),e.r(57969),e.r(56704),e.r(32319)},6130,(e,t,r)=>{"use strict";function n(){throw Object.defineProperty(Error("`cacheTag()` is only available with the `cacheComponents` config."),"__NEXT_ERROR_CODE",{value:"E886",enumerable:!1,configurable:!0})}Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"cacheTag",{enumerable:!0,get:function(){return n}}),e.r(32319),e.r(73663)},68839,(e,t,r)=>{let n={unstable_cache:e.r(19289).unstable_cache,updateTag:e.r(29519).updateTag,revalidateTag:e.r(29519).revalidateTag,revalidatePath:e.r(29519).revalidatePath,refresh:e.r(29519).refresh,unstable_noStore:e.r(64754).unstable_noStore,cacheLife:e.r(95360).cacheLife,cacheTag:e.r(6130).cacheTag},s=!1,a=!1;n.unstable_cacheLife=function(){return s||(s=!0,console.error(Error("`unstable_cacheLife` was recently stabilized and should be imported as `cacheLife`. The `unstable` prefixed form will be removed in a future version of Next.js."))),n.cacheLife.apply(this,arguments)},n.unstable_cacheTag=function(){return a||(a=!0,console.error(Error("`unstable_cacheTag` was recently stabilized and should be imported as `cacheTag`. The `unstable` prefixed form will be removed in a future version of Next.js."))),n.cacheTag.apply(this,arguments)},t.exports=n,r.unstable_cache=n.unstable_cache,r.revalidatePath=n.revalidatePath,r.revalidateTag=n.revalidateTag,r.updateTag=n.updateTag,r.unstable_noStore=n.unstable_noStore,r.cacheLife=n.cacheLife,r.unstable_cacheLife=n.unstable_cacheLife,r.cacheTag=n.cacheTag,r.unstable_cacheTag=n.unstable_cacheTag,r.refresh=n.refresh},6288,(e,t,r)=>{"use strict";function n(e){for(let t=0;t<e.length;t++){let r=e[t];if("function"!=typeof r)throw Object.defineProperty(Error(`A "use server" file can only export async functions, found ${typeof r}.
Read more: https://nextjs.org/docs/messages/invalid-use-server-value`),"__NEXT_ERROR_CODE",{value:"E352",enumerable:!1,configurable:!0})}}Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"ensureServerEntryExports",{enumerable:!0,get:function(){return n}})},74810,e=>{"use strict";let t;var r,n,s,a,i,o,l,u,c,h,d,f,p,g,m,y,b,_,v,w,E,S=e.i(60760),R=e.i(80838),T=e.i(91828),O=e.i(4239),k=e.i(30097),A=e.i(63325),C=e.i(11024),P=e.i(59808),j=e.i(82942),x=e.i(12547),N=e.i(97315),$=e.i(79281),I=e.i(58723),D=e.i(50697),U=e.i(71975),M=e.i(93695);e.i(39500);var q=e.i(14154),L=e.i(24168);L.parse,L.serialize;let B={path:"/",sameSite:"lax",httpOnly:!1,maxAge:3456e4},H=/^(.*)[.](0|[1-9][0-9]*)$/;function F(e,t){if(e===t)return!0;let r=e.match(H);return!!r&&r[1]===t}function G(e,t,r){let n=r??3180,s=encodeURIComponent(t);if(s.length<=n)return[{name:e,value:t}];let a=[];for(;s.length>0;){let e=s.slice(0,n),t=e.lastIndexOf("%");t>n-3&&(e=e.slice(0,t));let r="";for(;e.length>0;)try{r=decodeURIComponent(e);break}catch(t){if(t instanceof URIError&&"%"===e.at(-3)&&e.length>3)e=e.slice(0,e.length-3);else throw t}a.push(r),s=s.slice(e.length)}return a.map((t,r)=>({name:`${e}.${r}`,value:t}))}async function K(e,t){let r=await t(e);if(r)return r;let n=[];for(let r=0;;r++){let s=`${e}.${r}`,a=await t(s);if(!a)break;n.push(a)}return n.length>0?n.join(""):null}let W="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),z=" 	\n\r=".split(""),X=(()=>{let e=Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<z.length;t+=1)e[z[t].charCodeAt(0)]=-2;for(let t=0;t<W.length;t+=1)e[W[t].charCodeAt(0)]=t;return e})();function V(e){let t=[],r=0,n=0;if(function(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){let t=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|t)+65536,r+=1}!function(e,t){if(e<=127)return t(e);if(e<=2047){t(192|e>>6),t(128|63&e);return}if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|63&e);return}if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|63&e);return}throw Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}(n,t)}}(e,e=>{for(r=r<<8|e,n+=8;n>=6;){let e=r>>n-6&63;t.push(W[e]),n-=6}}),n>0)for(r<<=6-n,n=6;n>=6;){let e=r>>n-6&63;t.push(W[e]),n-=6}return t.join("")}function J(e){let t=[],r=e=>{t.push(String.fromCodePoint(e))},n={utf8seq:0,codepoint:0},s=0,a=0;for(let t=0;t<e.length;t+=1){let i=X[e.charCodeAt(t)];if(i>-1)for(s=s<<6|i,a+=6;a>=8;)(function(e,t,r){if(0===t.utf8seq){if(e<=127)return r(e);for(let r=1;r<6;r+=1)if((e>>7-r&1)==0){t.utf8seq=r;break}if(2===t.utf8seq)t.codepoint=31&e;else if(3===t.utf8seq)t.codepoint=15&e;else if(4===t.utf8seq)t.codepoint=7&e;else throw Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|63&e,t.utf8seq-=1,0===t.utf8seq&&r(t.codepoint)}})(s>>a-8&255,n,r),a-=8;else if(-2===i)continue;else throw Error(`Invalid Base64-URL character "${e.at(t)}" at position ${t}`)}return t.join("")}let Y="base64-";async function Q({getAll:e,setAll:t,setItems:r,removedItems:n},s){let a=s.cookieEncoding,i=s.cookieOptions??null,o=await e([...r?Object.keys(r):[],...n?Object.keys(n):[]]),l=o?.map(({name:e})=>e)||[],u=Object.keys(n).flatMap(e=>l.filter(t=>F(t,e))),c=Object.keys(r).flatMap(e=>{let t=new Set(l.filter(t=>F(t,e))),n=r[e];"base64url"===a&&(n=Y+V(n));let s=G(e,n);return s.forEach(e=>{t.delete(e.name)}),u.push(...t),s}),h={...B,...i,maxAge:0},d={...B,...i,maxAge:B.maxAge};delete h.name,delete d.name,await t([...u.map(e=>({name:e,value:"",options:h})),...c.map(({name:e,value:t})=>({name:e,value:t,options:d}))])}class Z extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class ee extends Z{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class et extends Z{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class er extends Z{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}(r=d||(d={})).Any="any",r.ApNortheast1="ap-northeast-1",r.ApNortheast2="ap-northeast-2",r.ApSouth1="ap-south-1",r.ApSoutheast1="ap-southeast-1",r.ApSoutheast2="ap-southeast-2",r.CaCentral1="ca-central-1",r.EuCentral1="eu-central-1",r.EuWest1="eu-west-1",r.EuWest2="eu-west-2",r.EuWest3="eu-west-3",r.SaEast1="sa-east-1",r.UsEast1="us-east-1",r.UsWest1="us-west-1",r.UsWest2="us-west-2";function en(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)0>t.indexOf(n[s])&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r}"function"==typeof SuppressedError&&SuppressedError;class es{constructor(e,{headers:t={},customFetch:r,region:n=d.Any}={}){this.url=e,this.headers=t,this.region=n,this.fetch=(e=>e?(...t)=>e(...t):(...e)=>fetch(...e))(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){var t,r,n,s;return t=this,r=arguments,n=void 0,s=function*(e,t={}){var r;let n,s;try{let a,{headers:i,method:o,body:l,signal:u,timeout:c}=t,h={},{region:d}=t;d||(d=this.region);let f=new URL(`${this.url}/${e}`);d&&"any"!==d&&(h["x-region"]=d,f.searchParams.set("forceFunctionRegion",d)),l&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)?"u">typeof Blob&&l instanceof Blob||l instanceof ArrayBuffer?(h["Content-Type"]="application/octet-stream",a=l):"string"==typeof l?(h["Content-Type"]="text/plain",a=l):"u">typeof FormData&&l instanceof FormData?a=l:(h["Content-Type"]="application/json",a=JSON.stringify(l)):a=!l||"string"==typeof l||"u">typeof Blob&&l instanceof Blob||l instanceof ArrayBuffer||"u">typeof FormData&&l instanceof FormData?l:JSON.stringify(l);let p=u;c&&(s=new AbortController,n=setTimeout(()=>s.abort(),c),u?(p=s.signal,u.addEventListener("abort",()=>s.abort())):p=s.signal);let g=yield this.fetch(f.toString(),{method:o||"POST",headers:Object.assign(Object.assign(Object.assign({},h),this.headers),i),body:a,signal:p}).catch(e=>{throw new ee(e)}),m=g.headers.get("x-relay-error");if(m&&"true"===m)throw new et(g);if(!g.ok)throw new er(g);let y=(null!=(r=g.headers.get("Content-Type"))?r:"text/plain").split(";")[0].trim();return{data:"application/json"===y?yield g.json():"application/octet-stream"===y||"application/pdf"===y?yield g.blob():"text/event-stream"===y?g:"multipart/form-data"===y?yield g.formData():yield g.text(),error:null,response:g}}catch(e){return{data:null,error:e,response:e instanceof er||e instanceof et?e.context:void 0}}finally{n&&clearTimeout(n)}},new(n||(n=Promise))(function(e,a){function i(e){try{l(s.next(e))}catch(e){a(e)}}function o(e){try{l(s.throw(e))}catch(e){a(e)}}function l(t){var r;t.done?e(t.value):((r=t.value)instanceof n?r:new n(function(e){e(r)})).then(i,o)}l((s=s.apply(t,r||[])).next())})}}var ea=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},ei=class{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=null!=(t=e.shouldThrowOnError)&&t,this.signal=e.signal,this.isMaybeSingle=null!=(r=e.isMaybeSingle)&&r,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var r=this;void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),"GET"!==this.method&&"HEAD"!==this.method&&this.headers.set("Content-Type","application/json");let n=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async e=>{var t,n,s,a;let i=null,o=null,l=null,u=e.status,c=e.statusText;if(e.ok){if("HEAD"!==r.method){let t=await e.text();""===t||(o="text/csv"===r.headers.get("Accept")||r.headers.get("Accept")&&(null==(s=r.headers.get("Accept"))?void 0:s.includes("application/vnd.pgrst.plan+text"))?t:JSON.parse(t))}let a=null==(t=r.headers.get("Prefer"))?void 0:t.match(/count=(exact|planned|estimated)/),h=null==(n=e.headers.get("content-range"))?void 0:n.split("/");a&&h&&h.length>1&&(l=parseInt(h[1])),r.isMaybeSingle&&"GET"===r.method&&Array.isArray(o)&&(o.length>1?(i={code:"PGRST116",details:`Results contain ${o.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},o=null,l=null,u=406,c="Not Acceptable"):o=1===o.length?o[0]:null)}else{let t=await e.text();try{i=JSON.parse(t),Array.isArray(i)&&404===e.status&&(o=[],i=null,u=200,c="OK")}catch(r){404===e.status&&""===t?(u=204,c="No Content"):i={message:t}}if(i&&r.isMaybeSingle&&(null==i||null==(a=i.details)?void 0:a.includes("0 rows"))&&(i=null,u=200,c="OK"),i&&r.shouldThrowOnError)throw new ea(i)}return{error:i,data:o,count:l,status:u,statusText:c}});return this.shouldThrowOnError||(n=n.catch(e=>{var t,r,n,s,a,i;let o="",l=null==e?void 0:e.cause;if(l){let t=null!=(r=null==l?void 0:l.message)?r:"",i=null!=(n=null==l?void 0:l.code)?n:"";o=`${null!=(s=null==e?void 0:e.name)?s:"FetchError"}: ${null==e?void 0:e.message}

Caused by: ${null!=(a=null==l?void 0:l.name)?a:"Error"}: ${t}`,i&&(o+=` (${i})`),(null==l?void 0:l.stack)&&(o+=`
${l.stack}`)}else o=null!=(i=null==e?void 0:e.stack)?i:"";return{error:{message:`${null!=(t=null==e?void 0:e.name)?t:"FetchError"}: ${null==e?void 0:e.message}`,details:o,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),n.then(e,t)}returns(){return this}overrideTypes(){return this}},eo=class extends ei{select(e){let t=!1,r=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:n,referencedTable:s=n}={}){let a=s?`${s}.order`:"order",i=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${i?`${i},`:""}${e}.${t?"asc":"desc"}${void 0===r?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){let n=void 0===r?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:n=r}={}){let s=void 0===n?"offset":`${n}.offset`,a=void 0===n?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(a,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return"GET"===this.method?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:n=!1,wal:s=!1,format:a="text"}={}){var i;let o=[e?"analyze":null,t?"verbose":null,r?"settings":null,n?"buffers":null,s?"wal":null].filter(Boolean).join("|"),l=null!=(i=this.headers.get("Accept"))?i:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${a}; for="${l}"; options=${o};`),this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};let el=RegExp("[,()]");var eu=class extends eo{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){let r=Array.from(new Set(t)).map(e=>"string"==typeof e&&el.test(e)?`"${e}"`:`${e}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}notIn(e,t){let r=Array.from(new Set(t)).map(e=>"string"==typeof e&&el.test(e)?`"${e}"`:`${e}`).join(",");return this.url.searchParams.append(e,`not.in.(${r})`),this}contains(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return"string"==typeof t?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:n}={}){let s="";"plain"===n?s="pl":"phrase"===n?s="ph":"websearch"===n&&(s="w");let a=void 0===r?"":`(${r})`;return this.url.searchParams.append(e,`${s}fts${a}.${t}`),this}match(e){return Object.entries(e).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){let n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}},ec=class{constructor(e,{headers:t={},schema:r,fetch:n}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=n}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(e,t){let{head:r=!1,count:n}=null!=t?t:{},s=!1,a=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!s?"":('"'===e&&(s=!s),e)).join(""),{url:i,headers:o}=this.cloneRequestState();return i.searchParams.set("select",a),n&&o.append("Prefer",`count=${n}`),new eu({method:r?"HEAD":"GET",url:i,headers:o,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:r=!0}={}){var n;let{url:s,headers:a}=this.cloneRequestState();if(t&&a.append("Prefer",`count=${t}`),r||a.append("Prefer","missing=default"),Array.isArray(e)){let t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){let e=[...new Set(t)].map(e=>`"${e}"`);s.searchParams.set("columns",e.join(","))}}return new eu({method:"POST",url:s,headers:a,schema:this.schema,body:e,fetch:null!=(n=this.fetch)?n:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:n,defaultToNull:s=!0}={}){var a;let{url:i,headers:o}=this.cloneRequestState();if(o.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),void 0!==t&&i.searchParams.set("on_conflict",t),n&&o.append("Prefer",`count=${n}`),s||o.append("Prefer","missing=default"),Array.isArray(e)){let t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){let e=[...new Set(t)].map(e=>`"${e}"`);i.searchParams.set("columns",e.join(","))}}return new eu({method:"POST",url:i,headers:o,schema:this.schema,body:e,fetch:null!=(a=this.fetch)?a:fetch})}update(e,{count:t}={}){var r;let{url:n,headers:s}=this.cloneRequestState();return t&&s.append("Prefer",`count=${t}`),new eu({method:"PATCH",url:n,headers:s,schema:this.schema,body:e,fetch:null!=(r=this.fetch)?r:fetch})}delete({count:e}={}){var t;let{url:r,headers:n}=this.cloneRequestState();return e&&n.append("Prefer",`count=${e}`),new eu({method:"DELETE",url:r,headers:n,schema:this.schema,fetch:null!=(t=this.fetch)?t:fetch})}},eh=class e{constructor(e,{headers:t={},schema:r,fetch:n}={}){this.url=e,this.headers=new Headers(t),this.schemaName=r,this.fetch=n}from(e){if(!e||"string"!=typeof e||""===e.trim())throw Error("Invalid relation name: relation must be a non-empty string.");return new ec(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new e(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(e,t={},{head:r=!1,get:n=!1,count:s}={}){var a;let i,o,l=new URL(`${this.url}/rpc/${e}`),u=e=>null!==e&&"object"==typeof e&&(!Array.isArray(e)||e.some(u)),c=r&&Object.values(t).some(u);c?(i="POST",o=t):r||n?(i=r?"HEAD":"GET",Object.entries(t).filter(([e,t])=>void 0!==t).map(([e,t])=>[e,Array.isArray(t)?`{${t.join(",")}}`:`${t}`]).forEach(([e,t])=>{l.searchParams.append(e,t)})):(i="POST",o=t);let h=new Headers(this.headers);return c?h.set("Prefer",s?`count=${s},return=minimal`:"return=minimal"):s&&h.set("Prefer",`count=${s}`),new eu({method:i,url:l,headers:h,schema:this.schemaName,body:o,fetch:null!=(a=this.fetch)?a:fetch})}};let ed=class{static detectEnvironment(){var t;if("u">typeof WebSocket)return{type:"native",constructor:WebSocket};if("u">typeof globalThis&&void 0!==globalThis.WebSocket)return{type:"native",constructor:globalThis.WebSocket};if(void 0!==e.g.WebSocket)return{type:"native",constructor:e.g.WebSocket};if("u">typeof globalThis&&void 0!==globalThis.WebSocketPair&&void 0===globalThis.WebSocket)return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if("u">typeof globalThis&&globalThis.EdgeRuntime||"u">typeof navigator&&(null==(t=navigator.userAgent)?void 0:t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};let r=globalThis.process;if(r){let e=r.versions;if(e&&e.node){let t=parseInt(e.node.replace(/^v/,"").split(".")[0]);return t>=22?void 0!==globalThis.WebSocket?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${t} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${t} detected without native WebSocket support.`,workaround:'For Node.js < 22, install "ws" package and provide it via the transport option:\nimport ws from "ws"\nnew RealtimeClient(url, { transport: ws })'}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){let e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),Error(t)}static createWebSocket(e,t){return new(this.getWebSocketConstructor())(e,t)}static isWebSocketSupported(){try{let e=this.detectEnvironment();return"native"===e.type||"ws"===e.type}catch(e){return!1}}},ef="2.0.0";(n=f||(f={}))[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed",(s=p||(p={})).closed="closed",s.errored="errored",s.joined="joined",s.joining="joining",s.leaving="leaving",(a=g||(g={})).close="phx_close",a.error="phx_error",a.join="phx_join",a.reply="phx_reply",a.leave="phx_leave",a.access_token="access_token",(m||(m={})).websocket="websocket",(i=y||(y={})).Connecting="connecting",i.Open="open",i.Closing="closing",i.Closed="closed";class ep{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=null!=e?e:[]}encode(e,t){return e.event!==this.BROADCAST_EVENT||e.payload instanceof ArrayBuffer||"string"!=typeof e.payload.event?t(JSON.stringify([e.join_ref,e.ref,e.topic,e.event,e.payload])):t(this._binaryEncodeUserBroadcastPush(e))}_binaryEncodeUserBroadcastPush(e){var t;return this._isArrayBuffer(null==(t=e.payload)?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var t,r;let n=null!=(r=null==(t=e.payload)?void 0:t.payload)?r:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,n)}_encodeJsonUserBroadcastPush(e){var t,r;let n=null!=(r=null==(t=e.payload)?void 0:t.payload)?r:{},s=new TextEncoder().encode(JSON.stringify(n)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,s)}_encodeUserBroadcastPush(e,t,r){let n=e.topic,s=null!=(f=e.ref)?f:"",a=null!=(p=e.join_ref)?p:"",i=e.payload.event,o=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},l=0===Object.keys(o).length?"":JSON.stringify(o);if(a.length>255)throw Error(`joinRef length ${a.length} exceeds maximum of 255`);if(s.length>255)throw Error(`ref length ${s.length} exceeds maximum of 255`);if(n.length>255)throw Error(`topic length ${n.length} exceeds maximum of 255`);if(i.length>255)throw Error(`userEvent length ${i.length} exceeds maximum of 255`);if(l.length>255)throw Error(`metadata length ${l.length} exceeds maximum of 255`);let u=this.USER_BROADCAST_PUSH_META_LENGTH+a.length+s.length+n.length+i.length+l.length,c=new ArrayBuffer(this.HEADER_LENGTH+u),h=new DataView(c),d=0;h.setUint8(d++,this.KINDS.userBroadcastPush),h.setUint8(d++,a.length),h.setUint8(d++,s.length),h.setUint8(d++,n.length),h.setUint8(d++,i.length),h.setUint8(d++,l.length),h.setUint8(d++,t),Array.from(a,e=>h.setUint8(d++,e.charCodeAt(0))),Array.from(s,e=>h.setUint8(d++,e.charCodeAt(0))),Array.from(n,e=>h.setUint8(d++,e.charCodeAt(0))),Array.from(i,e=>h.setUint8(d++,e.charCodeAt(0))),Array.from(l,e=>h.setUint8(d++,e.charCodeAt(0)));var f,p,g=new Uint8Array(c.byteLength+r.byteLength);return g.set(new Uint8Array(c),0),g.set(new Uint8Array(r),c.byteLength),g.buffer}decode(e,t){if(this._isArrayBuffer(e))return t(this._binaryDecode(e));if("string"==typeof e){let[r,n,s,a,i]=JSON.parse(e);return t({join_ref:r,ref:n,topic:s,event:a,payload:i})}return t({})}_binaryDecode(e){let t=new DataView(e),r=t.getUint8(0),n=new TextDecoder;if(r===this.KINDS.userBroadcast)return this._decodeUserBroadcast(e,t,n)}_decodeUserBroadcast(e,t,r){let n=t.getUint8(1),s=t.getUint8(2),a=t.getUint8(3),i=t.getUint8(4),o=this.HEADER_LENGTH+4,l=r.decode(e.slice(o,o+n));o+=n;let u=r.decode(e.slice(o,o+s));o+=s;let c=r.decode(e.slice(o,o+a));o+=a;let h=e.slice(o,e.byteLength),d=i===this.JSON_ENCODING?JSON.parse(r.decode(h)):h,f={type:this.BROADCAST_EVENT,event:u,payload:d};return a>0&&(f.meta=JSON.parse(c)),{join_ref:null,ref:null,topic:l,event:this.BROADCAST_EVENT,payload:f}}_isArrayBuffer(e){var t;return e instanceof ArrayBuffer||(null==(t=null==e?void 0:e.constructor)?void 0:t.name)==="ArrayBuffer"}_pick(e,t){return e&&"object"==typeof e?Object.fromEntries(Object.entries(e).filter(([e])=>t.includes(e))):{}}}class eg{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}(o=b||(b={})).abstime="abstime",o.bool="bool",o.date="date",o.daterange="daterange",o.float4="float4",o.float8="float8",o.int2="int2",o.int4="int4",o.int4range="int4range",o.int8="int8",o.int8range="int8range",o.json="json",o.jsonb="jsonb",o.money="money",o.numeric="numeric",o.oid="oid",o.reltime="reltime",o.text="text",o.time="time",o.timestamp="timestamp",o.timestamptz="timestamptz",o.timetz="timetz",o.tsrange="tsrange",o.tstzrange="tstzrange";let em=(e,t,r={})=>{var n;let s=null!=(n=r.skipTypes)?n:[];return t?Object.keys(t).reduce((r,n)=>(r[n]=ey(n,e,t,s),r),{}):{}},ey=(e,t,r,n)=>{let s=t.find(t=>t.name===e),a=null==s?void 0:s.type,i=r[e];return a&&!n.includes(a)?eb(a,i):e_(i)},eb=(e,t)=>{if("_"===e.charAt(0))return eS(t,e.slice(1,e.length));switch(e){case b.bool:return ev(t);case b.float4:case b.float8:case b.int2:case b.int4:case b.int8:case b.numeric:case b.oid:return ew(t);case b.json:case b.jsonb:return eE(t);case b.timestamp:return eR(t);case b.abstime:case b.date:case b.daterange:case b.int4range:case b.int8range:case b.money:case b.reltime:case b.text:case b.time:case b.timestamptz:case b.timetz:case b.tsrange:case b.tstzrange:default:return e_(t)}},e_=e=>e,ev=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},ew=e=>{if("string"==typeof e){let t=parseFloat(e);if(!Number.isNaN(t))return t}return e},eE=e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(e){}return e},eS=(e,t)=>{if("string"!=typeof e)return e;let r=e.length-1,n=e[r];if("{"===e[0]&&"}"===n){let n,s=e.slice(1,r);try{n=JSON.parse("["+s+"]")}catch(e){n=s?s.split(","):[]}return n.map(e=>eb(t,e))}return e},eR=e=>"string"==typeof e?e.replace(" ","T"):e,eT=e=>{let t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),""===t.pathname||"/"===t.pathname?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class eO{constructor(e,t,r={},n=1e4){this.channel=e,this.event=t,this.payload=r,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t(null==(r=this.receivedResp)?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);let e=e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(t=>t.status===e).forEach(e=>e.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}(l=_||(_={})).SYNC="sync",l.JOIN="join",l.LEAVE="leave";class ek{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(null==t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},e=>{let{onJoin:t,onLeave:r,onSync:n}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ek.syncState(this.state,e,t,r),this.pendingDiffs.forEach(e=>{this.state=ek.syncDiff(this.state,e,t,r)}),this.pendingDiffs=[],n()}),this.channel._on(r.diff,{},e=>{let{onJoin:t,onLeave:r,onSync:n}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=ek.syncDiff(this.state,e,t,r),n())}),this.onJoin((e,t,r)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:r})}),this.onLeave((e,t,r)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:r})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,n){let s=this.cloneDeep(e),a=this.transformState(t),i={},o={};return this.map(s,(e,t)=>{a[e]||(o[e]=t)}),this.map(a,(e,t)=>{let r=s[e];if(r){let n=t.map(e=>e.presence_ref),s=r.map(e=>e.presence_ref),a=t.filter(e=>0>s.indexOf(e.presence_ref)),l=r.filter(e=>0>n.indexOf(e.presence_ref));a.length>0&&(i[e]=a),l.length>0&&(o[e]=l)}else i[e]=t}),this.syncDiff(s,{joins:i,leaves:o},r,n)}static syncDiff(e,t,r,n){let{joins:s,leaves:a}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),n||(n=()=>{}),this.map(s,(t,n)=>{var s;let a=null!=(s=e[t])?s:[];if(e[t]=this.cloneDeep(n),a.length>0){let r=e[t].map(e=>e.presence_ref),n=a.filter(e=>0>r.indexOf(e.presence_ref));e[t].unshift(...n)}r(t,a,n)}),this.map(a,(t,r)=>{let s=e[t];if(!s)return;let a=r.map(e=>e.presence_ref);s=s.filter(e=>0>a.indexOf(e.presence_ref)),e[t]=s,n(t,s,r),0===s.length&&delete e[t]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return Object.getOwnPropertyNames(e=this.cloneDeep(e)).reduce((t,r)=>{let n=e[r];return"metas"in n?t[r]=n.metas.map(e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e)):t[r]=n,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}(u=v||(v={})).ALL="*",u.INSERT="INSERT",u.UPDATE="UPDATE",u.DELETE="DELETE",(c=w||(w={})).BROADCAST="broadcast",c.PRESENCE="presence",c.POSTGRES_CHANGES="postgres_changes",c.SYSTEM="system",(h=E||(E={})).SUBSCRIBED="SUBSCRIBED",h.TIMED_OUT="TIMED_OUT",h.CLOSED="CLOSED",h.CHANNEL_ERROR="CHANNEL_ERROR";class eA{constructor(e,t={config:{}},r){var n,s;if(this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=p.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new eO(this,g.join,this.params,this.timeout),this.rejoinTimer=new eg(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=p.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(e=>e.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=p.closed,this.socket._remove(this)}),this._onError(e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=p.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=p.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=p.errored,this.rejoinTimer.scheduleTimeout())}),this._on(g.reply,{},(e,t)=>{this._trigger(this._replyEventName(t),e)}),this.presence=new ek(this),this.broadcastEndpointURL=eT(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(null==(s=null==(n=this.params.config)?void 0:n.broadcast)?void 0:s.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var r,n,s;if(this.socket.isConnected()||this.socket.connect(),this.state==p.closed){let{config:{broadcast:a,presence:i,private:o}}=this.params,l=null!=(n=null==(r=this.bindings.postgres_changes)?void 0:r.map(e=>e.filter))?n:[],u=!!this.bindings[w.PRESENCE]&&this.bindings[w.PRESENCE].length>0||(null==(s=this.params.config.presence)?void 0:s.enabled)===!0,c={},h={broadcast:a,presence:Object.assign(Object.assign({},i),{enabled:u}),postgres_changes:l,private:o};this.socket.accessTokenValue&&(c.access_token=this.socket.accessTokenValue),this._onError(t=>null==e?void 0:e(E.CHANNEL_ERROR,t)),this._onClose(()=>null==e?void 0:e(E.CLOSED)),this.updateJoinPayload(Object.assign({config:h},c)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:t})=>{var r;if(this.socket._isManualToken()||this.socket.setAuth(),void 0===t){null==e||e(E.SUBSCRIBED);return}{let n=this.bindings.postgres_changes,s=null!=(r=null==n?void 0:n.length)?r:0,a=[];for(let r=0;r<s;r++){let s=n[r],{filter:{event:i,schema:o,table:l,filter:u}}=s,c=t&&t[r];if(c&&c.event===i&&eA.isFilterValueEqual(c.schema,o)&&eA.isFilterValueEqual(c.table,l)&&eA.isFilterValueEqual(c.filter,u))a.push(Object.assign(Object.assign({},s),{id:c.id}));else{this.unsubscribe(),this.state=p.errored,null==e||e(E.CHANNEL_ERROR,Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=a,e&&e(E.SUBSCRIBED);return}}).receive("error",t=>{this.state=p.errored,null==e||e(E.CHANNEL_ERROR,Error(JSON.stringify(Object.values(t).join(", ")||"error")))}).receive("timeout",()=>{null==e||e(E.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this.state===p.joined&&e===w.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,t,r)}async httpSend(e,t,r={}){var n;if(null==t)return Promise.reject("Payload is required for httpSend()");let s={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(s.Authorization=`Bearer ${this.socket.accessTokenValue}`);let a={method:"POST",headers:s,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},i=await this._fetchWithTimeout(this.broadcastEndpointURL,a,null!=(n=r.timeout)?n:this.timeout);if(202===i.status)return{success:!0};let o=i.statusText;try{let e=await i.json();o=e.error||e.message||o}catch(e){}return Promise.reject(Error(o))}async send(e,t={}){var r,n;if(this._canPush()||"broadcast"!==e.type)return new Promise(r=>{var n,s,a;let i=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null==(a=null==(s=null==(n=this.params)?void 0:n.config)?void 0:s.broadcast)?void 0:a.ack)||r("ok"),i.receive("ok",()=>r("ok")),i.receive("error",()=>r("error")),i.receive("timeout",()=>r("timed out"))});{console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");let{event:s,payload:a}=e,i={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(i.Authorization=`Bearer ${this.socket.accessTokenValue}`);let o={method:"POST",headers:i,body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:a,private:this.private}]})};try{let e=await this._fetchWithTimeout(this.broadcastEndpointURL,o,null!=(r=t.timeout)?r:this.timeout);return await (null==(n=e.body)?void 0:n.cancel()),e.ok?"ok":"error"}catch(e){if("AbortError"===e.name)return"timed out";return"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=p.leaving;let t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(g.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(n=>{(r=new eO(this,g.leave,{},e)).receive("ok",()=>{t(),n("ok")}).receive("timeout",()=>{t(),n("timed out")}).receive("error",()=>{n("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{null==r||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=p.closed,this.bindings={}}async _fetchWithTimeout(e,t,r){let n=new AbortController,s=setTimeout(()=>n.abort(),r),a=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:n.signal}));return clearTimeout(s),a}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new eO(this,e,t,r);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>100){let e=this.pushBuffer.shift();e&&(e.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${e.event}`,e.payload))}}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var n,s;let a=e.toLocaleLowerCase(),{close:i,error:o,leave:l,join:u}=g;if(r&&[i,o,l,u].indexOf(a)>=0&&r!==this._joinRef())return;let c=this._onMessage(a,t,r);if(t&&!c)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?null==(n=this.bindings.postgres_changes)||n.filter(e=>{var t,r,n;return(null==(t=e.filter)?void 0:t.event)==="*"||(null==(n=null==(r=e.filter)?void 0:r.event)?void 0:n.toLocaleLowerCase())===a}).map(e=>e.callback(c,r)):null==(s=this.bindings[a])||s.filter(e=>{var r,n,s,i,o,l;if(!["broadcast","presence","postgres_changes"].includes(a))return e.type.toLocaleLowerCase()===a;if("id"in e){let a=e.id,i=null==(r=e.filter)?void 0:r.event;return a&&(null==(n=t.ids)?void 0:n.includes(a))&&("*"===i||(null==i?void 0:i.toLocaleLowerCase())===(null==(s=t.data)?void 0:s.type.toLocaleLowerCase()))}{let r=null==(o=null==(i=null==e?void 0:e.filter)?void 0:i.event)?void 0:o.toLocaleLowerCase();return"*"===r||r===(null==(l=null==t?void 0:t.event)?void 0:l.toLocaleLowerCase())}}).map(e=>{if("object"==typeof c&&"ids"in c){let e=c.data,{schema:t,table:r,commit_timestamp:n,type:s,errors:a}=e;c=Object.assign(Object.assign({},{schema:t,table:r,commit_timestamp:n,eventType:s,new:{},old:{},errors:a}),this._getPayloadRecords(e))}e.callback(c,r)})}_isClosed(){return this.state===p.closed}_isJoined(){return this.state===p.joined}_isJoining(){return this.state===p.joining}_isLeaving(){return this.state===p.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){let n=e.toLocaleLowerCase(),s={type:n,filter:t,callback:r};return this.bindings[n]?this.bindings[n].push(s):this.bindings[n]=[s],this}_off(e,t){let r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(e=>{var n;return!((null==(n=e.type)?void 0:n.toLocaleLowerCase())===r&&eA.isEqual(e.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(let r in e)if(e[r]!==t[r])return!1;return!0}static isFilterValueEqual(e,t){return(null!=e?e:void 0)===(null!=t?t:void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(g.close,{},e)}_onError(e){this._on(g.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=p.joining,this.joinPush.resend(e))}_getPayloadRecords(e){let t={new:{},old:{}};return("INSERT"===e.type||"UPDATE"===e.type)&&(t.new=em(e.columns,e.record)),("UPDATE"===e.type||"DELETE"===e.type)&&(t.old=em(e.columns,e.old_record)),t}}let eC=()=>{},eP=[1e3,2e3,5e3,1e4],ej=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class ex{constructor(e,t){var r;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=1e4,this.transport=null,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=eC,this.ref=0,this.reconnectTimer=null,this.vsn=ef,this.logger=eC,this.conn=null,this.sendBuffer=[],this.serializer=new ep,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=e=>e?(...t)=>e(...t):(...e)=>fetch(...e),!(null==(r=null==t?void 0:t.params)?void 0:r.apikey))throw Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${m.websocket}`,this.httpEndpoint=eT(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(null==t?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||null!==this.conn&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=ed.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");let e=t.message;if(e.includes("Node.js"))throw Error(`${e}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`);throw Error(`WebSocket not available: ${e}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){let r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},"function"==typeof this.conn.close&&(e?this.conn.close(e,null!=t?t:""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){let t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){let e=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case f.connecting:return y.Connecting;case f.open:return y.Open;case f.closing:return y.Closing;default:return y.Closed}}isConnected(){return this.connectionState()===y.Open}isConnecting(){return"connecting"===this._connectionState}isDisconnecting(){return"disconnecting"===this._connectionState}channel(e,t={config:{}}){let r=`realtime:${e}`,n=this.getChannels().find(e=>e.topic===r);if(n)return n;{let r=new eA(`realtime:${e}`,t,this);return this.channels.push(r),r}}push(e){let{topic:t,event:r,payload:n,ref:s}=e,a=()=>{this.encode(e,e=>{var t;null==(t=this.conn)||t.send(e)})};this.log("push",`${t} ${r} (${s})`,n),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(e){this.log("error","error in heartbeat callback",e)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(e){this.log("error","error in heartbeat callback",e)}this._wasManualDisconnect=!1,null==(e=this.conn)||e.close(1e3,"heartbeat timeout"),setTimeout(()=>{var e;this.isConnected()||null==(e=this.reconnectTimer)||e.scheduleTimeout()},100);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(e){this.log("error","error in heartbeat callback",e)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,e=>{if("phoenix"===e.topic&&"phx_reply"===e.event&&e.ref&&e.ref===this.pendingHeartbeatRef){let t=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback("ok"===e.payload.status?"ok":"error",t)}catch(e){this.log("error","error in heartbeat callback",e)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}let{topic:t,event:r,payload:n,ref:s}=e,a=s?`(${s})`:"",i=n.status||"";this.log("receive",`${i} ${t} ${r} ${a}`.trim(),n),this.channels.filter(e=>e._isMember(t)).forEach(e=>e._trigger(r,n,s)),this._triggerStateCallbacks("message",e)})}_clearTimer(e){var t;"heartbeat"===e&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):"reconnect"===e&&(null==(t=this.reconnectTimer)||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===f.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===f.open||this.conn.readyState===f.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(e=>{this.log("error","error waiting for auth on connect",e),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");let e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this._terminateWorker()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||null==(t=this.reconnectTimer)||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e);try{this.heartbeatCallback("error")}catch(e){this.log("error","error in heartbeat callback",e)}}_triggerChanError(){this.channels.forEach(e=>e._trigger(g.error))}_appendParams(e,t){if(0===Object.keys(t).length)return e;let r=e.match(/\?/)?"&":"?",n=new URLSearchParams(t);return`${e}${r}${n}`}_workerObjectUrl(e){let t;if(e)t=e;else{let e=new Blob([ej],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}_setConnectionState(e,t=!1){this._connectionState=e,"connecting"===e?this._wasManualDisconnect=!1:"disconnecting"===e&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t,r=!1;if(e)t=e,r=!0;else if(this.accessToken)try{t=await this.accessToken()}catch(e){this.log("error","Error fetching access token from callback",e),t=this.accessTokenValue}else t=this.accessTokenValue;r?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(e=>{let r={access_token:t,version:"realtime-js/2.93.3"};t&&e.updateJoinPayload(r),e.joinedOnce&&e._isJoined()&&e._push(g.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(t=>{this.log("error",`Error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(t)}catch(t){this.log("error",`error in ${e} callback`,t)}})}catch(t){this.log("error",`error triggering ${e} callbacks`,t)}}_setupReconnectionTimer(){this.reconnectTimer=new eg(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},10)},this.reconnectAfterMs)}_initializeOptions(e){var t,r,n,s,a,i,o,l,u,c,h,d;switch(this.transport=null!=(t=null==e?void 0:e.transport)?t:null,this.timeout=null!=(r=null==e?void 0:e.timeout)?r:1e4,this.heartbeatIntervalMs=null!=(n=null==e?void 0:e.heartbeatIntervalMs)?n:25e3,this.worker=null!=(s=null==e?void 0:e.worker)&&s,this.accessToken=null!=(a=null==e?void 0:e.accessToken)?a:null,this.heartbeatCallback=null!=(i=null==e?void 0:e.heartbeatCallback)?i:eC,this.vsn=null!=(o=null==e?void 0:e.vsn)?o:ef,(null==e?void 0:e.params)&&(this.params=e.params),(null==e?void 0:e.logger)&&(this.logger=e.logger),((null==e?void 0:e.logLevel)||(null==e?void 0:e.log_level))&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=null!=(l=null==e?void 0:e.reconnectAfterMs)?l:e=>eP[e-1]||1e4,this.vsn){case"1.0.0":this.encode=null!=(u=null==e?void 0:e.encode)?u:(e,t)=>t(JSON.stringify(e)),this.decode=null!=(c=null==e?void 0:e.decode)?c:(e,t)=>t(JSON.parse(e));break;case ef:this.encode=null!=(h=null==e?void 0:e.encode)?h:this.serializer.encode.bind(this.serializer),this.decode=null!=(d=null==e?void 0:e.decode)?d:this.serializer.decode.bind(this.serializer);break;default:throw Error(`Unsupported serializer version: ${this.vsn}`)}this.worker&&(this.workerUrl=null==e?void 0:e.workerUrl)}}var eN=class extends Error{constructor(e,t){super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown="CommitStateUnknownException"===t.icebergType||[500,502,504].includes(t.status)&&t.icebergType?.includes("CommitState")===!0}isNotFound(){return 404===this.status}isConflict(){return 409===this.status}isAuthenticationTimeout(){return 419===this.status}};async function e$(e){return e&&"none"!==e.type?"bearer"===e.type?{Authorization:`Bearer ${e.token}`}:"header"===e.type?{[e.name]:e.value}:"custom"===e.type?await e.getHeaders():{}:{}}function eI(e){return e.join("\x1f")}var eD=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){let t=e?{parent:eI(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(e=>({namespace:e}))}async createNamespace(e,t){let r={namespace:e.namespace,properties:t?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${eI(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${eI(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${eI(e.namespace)}`}),!0}catch(e){if(e instanceof eN&&404===e.status)return!1;throw e}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(e){if(e instanceof eN&&409===e.status)return;throw e}}};function eU(e){return e.join("\x1f")}var eM=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${eU(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){let r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${eU(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){let r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${eU(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${eU(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String(t?.purge??!1)}})}async loadTable(e){let t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${eU(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){let t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${eU(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(e){if(e instanceof eN&&404===e.status)return!1;throw e}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof eN&&409===r.status)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},eq=class{constructor(e){let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=function(e){let t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:n,query:s,body:a,headers:i}){let o=function(e,t,r){let n=new URL(t,e);if(r)for(let[e,t]of Object.entries(r))void 0!==t&&n.searchParams.set(e,t);return n.toString()}(e.baseUrl,n,s),l=await e$(e.auth),u=await t(o,{method:r,headers:{...a?{"Content-Type":"application/json"}:{},...l,...i},body:a?JSON.stringify(a):void 0}),c=await u.text(),h=(u.headers.get("content-type")||"").includes("application/json"),d=h&&c?JSON.parse(c):c;if(!u.ok){let e=h?d:void 0,t=e?.error;throw new eN(t?.message??`Request failed with status ${u.status}`,{status:u.status,icebergType:t?.type,icebergCode:t?.code,details:e})}return{status:u.status,headers:u.headers,data:d}}}}({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=e.accessDelegation?.join(","),this.namespaceOps=new eD(this.client,t),this.tableOps=new eM(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},eL=class extends Error{constructor(e,t="storage",r,n){super(e),this.__isStorageError=!0,this.namespace=t,this.name="vectors"===t?"StorageVectorsError":"StorageError",this.status=r,this.statusCode=n}};function eB(e){return"object"==typeof e&&null!==e&&"__isStorageError"in e}var eH=class extends eL{constructor(e,t,r,n="storage"){super(e,n,t,r),this.name="vectors"===n?"StorageVectorsApiError":"StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},eF=class extends eL{constructor(e,t,r="storage"){super(e,r),this.name="vectors"===r?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=t}};let eG=e=>{if(Array.isArray(e))return e.map(e=>eG(e));if("function"==typeof e||e!==Object(e))return e;let t={};return Object.entries(e).forEach(([e,r])=>{t[e.replace(/([-_][a-z])/gi,e=>e.toUpperCase().replace(/[-_]/g,""))]=eG(r)}),t};function eK(e){return(eK="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eW(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function ez(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?eW(Object(r),!0).forEach(function(t){!function(e,t,r){var n;(n=function(e,t){if("object"!=eK(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=eK(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==eK(n)?n:n+"")in e)?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eW(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let eX=e=>{var t;return e.msg||e.message||e.error_description||("string"==typeof e.error?e.error:null==(t=e.error)?void 0:t.message)||JSON.stringify(e)},eV=async(e,t,r,n)=>{if(e&&"object"==typeof e&&"status"in e&&"ok"in e&&"number"==typeof e.status&&!(null==r?void 0:r.noResolveJson)){let r=e.status||500;"function"==typeof e.json?e.json().then(e=>{let s=(null==e?void 0:e.statusCode)||(null==e?void 0:e.code)||r+"";t(new eH(eX(e),r,s,n))}).catch(()=>{t(new eH(e.statusText||`HTTP ${r} error`,r,r+"",n))}):t(new eH(e.statusText||`HTTP ${r} error`,r,r+"",n))}else t(new eF(eX(e),e,n))};async function eJ(e,t,r,n,s,a,i){return new Promise((o,l)=>{let u;e(r,(u={method:t,headers:(null==n?void 0:n.headers)||{}},"GET"===t||"HEAD"===t||!a||((e=>{if("object"!=typeof e||null===e)return!1;let t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)})(a)?(u.headers=ez({"Content-Type":"application/json"},null==n?void 0:n.headers),u.body=JSON.stringify(a)):u.body=a,(null==n?void 0:n.duplex)&&(u.duplex=n.duplex)),ez(ez({},u),s))).then(e=>{if(!e.ok)throw e;if(null==n?void 0:n.noResolveJson)return e;if("vectors"===i){let t=e.headers.get("content-type");if("0"===e.headers.get("content-length")||204===e.status||!t||!t.includes("application/json"))return{}}return e.json()}).then(e=>o(e)).catch(e=>eV(e,l,n,i))})}function eY(e="storage"){return{get:async(t,r,n,s)=>eJ(t,"GET",r,n,s,void 0,e),post:async(t,r,n,s,a)=>eJ(t,"POST",r,s,a,n,e),put:async(t,r,n,s,a)=>eJ(t,"PUT",r,s,a,n,e),head:async(t,r,n,s)=>eJ(t,"HEAD",r,ez(ez({},n),{},{noResolveJson:!0}),s,void 0,e),remove:async(t,r,n,s,a)=>eJ(t,"DELETE",r,s,a,n,e)}}let{get:eQ,post:eZ,put:e0,head:e1,remove:e2}=eY("storage"),e3=eY("vectors");var e6=class{constructor(e,t={},r,n="storage"){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.fetch=(e=>e?(...t)=>e(...t):(...e)=>fetch(...e))(r),this.namespace=n}throwOnError(){return this.shouldThrowOnError=!0,this}async handleOperation(e){try{return{data:await e(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(eB(e))return{data:null,error:e};throw e}}},e4=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){try{return{data:(await this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(eB(e))return{data:null,error:e};throw e}}};t=Symbol.toStringTag;var e8=class{constructor(e,r){this.downloadFn=e,this.shouldThrowOnError=r,this[t]="BlobDownloadBuilder",this.promise=null}asStream(){return new e4(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){try{return{data:await (await this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(eB(e))return{data:null,error:e};throw e}}};let e5={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},e9={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var e7=class extends e6{constructor(e,t={},r,n){super(e,t,n,"storage"),this.bucketId=r}async uploadOrUpdate(e,t,r,n){var s=this;return s.handleOperation(async()=>{let a,i=ez(ez({},e9),n),o=ez(ez({},s.headers),"POST"===e&&{"x-upsert":String(i.upsert)}),l=i.metadata;"u">typeof Blob&&r instanceof Blob?((a=new FormData).append("cacheControl",i.cacheControl),l&&a.append("metadata",s.encodeMetadata(l)),a.append("",r)):"u">typeof FormData&&r instanceof FormData?((a=r).has("cacheControl")||a.append("cacheControl",i.cacheControl),l&&!a.has("metadata")&&a.append("metadata",s.encodeMetadata(l))):(a=r,o["cache-control"]=`max-age=${i.cacheControl}`,o["content-type"]=i.contentType,l&&(o["x-metadata"]=s.toBase64(s.encodeMetadata(l))),("u">typeof ReadableStream&&a instanceof ReadableStream||a&&"object"==typeof a&&"pipe"in a&&"function"==typeof a.pipe)&&!i.duplex&&(i.duplex="half")),(null==n?void 0:n.headers)&&(o=ez(ez({},o),n.headers));let u=s._removeEmptyFolders(t),c=s._getFinalPath(u),h=await ("PUT"==e?e0:eZ)(s.fetch,`${s.url}/object/${c}`,a,ez({headers:o},(null==i?void 0:i.duplex)?{duplex:i.duplex}:{}));return{path:u,id:h.Id,fullPath:h.Key}})}async upload(e,t,r){return this.uploadOrUpdate("POST",e,t,r)}async uploadToSignedUrl(e,t,r,n){var s=this;let a=s._removeEmptyFolders(e),i=s._getFinalPath(a),o=new URL(s.url+`/object/upload/sign/${i}`);return o.searchParams.set("token",t),s.handleOperation(async()=>{let e,t=ez({upsert:e9.upsert},n),i=ez(ez({},s.headers),{"x-upsert":String(t.upsert)});return"u">typeof Blob&&r instanceof Blob?((e=new FormData).append("cacheControl",t.cacheControl),e.append("",r)):"u">typeof FormData&&r instanceof FormData?(e=r).append("cacheControl",t.cacheControl):(e=r,i["cache-control"]=`max-age=${t.cacheControl}`,i["content-type"]=t.contentType),{path:a,fullPath:(await e0(s.fetch,o.toString(),e,{headers:i})).Key}})}async createSignedUploadUrl(e,t){var r=this;return r.handleOperation(async()=>{let n=r._getFinalPath(e),s=ez({},r.headers);(null==t?void 0:t.upsert)&&(s["x-upsert"]="true");let a=await eZ(r.fetch,`${r.url}/object/upload/sign/${n}`,{},{headers:s}),i=new URL(r.url+a.url),o=i.searchParams.get("token");if(!o)throw new eL("No token returned by API");return{signedUrl:i.toString(),path:e,token:o}})}async update(e,t,r){return this.uploadOrUpdate("PUT",e,t,r)}async move(e,t,r){var n=this;return n.handleOperation(async()=>await eZ(n.fetch,`${n.url}/object/move`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==r?void 0:r.destinationBucket},{headers:n.headers}))}async copy(e,t,r){var n=this;return n.handleOperation(async()=>({path:(await eZ(n.fetch,`${n.url}/object/copy`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==r?void 0:r.destinationBucket},{headers:n.headers})).Key}))}async createSignedUrl(e,t,r){var n=this;return n.handleOperation(async()=>{let s=n._getFinalPath(e),a=await eZ(n.fetch,`${n.url}/object/sign/${s}`,ez({expiresIn:t},(null==r?void 0:r.transform)?{transform:r.transform}:{}),{headers:n.headers}),i=(null==r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"";return{signedUrl:encodeURI(`${n.url}${a.signedURL}${i}`)}})}async createSignedUrls(e,t,r){var n=this;return n.handleOperation(async()=>{let s=await eZ(n.fetch,`${n.url}/object/sign/${n.bucketId}`,{expiresIn:t,paths:e},{headers:n.headers}),a=(null==r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"";return s.map(e=>ez(ez({},e),{},{signedUrl:e.signedURL?encodeURI(`${n.url}${e.signedURL}${a}`):null}))})}download(e,t){let r=void 0!==(null==t?void 0:t.transform)?"render/image/authenticated":"object",n=this.transformOptsToQueryString((null==t?void 0:t.transform)||{}),s=n?`?${n}`:"",a=this._getFinalPath(e);return new e8(()=>eQ(this.fetch,`${this.url}/${r}/${a}${s}`,{headers:this.headers,noResolveJson:!0}),this.shouldThrowOnError)}async info(e){var t=this;let r=t._getFinalPath(e);return t.handleOperation(async()=>eG(await eQ(t.fetch,`${t.url}/object/info/${r}`,{headers:t.headers})))}async exists(e){let t=this._getFinalPath(e);try{return await e1(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(eB(e)&&e instanceof eF){let t=e.originalError;if([400,404].includes(null==t?void 0:t.status))return{data:!1,error:e}}throw e}}getPublicUrl(e,t){let r=this._getFinalPath(e),n=[],s=(null==t?void 0:t.download)?`download=${!0===t.download?"":t.download}`:"";""!==s&&n.push(s);let a=void 0!==(null==t?void 0:t.transform)?"render/image":"object",i=this.transformOptsToQueryString((null==t?void 0:t.transform)||{});""!==i&&n.push(i);let o=n.join("&");return""!==o&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${r}${o}`)}}}async remove(e){var t=this;return t.handleOperation(async()=>await e2(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}))}async list(e,t,r){var n=this;return n.handleOperation(async()=>{let s=ez(ez(ez({},e5),t),{},{prefix:e||""});return await eZ(n.fetch,`${n.url}/object/list/${n.bucketId}`,s,{headers:n.headers},r)})}async listV2(e,t){var r=this;return r.handleOperation(async()=>{let n=ez({},e);return await eZ(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,n,{headers:r.headers},t)})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return"u">typeof Buffer?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){let t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};let te={"X-Client-Info":"storage-js/2.93.3"};var tt=class extends e6{constructor(e,t={},r,n){const s=new URL(e);(null==n?void 0:n.useNewHostname)&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),super(s.href.replace(/\/$/,""),ez(ez({},te),t),r,"storage")}async listBuckets(e){var t=this;return t.handleOperation(async()=>{let r=t.listBucketOptionsToQueryString(e);return await eQ(t.fetch,`${t.url}/bucket${r}`,{headers:t.headers})})}async getBucket(e){var t=this;return t.handleOperation(async()=>await eQ(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}))}async createBucket(e,t={public:!1}){var r=this;return r.handleOperation(async()=>await eZ(r.fetch,`${r.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}))}async updateBucket(e,t){var r=this;return r.handleOperation(async()=>await e0(r.fetch,`${r.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}))}async emptyBucket(e){var t=this;return t.handleOperation(async()=>await eZ(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await e2(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}))}listBucketOptionsToQueryString(e){let t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},tr=class extends e6{constructor(e,t={},r){super(e.replace(/\/$/,""),ez(ez({},te),t),r,"storage")}async createBucket(e){var t=this;return t.handleOperation(async()=>await eZ(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}))}async listBuckets(e){var t=this;return t.handleOperation(async()=>{let r=new URLSearchParams;(null==e?void 0:e.limit)!==void 0&&r.set("limit",e.limit.toString()),(null==e?void 0:e.offset)!==void 0&&r.set("offset",e.offset.toString()),(null==e?void 0:e.sortColumn)&&r.set("sortColumn",e.sortColumn),(null==e?void 0:e.sortOrder)&&r.set("sortOrder",e.sortOrder),(null==e?void 0:e.search)&&r.set("search",e.search);let n=r.toString(),s=n?`${t.url}/bucket?${n}`:`${t.url}/bucket`;return await eQ(t.fetch,s,{headers:t.headers})})}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await e2(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}))}from(e){var t=this;if(!(!(!e||"string"!=typeof e||0===e.length||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\"))&&/^[\w!.\*'() &$@=;:+,?-]+$/.test(e)))throw new eL("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");let r=new eq({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),n=this.shouldThrowOnError;return new Proxy(r,{get(e,t){let r=e[t];return"function"!=typeof r?r:async(...t)=>{try{return{data:await r.apply(e,t),error:null}}catch(e){if(n)throw e;return{data:null,error:e}}}}})}},tn=class extends e6{constructor(e,t={},r){super(e.replace(/\/$/,""),ez(ez({},te),{},{"Content-Type":"application/json"},t),r,"vectors")}async createIndex(e){var t=this;return t.handleOperation(async()=>await e3.post(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{})}async getIndex(e,t){var r=this;return r.handleOperation(async()=>await e3.post(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers}))}async listIndexes(e){var t=this;return t.handleOperation(async()=>await e3.post(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}))}async deleteIndex(e,t){var r=this;return r.handleOperation(async()=>await e3.post(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers})||{})}},ts=class extends e6{constructor(e,t={},r){super(e.replace(/\/$/,""),ez(ez({},te),{},{"Content-Type":"application/json"},t),r,"vectors")}async putVectors(e){var t=this;if(e.vectors.length<1||e.vectors.length>500)throw Error("Vector batch size must be between 1 and 500 items");return t.handleOperation(async()=>await e3.post(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{})}async getVectors(e){var t=this;return t.handleOperation(async()=>await e3.post(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}))}async listVectors(e){var t=this;if(void 0!==e.segmentCount){if(e.segmentCount<1||e.segmentCount>16)throw Error("segmentCount must be between 1 and 16");if(void 0!==e.segmentIndex&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return t.handleOperation(async()=>await e3.post(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}))}async queryVectors(e){var t=this;return t.handleOperation(async()=>await e3.post(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}))}async deleteVectors(e){var t=this;if(e.keys.length<1||e.keys.length>500)throw Error("Keys batch size must be between 1 and 500 items");return t.handleOperation(async()=>await e3.post(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{})}},ta=class extends e6{constructor(e,t={},r){super(e.replace(/\/$/,""),ez(ez({},te),{},{"Content-Type":"application/json"},t),r,"vectors")}async createBucket(e){var t=this;return t.handleOperation(async()=>await e3.post(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{})}async getBucket(e){var t=this;return t.handleOperation(async()=>await e3.post(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}))}async listBuckets(e={}){var t=this;return t.handleOperation(async()=>await e3.post(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await e3.post(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{})}},ti=class extends ta{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new to(this.url,this.headers,e,this.fetch)}async createBucket(e){return super.createBucket.call(this,e)}async getBucket(e){return super.getBucket.call(this,e)}async listBuckets(e={}){return super.listBuckets.call(this,e)}async deleteBucket(e){return super.deleteBucket.call(this,e)}},to=class extends tn{constructor(e,t,r,n){super(e,t,n),this.vectorBucketName=r}async createIndex(e){return super.createIndex.call(this,ez(ez({},e),{},{vectorBucketName:this.vectorBucketName}))}async listIndexes(e={}){return super.listIndexes.call(this,ez(ez({},e),{},{vectorBucketName:this.vectorBucketName}))}async getIndex(e){return super.getIndex.call(this,this.vectorBucketName,e)}async deleteIndex(e){return super.deleteIndex.call(this,this.vectorBucketName,e)}index(e){return new tl(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},tl=class extends ts{constructor(e,t,r,n,s){super(e,t,s),this.vectorBucketName=r,this.indexName=n}async putVectors(e){return super.putVectors.call(this,ez(ez({},e),{},{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))}async getVectors(e){return super.getVectors.call(this,ez(ez({},e),{},{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))}async listVectors(e={}){return super.listVectors.call(this,ez(ez({},e),{},{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))}async queryVectors(e){return super.queryVectors.call(this,ez(ez({},e),{},{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))}async deleteVectors(e){return super.deleteVectors.call(this,ez(ez({},e),{},{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))}},tu=class extends tt{constructor(e,t={},r,n){super(e,t,r,n)}from(e){return new e7(this.url,this.headers,e,this.fetch)}get vectors(){return new ti(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new tr(this.url+"/iceberg",this.headers,this.fetch)}};let tc="2.93.3",th={"X-Client-Info":`gotrue-js/${tc}`},td="X-Supabase-Api-Version",tf={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},tp=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class tg extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function tm(e){return"object"==typeof e&&null!==e&&"__isAuthError"in e}class ty extends tg{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}class tb extends tg{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class t_ extends tg{constructor(e,t,r,n){super(e,r,n),this.name=t,this.status=r}}class tv extends t_{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function tw(e){return tm(e)&&"AuthSessionMissingError"===e.name}class tE extends t_{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class tS extends t_{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class tR extends t_{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class tT extends t_{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class tO extends t_{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function tk(e){return tm(e)&&"AuthRetryableFetchError"===e.name}class tA extends t_{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class tC extends t_{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}let tP="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),tj=" 	\n\r=".split(""),tx=(()=>{let e=Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<tj.length;t+=1)e[tj[t].charCodeAt(0)]=-2;for(let t=0;t<tP.length;t+=1)e[tP[t].charCodeAt(0)]=t;return e})();function tN(e,t,r){if(null!==e)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;)r(tP[t.queue>>t.queuedBits-6&63]),t.queuedBits-=6;else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;)r(tP[t.queue>>t.queuedBits-6&63]),t.queuedBits-=6}function t$(e,t,r){let n=tx[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else if(-2===n)return;else throw Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}function tI(e){let t=[],r=e=>{t.push(String.fromCodePoint(e))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},a=e=>{!function(e,t,r){if(0===t.utf8seq){if(e<=127)return r(e);for(let r=1;r<6;r+=1)if((e>>7-r&1)==0){t.utf8seq=r;break}if(2===t.utf8seq)t.codepoint=31&e;else if(3===t.utf8seq)t.codepoint=15&e;else if(4===t.utf8seq)t.codepoint=7&e;else throw Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|63&e,t.utf8seq-=1,0===t.utf8seq&&r(t.codepoint)}}(e,n,r)};for(let t=0;t<e.length;t+=1)t$(e.charCodeAt(t),s,a);return t.join("")}function tD(e){let t=[],r={queue:0,queuedBits:0},n=e=>{t.push(e)};for(let t=0;t<e.length;t+=1)t$(e.charCodeAt(t),r,n);return new Uint8Array(t)}function tU(e){let t=[],r={queue:0,queuedBits:0},n=e=>{t.push(e)};return e.forEach(e=>tN(e,r,n)),tN(null,r,n),t.join("")}let tM=e=>e?(...t)=>e(...t):(...e)=>fetch(...e),tq=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},tL=async(e,t)=>{let r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch(e){return r}},tB=async(e,t)=>{await e.removeItem(t)};class tH{constructor(){this.promise=new tH.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}function tF(e){let t=e.split(".");if(3!==t.length)throw new tC("Invalid JWT structure");for(let e=0;e<t.length;e++)if(!tp.test(t[e]))throw new tC("JWT not in base64url format");return{header:JSON.parse(tI(t[0])),payload:JSON.parse(tI(t[1])),signature:tD(t[2]),raw:{header:t[0],payload:t[1]}}}async function tG(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function tK(e){return("0"+e.toString(16)).substr(-2)}async function tW(e){let t=new TextEncoder().encode(e);return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",t))).map(e=>String.fromCharCode(e)).join("")}async function tz(e){return"u">typeof crypto&&void 0!==crypto.subtle&&"u">typeof TextEncoder?btoa(await tW(e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""):(console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e)}async function tX(e,t,r=!1){let n=function(){let e=new Uint32Array(56);if("u"<typeof crypto){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length,r="";for(let n=0;n<56;n++)r+=e.charAt(Math.floor(Math.random()*t));return r}return crypto.getRandomValues(e),Array.from(e,tK).join("")}(),s=n;r&&(s+="/PASSWORD_RECOVERY"),await tq(e,`${t}-code-verifier`,s);let a=await tz(n),i=n===a?"plain":"s256";return[a,i]}tH.promiseConstructor=Promise;let tV=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i,tJ=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function tY(e){if(!tJ.test(e))throw Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function tQ(){return new Proxy({},{get:(e,t)=>{if("__isUserNotAvailableProxy"===t)return!0;if("symbol"==typeof t){let e=t.toString();if("Symbol(Symbol.toPrimitive)"===e||"Symbol(Symbol.toStringTag)"===e||"Symbol(util.inspect.custom)"===e)return}throw Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function tZ(e){return JSON.parse(JSON.stringify(e))}let t0=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),t1=[502,503,504];async function t2(e){var t;let r,n;if(!("object"==typeof e&&null!==e&&"status"in e&&"ok"in e&&"json"in e&&"function"==typeof e.json))throw new tO(t0(e),0);if(t1.includes(e.status))throw new tO(t0(e),e.status);try{r=await e.json()}catch(e){throw new tb(t0(e),e)}let s=function(e){let t=e.headers.get(td);if(!t||!t.match(tV))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch(e){return null}}(e);if(s&&s.getTime()>=tf["2024-01-01"].timestamp&&"object"==typeof r&&r&&"string"==typeof r.code?n=r.code:"object"==typeof r&&r&&"string"==typeof r.error_code&&(n=r.error_code),n){if("weak_password"===n)throw new tA(t0(r),e.status,(null==(t=r.weak_password)?void 0:t.reasons)||[]);else if("session_not_found"===n)throw new tv}else if("object"==typeof r&&r&&"object"==typeof r.weak_password&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0))throw new tA(t0(r),e.status,r.weak_password.reasons);throw new ty(t0(r),e.status||500,n)}async function t3(e,t,r,n){var s;let a=Object.assign({},null==n?void 0:n.headers);a[td]||(a[td]=tf["2024-01-01"].name),(null==n?void 0:n.jwt)&&(a.Authorization=`Bearer ${n.jwt}`);let i=null!=(s=null==n?void 0:n.query)?s:{};(null==n?void 0:n.redirectTo)&&(i.redirect_to=n.redirectTo);let o=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",l=await t6(e,t,r+o,{headers:a,noResolveJson:null==n?void 0:n.noResolveJson},{},null==n?void 0:n.body);return(null==n?void 0:n.xform)?null==n?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function t6(e,t,r,n,s,a){let i,o,l=(o={method:t,headers:(null==n?void 0:n.headers)||{}},"GET"===t?o:(o.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==n?void 0:n.headers),o.body=JSON.stringify(a),Object.assign(Object.assign({},o),s)));try{i=await e(r,Object.assign({},l))}catch(e){throw console.error(e),new tO(t0(e),0)}if(i.ok||await t2(i),null==n?void 0:n.noResolveJson)return i;try{return await i.json()}catch(e){await t2(e)}}function t4(e){var t,r,n;let s=null;(n=e).access_token&&n.refresh_token&&n.expires_in&&(s=Object.assign({},e),e.expires_at||(s.expires_at=(r=e.expires_in,Math.round(Date.now()/1e3)+r)));return{data:{session:s,user:null!=(t=e.user)?t:e},error:null}}function t8(e){let t=t4(e);return!t.error&&e.weak_password&&"object"==typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"==typeof e.weak_password.message&&e.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0)&&(t.data.weak_password=e.weak_password),t}function t5(e){var t;return{data:{user:null!=(t=e.user)?t:e},error:null}}function t9(e){return{data:e,error:null}}function t7(e){let{action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:a}=e;return{data:{properties:{action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:a},user:Object.assign({},en(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]))},error:null}}function re(e){return e}let rt=["global","local","others"];class rr{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=tM(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=rt[0]){if(0>rt.indexOf(t))throw Error(`@supabase/auth-js: Parameter scope must be one of ${rt.join(", ")}`);try{return await t3(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(e){if(tm(e))return{data:null,error:e};throw e}}async inviteUserByEmail(e,t={}){try{return await t3(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:t5})}catch(e){if(tm(e))return{data:{user:null},error:e};throw e}}async generateLink(e){try{let{options:t}=e,r=en(e,["options"]),n=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(n.new_email=null==r?void 0:r.newEmail,delete n.newEmail),await t3(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:t7,redirectTo:null==t?void 0:t.redirectTo})}catch(e){if(tm(e))return{data:{properties:null,user:null},error:e};throw e}}async createUser(e){try{return await t3(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:t5})}catch(e){if(tm(e))return{data:{user:null},error:e};throw e}}async listUsers(e){var t,r,n,s,a,i,o;try{let l={nextPage:null,lastPage:0,total:0},u=await t3(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!=(r=null==(t=null==e?void 0:e.page)?void 0:t.toString())?r:"",per_page:null!=(s=null==(n=null==e?void 0:e.perPage)?void 0:n.toString())?s:""},xform:re});if(u.error)throw u.error;let c=await u.json(),h=null!=(a=u.headers.get("x-total-count"))?a:0,d=null!=(o=null==(i=u.headers.get("link"))?void 0:i.split(","))?o:[];return d.length>0&&(d.forEach(e=>{let t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),r=JSON.parse(e.split(";")[1].split("=")[1]);l[`${r}Page`]=t}),l.total=parseInt(h)),{data:Object.assign(Object.assign({},c),l),error:null}}catch(e){if(tm(e))return{data:{users:[]},error:e};throw e}}async getUserById(e){tY(e);try{return await t3(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:t5})}catch(e){if(tm(e))return{data:{user:null},error:e};throw e}}async updateUserById(e,t){tY(e);try{return await t3(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:t5})}catch(e){if(tm(e))return{data:{user:null},error:e};throw e}}async deleteUser(e,t=!1){tY(e);try{return await t3(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:t5})}catch(e){if(tm(e))return{data:{user:null},error:e};throw e}}async _listFactors(e){tY(e.userId);try{let{data:t,error:r}=await t3(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:r}}catch(e){if(tm(e))return{data:null,error:e};throw e}}async _deleteFactor(e){tY(e.userId),tY(e.id);try{return{data:await t3(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(e){if(tm(e))return{data:null,error:e};throw e}}async _listOAuthClients(e){var t,r,n,s,a,i,o;try{let l={nextPage:null,lastPage:0,total:0},u=await t3(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:null!=(r=null==(t=null==e?void 0:e.page)?void 0:t.toString())?r:"",per_page:null!=(s=null==(n=null==e?void 0:e.perPage)?void 0:n.toString())?s:""},xform:re});if(u.error)throw u.error;let c=await u.json(),h=null!=(a=u.headers.get("x-total-count"))?a:0,d=null!=(o=null==(i=u.headers.get("link"))?void 0:i.split(","))?o:[];return d.length>0&&(d.forEach(e=>{let t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),r=JSON.parse(e.split(";")[1].split("=")[1]);l[`${r}Page`]=t}),l.total=parseInt(h)),{data:Object.assign(Object.assign({},c),l),error:null}}catch(e){if(tm(e))return{data:{clients:[]},error:e};throw e}}async _createOAuthClient(e){try{return await t3(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(tm(e))return{data:null,error:e};throw e}}async _getOAuthClient(e){try{return await t3(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(tm(e))return{data:null,error:e};throw e}}async _updateOAuthClient(e,t){try{return await t3(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:t,headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(tm(e))return{data:null,error:e};throw e}}async _deleteOAuthClient(e){try{return await t3(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(e){if(tm(e))return{data:null,error:e};throw e}}async _regenerateOAuthClientSecret(e){try{return await t3(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(tm(e))return{data:null,error:e};throw e}}}function rn(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}globalThis;class rs extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}function ra(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}class ri extends Error{constructor({message:e,code:t,cause:r,name:n}){var s;super(e,{cause:r}),this.__isWebAuthnError=!0,this.name=null!=(s=null!=n?n:r instanceof Error?r.name:void 0)?s:"Unknown Error",this.code=t}}class ro extends ri{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}let rl=new class{createNewAbortSignal(){if(this.controller){let e=Error("Cancelling existing WebAuthn API call for new one");e.name="AbortError",this.controller.abort(e)}let e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){let e=Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}};function ru(e){return"localhost"===e||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}async function rc(e){try{let t=await navigator.credentials.create(e);if(!t)return{data:null,error:new ro("Empty credential response",t)};if(!(t instanceof PublicKeyCredential))return{data:null,error:new ro("Browser returned unexpected credential type",t)};return{data:t,error:null}}catch(t){return{data:null,error:function({error:e,options:t}){var r,n,s;let{publicKey:a}=t;if(!a)throw Error("options was missing required publicKey property");if("AbortError"===e.name){if(t.signal instanceof AbortSignal)return new ri({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if("ConstraintError"===e.name){if((null==(r=a.authenticatorSelection)?void 0:r.requireResidentKey)===!0)return new ri({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});else if("conditional"===t.mediation&&(null==(n=a.authenticatorSelection)?void 0:n.userVerification)==="required")return new ri({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});else if((null==(s=a.authenticatorSelection)?void 0:s.userVerification)==="required")return new ri({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else if("InvalidStateError"===e.name)return new ri({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});else if("NotAllowedError"===e.name)return new ri({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});else if("NotSupportedError"===e.name)return new ri(0===a.pubKeyCredParams.filter(e=>"public-key"===e.type).length?{message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}:{message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});else if("SecurityError"===e.name){let t=window.location.hostname;if(!ru(t))return new ri({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e});if(a.rp.id!==t)return new ri({message:`The RP ID "${a.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else if("TypeError"===e.name){if(a.user.id.byteLength<1||a.user.id.byteLength>64)return new ri({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if("UnknownError"===e.name)return new ri({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e});return new ri({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}({error:t,options:e})}}}async function rh(e){try{let t=await navigator.credentials.get(e);if(!t)return{data:null,error:new ro("Empty credential response",t)};if(!(t instanceof PublicKeyCredential))return{data:null,error:new ro("Browser returned unexpected credential type",t)};return{data:t,error:null}}catch(t){return{data:null,error:function({error:e,options:t}){let{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if("AbortError"===e.name){if(t.signal instanceof AbortSignal)return new ri({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if("NotAllowedError"===e.name)return new ri({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});else if("SecurityError"===e.name){let t=window.location.hostname;if(!ru(t))return new ri({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e});if(r.rpId!==t)return new ri({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else if("UnknownError"===e.name)return new ri({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e});return new ri({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}({error:t,options:e})}}}let rd={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},rf={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function rp(...e){let t=e=>null!==e&&"object"==typeof e&&!Array.isArray(e),r=e=>e instanceof ArrayBuffer||ArrayBuffer.isView(e),n={};for(let s of e)if(s)for(let e in s){let a=s[e];if(void 0!==a)if(Array.isArray(a))n[e]=a;else if(r(a))n[e]=a;else if(t(a)){let r=n[e];t(r)?n[e]=rp(r,a):n[e]=rp(a)}else n[e]=a}return n}class rg{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:r,signal:n},s){var a,i,o,l,u;try{let{data:c,error:h}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!c)return{data:null,error:h};let d=null!=n?n:rl.createNewAbortSignal();if("create"===c.webauthn.type){let{user:e}=c.webauthn.credential_options.publicKey;if(!e.name)if(r)e.name=`${e.id}:${r}`;else{let t=(await this.client.getUser()).data.user,r=(null==(a=null==t?void 0:t.user_metadata)?void 0:a.name)||(null==t?void 0:t.email)||(null==t?void 0:t.id)||"User";e.name=`${e.id}:${r}`}e.displayName||(e.displayName=e.name)}switch(c.webauthn.type){case"create":{let t=(i=c.webauthn.credential_options.publicKey,o=null==s?void 0:s.create,rp(rd,i,o||{})),{data:r,error:n}=await rc({publicKey:t,signal:d});if(r)return{data:{factorId:e,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:r}},error:null};return{data:null,error:n}}case"request":{let t=(l=c.webauthn.credential_options.publicKey,u=null==s?void 0:s.request,rp(rf,l,u||{})),{data:r,error:n}=await rh(Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:t,signal:d}));if(r)return{data:{factorId:e,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:r}},error:null};return{data:null,error:n}}}}catch(e){if(tm(e))return{data:null,error:e};return{data:null,error:new tb("Unexpected error in challenge",e)}}}async _verify({challengeId:e,factorId:t,webauthn:r}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:r})}async _authenticate({factorId:e,webauthn:{rpId:t,rpOrigins:r,signal:n}={}},s){if(!t)return{data:null,error:new tg("rpId is required for WebAuthn authentication")};try{1;return{data:null,error:new tb("Browser does not support WebAuthn",null)}}catch(e){if(tm(e))return{data:null,error:e};return{data:null,error:new tb("Unexpected error in authenticate",e)}}}async _register({friendlyName:e,webauthn:{rpId:t,rpOrigins:r,signal:n}={}},s){if(!t)return{data:null,error:new tg("rpId is required for WebAuthn registration")};try{1;return{data:null,error:new tb("Browser does not support WebAuthn",null)}}catch(e){if(tm(e))return{data:null,error:e};return{data:null,error:new tb("Unexpected error in register",e)}}}}if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"u">typeof self&&(self.globalThis=self)}let rm={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:th,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function ry(e,t,r){return await r()}let rb={};class r_{get jwks(){var e,t;return null!=(t=null==(e=rb[this.storageKey])?void 0:e.jwks)?t:{keys:[]}}set jwks(e){rb[this.storageKey]=Object.assign(Object.assign({},rb[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return null!=(t=null==(e=rb[this.storageKey])?void 0:e.cachedAt)?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){rb[this.storageKey]=Object.assign(Object.assign({},rb[this.storageKey]),{cachedAt:e})}constructor(e){var t;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const r=Object.assign(Object.assign({},rm),e);this.storageKey=r.storageKey,this.instanceID=null!=(t=r_.nextInstanceID[this.storageKey])?t:0,r_.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!r.debug,"function"==typeof r.debug&&(this.logger=r.debug),this.instanceID,this.persistSession=r.persistSession,this.autoRefreshToken=r.autoRefreshToken,this.admin=new rr({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=tM(r.fetch),this.lock=r.lock||ry,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,this.throwOnError=r.throwOnError,this.lockAcquireTimeout=r.lockAcquireTimeout,r.lock?this.lock=r.lock:(this.persistSession,this.lock=ry),this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new rg(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(r.storage?this.storage=r.storage:(this.memoryStorage={},this.storage=rn(this.memoryStorage)),r.userStorage&&(this.userStorage=r.userStorage)):(this.memoryStorage={},this.storage=rn(this.memoryStorage)),this.initialize().catch(e=>{this._debug("#initialize()","error",e)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${tc}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))()),await this.initializePromise}async _initialize(){try{return await this._recoverAndRefresh(),{error:null}}catch(e){if(tm(e))return this._returnResult({error:e});return this._returnResult({error:new tb("Unexpected error during initialization",e)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,n;try{let{data:s,error:a}=await t3(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!=(r=null==(t=null==e?void 0:e.options)?void 0:t.data)?r:{},gotrue_meta_security:{captcha_token:null==(n=null==e?void 0:e.options)?void 0:n.captchaToken}},xform:t4});if(a||!s)return this._returnResult({data:{user:null,session:null},error:a});let i=s.session,o=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",i)),this._returnResult({data:{user:o,session:i},error:null})}catch(e){if(tm(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signUp(e){var t,r,n;try{let s;if("email"in e){let{email:r,password:n,options:a}=e,i=null,o=null;"pkce"===this.flowType&&([i,o]=await tX(this.storage,this.storageKey)),s=await t3(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==a?void 0:a.emailRedirectTo,body:{email:r,password:n,data:null!=(t=null==a?void 0:a.data)?t:{},gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken},code_challenge:i,code_challenge_method:o},xform:t4})}else if("phone"in e){let{phone:t,password:a,options:i}=e;s=await t3(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:t,password:a,data:null!=(r=null==i?void 0:i.data)?r:{},channel:null!=(n=null==i?void 0:i.channel)?n:"sms",gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},xform:t4})}else throw new tS("You must provide either an email or phone number and a password");let{data:a,error:i}=s;if(i||!a)return await tB(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:i});let o=a.session,l=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",o)),this._returnResult({data:{user:l,session:o},error:null})}catch(e){if(await tB(this.storage,`${this.storageKey}-code-verifier`),tm(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signInWithPassword(e){try{let t;if("email"in e){let{email:r,password:n,options:s}=e;t=await t3(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:r,password:n,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken}},xform:t8})}else if("phone"in e){let{phone:r,password:n,options:s}=e;t=await t3(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:r,password:n,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken}},xform:t8})}else throw new tS("You must provide either an email or phone number and a password");let{data:r,error:n}=t;if(n)return this._returnResult({data:{user:null,session:null},error:n});if(!r||!r.session||!r.user){let e=new tE;return this._returnResult({data:{user:null,session:null},error:e})}return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),this._returnResult({data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:n})}catch(e){if(tm(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signInWithOAuth(e){var t,r,n,s;return await this._handleProviderSignIn(e.provider,{redirectTo:null==(t=e.options)?void 0:t.redirectTo,scopes:null==(r=e.options)?void 0:r.scopes,queryParams:null==(n=e.options)?void 0:n.queryParams,skipBrowserRedirect:null==(s=e.options)?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){let{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,r,n,s,a,i,o,l,u,c,h,d;let f,p;if("message"in e)f=e.message,p=e.signature;else{let{chain:c,wallet:h,statement:g,options:m}=e;if("object"!=typeof h||!(null==m?void 0:m.url))throw Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");let y=new URL(null!=(t=null==m?void 0:m.url)?t:window.location.href),b=await h.request({method:"eth_requestAccounts"}).then(e=>e).catch(()=>{throw Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!b||0===b.length)throw Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");let _=ra(b[0]),v=null==(r=null==m?void 0:m.signInWithEthereum)?void 0:r.chainId;v||(v=parseInt(await h.request({method:"eth_chainId"}),16)),f=function(e){var t;let{chainId:r,domain:n,expirationTime:s,issuedAt:a=new Date,nonce:i,notBefore:o,requestId:l,resources:u,scheme:c,uri:h,version:d}=e;if(!Number.isInteger(r))throw Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(i&&i.length<8)throw Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${i}`);if(!h)throw Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if("1"!==d)throw Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${d}`);if(null==(t=e.statement)?void 0:t.includes("\n"))throw Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`);let f=ra(e.address),p=c?`${c}://${n}`:n,g=e.statement?`${e.statement}
`:"",m=`${p} wants you to sign in with your Ethereum account:
${f}

${g}`,y=`URI: ${h}
Version: ${d}
Chain ID: ${r}${i?`
Nonce: ${i}`:""}
Issued At: ${a.toISOString()}`;if(s&&(y+=`
Expiration Time: ${s.toISOString()}`),o&&(y+=`
Not Before: ${o.toISOString()}`),l&&(y+=`
Request ID: ${l}`),u){let e="\nResources:";for(let t of u){if(!t||"string"!=typeof t)throw Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${t}`);e+=`
- ${t}`}y+=e}return`${m}
${y}`}({domain:y.host,address:_,statement:g,uri:y.href,version:"1",chainId:v,nonce:null==(n=null==m?void 0:m.signInWithEthereum)?void 0:n.nonce,issuedAt:null!=(a=null==(s=null==m?void 0:m.signInWithEthereum)?void 0:s.issuedAt)?a:new Date,expirationTime:null==(i=null==m?void 0:m.signInWithEthereum)?void 0:i.expirationTime,notBefore:null==(o=null==m?void 0:m.signInWithEthereum)?void 0:o.notBefore,requestId:null==(l=null==m?void 0:m.signInWithEthereum)?void 0:l.requestId,resources:null==(u=null==m?void 0:m.signInWithEthereum)?void 0:u.resources}),p=await h.request({method:"personal_sign",params:[(d=f,"0x"+Array.from(new TextEncoder().encode(d),e=>e.toString(16).padStart(2,"0")).join("")),_]})}try{let{data:t,error:r}=await t3(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:f,signature:p},(null==(c=e.options)?void 0:c.captchaToken)?{gotrue_meta_security:{captcha_token:null==(h=e.options)?void 0:h.captchaToken}}:null),xform:t4});if(r)throw r;if(!t||!t.session||!t.user){let e=new tE;return this._returnResult({data:{user:null,session:null},error:e})}return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),this._returnResult({data:Object.assign({},t),error:r})}catch(e){if(tm(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signInWithSolana(e){var t,r,n,s,a,i,o,l,u,c,h,d;let f,p;if("message"in e)f=e.message,p=e.signature;else{let{chain:h,wallet:d,statement:g,options:m}=e;if("object"!=typeof d||!(null==m?void 0:m.url))throw Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");let y=new URL(null!=(t=null==m?void 0:m.url)?t:window.location.href);if("signIn"in d&&d.signIn){let e,t=await d.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},null==m?void 0:m.signInWithSolana),{version:"1",domain:y.host,uri:y.href}),g?{statement:g}:null));if(Array.isArray(t)&&t[0]&&"object"==typeof t[0])e=t[0];else if(t&&"object"==typeof t&&"signedMessage"in t&&"signature"in t)e=t;else throw Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in e&&"signature"in e&&("string"==typeof e.signedMessage||e.signedMessage instanceof Uint8Array)&&e.signature instanceof Uint8Array)f="string"==typeof e.signedMessage?e.signedMessage:new TextDecoder().decode(e.signedMessage),p=e.signature;else throw Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in d)||"function"!=typeof d.signMessage||!("publicKey"in d)||"object"!=typeof d||!d.publicKey||!("toBase58"in d.publicKey)||"function"!=typeof d.publicKey.toBase58)throw Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");f=[`${y.host} wants you to sign in with your Solana account:`,d.publicKey.toBase58(),...g?["",g,""]:[""],"Version: 1",`URI: ${y.href}`,`Issued At: ${null!=(n=null==(r=null==m?void 0:m.signInWithSolana)?void 0:r.issuedAt)?n:new Date().toISOString()}`,...(null==(s=null==m?void 0:m.signInWithSolana)?void 0:s.notBefore)?[`Not Before: ${m.signInWithSolana.notBefore}`]:[],...(null==(a=null==m?void 0:m.signInWithSolana)?void 0:a.expirationTime)?[`Expiration Time: ${m.signInWithSolana.expirationTime}`]:[],...(null==(i=null==m?void 0:m.signInWithSolana)?void 0:i.chainId)?[`Chain ID: ${m.signInWithSolana.chainId}`]:[],...(null==(o=null==m?void 0:m.signInWithSolana)?void 0:o.nonce)?[`Nonce: ${m.signInWithSolana.nonce}`]:[],...(null==(l=null==m?void 0:m.signInWithSolana)?void 0:l.requestId)?[`Request ID: ${m.signInWithSolana.requestId}`]:[],...(null==(c=null==(u=null==m?void 0:m.signInWithSolana)?void 0:u.resources)?void 0:c.length)?["Resources",...m.signInWithSolana.resources.map(e=>`- ${e}`)]:[]].join("\n");let e=await d.signMessage(new TextEncoder().encode(f),"utf8");if(!e||!(e instanceof Uint8Array))throw Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");p=e}}try{let{data:t,error:r}=await t3(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:f,signature:tU(p)},(null==(h=e.options)?void 0:h.captchaToken)?{gotrue_meta_security:{captcha_token:null==(d=e.options)?void 0:d.captchaToken}}:null),xform:t4});if(r)throw r;if(!t||!t.session||!t.user){let e=new tE;return this._returnResult({data:{user:null,session:null},error:e})}return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),this._returnResult({data:Object.assign({},t),error:r})}catch(e){if(tm(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async _exchangeCodeForSession(e){let t=await tL(this.storage,`${this.storageKey}-code-verifier`),[r,n]=(null!=t?t:"").split("/");try{if(!r&&"pkce"===this.flowType)throw new tT;let{data:t,error:s}=await t3(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:t4});if(await tB(this.storage,`${this.storageKey}-code-verifier`),s)throw s;if(!t||!t.session||!t.user){let e=new tE;return this._returnResult({data:{user:null,session:null,redirectType:null},error:e})}return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),this._returnResult({data:Object.assign(Object.assign({},t),{redirectType:null!=n?n:null}),error:s})}catch(e){if(await tB(this.storage,`${this.storageKey}-code-verifier`),tm(e))return this._returnResult({data:{user:null,session:null,redirectType:null},error:e});throw e}}async signInWithIdToken(e){try{let{options:t,provider:r,token:n,access_token:s,nonce:a}=e,{data:i,error:o}=await t3(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:n,access_token:s,nonce:a,gotrue_meta_security:{captcha_token:null==t?void 0:t.captchaToken}},xform:t4});if(o)return this._returnResult({data:{user:null,session:null},error:o});if(!i||!i.session||!i.user){let e=new tE;return this._returnResult({data:{user:null,session:null},error:e})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:i,error:o})}catch(e){if(tm(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signInWithOtp(e){var t,r,n,s,a;try{if("email"in e){let{email:n,options:s}=e,a=null,i=null;"pkce"===this.flowType&&([a,i]=await tX(this.storage,this.storageKey));let{error:o}=await t3(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:n,data:null!=(t=null==s?void 0:s.data)?t:{},create_user:null==(r=null==s?void 0:s.shouldCreateUser)||r,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken},code_challenge:a,code_challenge_method:i},redirectTo:null==s?void 0:s.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}if("phone"in e){let{phone:t,options:r}=e,{data:i,error:o}=await t3(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:t,data:null!=(n=null==r?void 0:r.data)?n:{},create_user:null==(s=null==r?void 0:r.shouldCreateUser)||s,gotrue_meta_security:{captcha_token:null==r?void 0:r.captchaToken},channel:null!=(a=null==r?void 0:r.channel)?a:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:null==i?void 0:i.message_id},error:o})}throw new tS("You must provide either an email or phone number.")}catch(e){if(await tB(this.storage,`${this.storageKey}-code-verifier`),tm(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async verifyOtp(e){var t,r;try{let n,s;"options"in e&&(n=null==(t=e.options)?void 0:t.redirectTo,s=null==(r=e.options)?void 0:r.captchaToken);let{data:a,error:i}=await t3(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:n,xform:t4});if(i)throw i;if(!a)throw Error("An error occurred on token verification.");let o=a.session,l=a.user;return(null==o?void 0:o.access_token)&&(await this._saveSession(o),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",o)),this._returnResult({data:{user:l,session:o},error:null})}catch(e){if(tm(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signInWithSSO(e){var t,r,n,s;try{let a=null,i=null;"pkce"===this.flowType&&([a,i]=await tX(this.storage,this.storageKey));let o=await t3(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!=(r=null==(t=e.options)?void 0:t.redirectTo)?r:void 0}),(null==(n=null==e?void 0:e.options)?void 0:n.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:i}),headers:this.headers,xform:t9});return null==(s=o.data)||s.url,this._returnResult(o)}catch(e){if(await tB(this.storage,`${this.storageKey}-code-verifier`),tm(e))return this._returnResult({data:null,error:e});throw e}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{let{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new tv;let{error:n}=await t3(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:n})})}catch(e){if(tm(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{let t=`${this.url}/resend`;if("email"in e){let{email:r,type:n,options:s}=e,{error:a}=await t3(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:n,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken}},redirectTo:null==s?void 0:s.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:a})}if("phone"in e){let{phone:r,type:n,options:s}=e,{data:a,error:i}=await t3(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:n,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:null==a?void 0:a.message_id},error:i})}throw new tS("You must provide either an email or phone number and a type")}catch(e){if(tm(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async e=>e))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){let e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await r}catch(e){}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;let e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(e){}})()),await e;this.pendingInLock.length;){let e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{let t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",Error().stack);try{let t=null,r=await tL(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),null!==r&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};let n=!!t.expires_at&&1e3*t.expires_at-Date.now()<9e4;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){let e=await tL(this.userStorage,this.storageKey+"-user");(null==e?void 0:e.user)?t.user=e.user:t.user=tQ()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){var e;let r={value:this.suppressGetSessionWarning};t.user=(e=t.user,new Proxy(e,{get:(e,t,n)=>{if("__isInsecureUserWarningProxy"===t)return!0;if("symbol"==typeof t){let r=t.toString();if("Symbol(Symbol.toPrimitive)"===r||"Symbol(Symbol.toStringTag)"===r||"Symbol(util.inspect.custom)"===r||"Symbol(nodejs.util.inspect.custom)"===r)return Reflect.get(e,t,n)}return r.value||"string"!=typeof t||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),r.value=!0),Reflect.get(e,t,n)}})),r.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}let{data:s,error:a}=await this._callRefreshToken(t.refresh_token);if(a)return this._returnResult({data:{session:null},error:a});return this._returnResult({data:{session:s},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;let t=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return t.data.user&&(this.suppressGetSessionWarning=!0),t}async _getUser(e){try{if(e)return await t3(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:t5});return await this._useSession(async e=>{var t,r,n;let{data:s,error:a}=e;if(a)throw a;return(null==(t=s.session)?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await t3(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!=(n=null==(r=s.session)?void 0:r.access_token)?n:void 0,xform:t5}):{data:{user:null},error:new tv}})}catch(e){if(tm(e))return tw(e)&&(await this._removeSession(),await tB(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:e});throw e}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{let{data:n,error:s}=r;if(s)throw s;if(!n.session)throw new tv;let a=n.session,i=null,o=null;"pkce"===this.flowType&&null!=e.email&&([i,o]=await tX(this.storage,this.storageKey));let{data:l,error:u}=await t3(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:i,code_challenge_method:o}),jwt:a.access_token,xform:t5});if(u)throw u;return a.user=l.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),this._returnResult({data:{user:a.user},error:null})})}catch(e){if(await tB(this.storage,`${this.storageKey}-code-verifier`),tm(e))return this._returnResult({data:{user:null},error:e});throw e}}async setSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new tv;let t=Date.now()/1e3,r=t,n=!0,s=null,{payload:a}=tF(e.access_token);if(a.exp&&(n=(r=a.exp)<=t),n){let{data:t,error:r}=await this._callRefreshToken(e.refresh_token);if(r)return this._returnResult({data:{user:null,session:null},error:r});if(!t)return{data:{user:null,session:null},error:null};s=t}else{let{data:n,error:a}=await this._getUser(e.access_token);if(a)return this._returnResult({data:{user:null,session:null},error:a});s={access_token:e.access_token,refresh_token:e.refresh_token,user:n.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return this._returnResult({data:{user:s.user,session:s},error:null})}catch(e){if(tm(e))return this._returnResult({data:{session:null,user:null},error:e});throw e}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){let{data:n,error:s}=t;if(s)throw s;e=null!=(r=n.session)?r:void 0}if(!(null==e?void 0:e.refresh_token))throw new tv;let{data:n,error:s}=await this._callRefreshToken(e.refresh_token);return s?this._returnResult({data:{user:null,session:null},error:s}):n?this._returnResult({data:{user:n.user,session:n},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(e){if(tm(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async _getSessionFromURL(e,t){try{throw new tR("No browser detected.")}catch(e){if(tm(e))return this._returnResult({data:{session:null,redirectType:null},error:e});throw e}}_isImplicitGrantCallback(e){return"function"==typeof this.detectSessionInUrl?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){let t=await tL(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;let{data:n,error:s}=t;if(s&&!tw(s))return this._returnResult({error:s});let a=null==(r=n.session)?void 0:r.access_token;if(a){let{error:t}=await this.admin.signOut(a,e);if(t&&!(tm(t)&&"AuthApiError"===t.name&&(404===t.status||401===t.status||403===t.status)||tw(t)))return this._returnResult({error:t})}return"others"!==e&&(await this._removeSession(),await tB(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){let t=Symbol("auth-callback"),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>{await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(t)})})(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,n;try{let{data:{session:n},error:s}=t;if(s)throw s;await (null==(r=this.stateChangeEmitters.get(e))?void 0:r.callback("INITIAL_SESSION",n)),this._debug("INITIAL_SESSION","callback id",e,"session",n)}catch(t){await (null==(n=this.stateChangeEmitters.get(e))?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",t),console.error(t)}})}async resetPasswordForEmail(e,t={}){let r=null,n=null;"pkce"===this.flowType&&([r,n]=await tX(this.storage,this.storageKey,!0));try{return await t3(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:n,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(e){if(await tB(this.storage,`${this.storageKey}-code-verifier`),tm(e))return this._returnResult({data:null,error:e});throw e}}async getUserIdentities(){var e;try{let{data:t,error:r}=await this.getUser();if(r)throw r;return this._returnResult({data:{identities:null!=(e=t.user.identities)?e:[]},error:null})}catch(e){if(tm(e))return this._returnResult({data:null,error:e});throw e}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){try{let{data:t,error:r}=await this._useSession(async t=>{var r,n,s,a,i;let{data:o,error:l}=t;if(l)throw l;let u=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:null==(r=e.options)?void 0:r.redirectTo,scopes:null==(n=e.options)?void 0:n.scopes,queryParams:null==(s=e.options)?void 0:s.queryParams,skipBrowserRedirect:!0});return await t3(this.fetch,"GET",u,{headers:this.headers,jwt:null!=(i=null==(a=o.session)?void 0:a.access_token)?i:void 0})});if(r)throw r;return this._returnResult({data:{provider:e.provider,url:null==t?void 0:t.url},error:null})}catch(t){if(tm(t))return this._returnResult({data:{provider:e.provider,url:null},error:t});throw t}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var r;try{let{error:n,data:{session:s}}=t;if(n)throw n;let{options:a,provider:i,token:o,access_token:l,nonce:u}=e,{data:c,error:h}=await t3(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:null!=(r=null==s?void 0:s.access_token)?r:void 0,body:{provider:i,id_token:o,access_token:l,nonce:u,link_identity:!0,gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken}},xform:t4});if(h)return this._returnResult({data:{user:null,session:null},error:h});if(!c||!c.session||!c.user)return this._returnResult({data:{user:null,session:null},error:new tE});return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("USER_UPDATED",c.session)),this._returnResult({data:c,error:h})}catch(e){if(await tB(this.storage,`${this.storageKey}-code-verifier`),tm(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,n;let{data:s,error:a}=t;if(a)throw a;return await t3(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:null!=(n=null==(r=s.session)?void 0:r.access_token)?n:void 0})})}catch(e){if(tm(e))return this._returnResult({data:null,error:e});throw e}}async _refreshAccessToken(e){let t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{var r,n;let s=Date.now();return await (r=async r=>(r>0&&await tG(200*Math.pow(2,r-1)),this._debug(t,"refreshing attempt",r),await t3(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:t4})),n=(e,t)=>{let r=200*Math.pow(2,e);return t&&tk(t)&&Date.now()+r-s<3e4},new Promise((e,t)=>{(async()=>{for(let s=0;s<1/0;s++)try{let t=await r(s);if(!n(s,null,t))return void e(t)}catch(e){if(!n(s,e))return void t(e)}})()}))}catch(e){if(this._debug(t,"error",e),tm(e))return this._returnResult({data:{session:null,user:null},error:e});throw e}finally{this._debug(t,"end")}}_isValidSession(e){return"object"==typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){let r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,t;let r="#_recoverAndRefresh()";this._debug(r,"begin");try{let n=await tL(this.storage,this.storageKey);if(n&&this.userStorage){let t=await tL(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!t&&(t={user:n.user},await tq(this.userStorage,this.storageKey+"-user",t)),n.user=null!=(e=null==t?void 0:t.user)?e:tQ()}else if(n&&!n.user&&!n.user){let e=await tL(this.storage,this.storageKey+"-user");e&&(null==e?void 0:e.user)?(n.user=e.user,await tB(this.storage,this.storageKey+"-user"),await tq(this.storage,this.storageKey,n)):n.user=tQ()}if(this._debug(r,"session from storage",n),!this._isValidSession(n)){this._debug(r,"session is not valid"),null!==n&&await this._removeSession();return}let s=(null!=(t=n.expires_at)?t:1/0)*1e3-Date.now()<9e4;if(this._debug(r,`session has${s?"":" not"} expired with margin of 90000s`),s){if(this.autoRefreshToken&&n.refresh_token){let{error:e}=await this._callRefreshToken(n.refresh_token);e&&(console.error(e),tk(e)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else if(n.user&&!0===n.user.__isUserNotAvailableProxy)try{let{data:e,error:t}=await this._getUser(n.access_token);!t&&(null==e?void 0:e.user)?(n.user=e.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(e){console.error("Error getting user data:",e),this._debug(r,"error getting user data, skipping SIGNED_IN notification",e)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(e){this._debug(r,"error",e),console.error(e);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new tv;if(this.refreshingDeferred)return this.refreshingDeferred.promise;let n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new tH;let{data:t,error:r}=await this._refreshAccessToken(e);if(r)throw r;if(!t.session)throw new tv;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);let n={data:t.session,error:null};return this.refreshingDeferred.resolve(n),n}catch(e){if(this._debug(n,"error",e),tm(e)){let r={data:null,error:e};return tk(e)||await this._removeSession(),null==(t=this.refreshingDeferred)||t.resolve(r),r}throw null==(r=this.refreshingDeferred)||r.reject(e),e}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,t,r=!0){let n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});let n=[],s=Array.from(this.stateChangeEmitters.values()).map(async r=>{try{await r.callback(e,t)}catch(e){n.push(e)}});if(await Promise.all(s),n.length>0){for(let e=0;e<n.length;e+=1)console.error(n[e]);throw n[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await tB(this.storage,`${this.storageKey}-code-verifier`);let t=Object.assign({},e),r=t.user&&!0===t.user.__isUserNotAvailableProxy;if(this.userStorage){!r&&t.user&&await tq(this.userStorage,this.storageKey+"-user",{user:t.user});let e=Object.assign({},t);delete e.user;let n=tZ(e);await tq(this.storage,this.storageKey,n)}else{let e=tZ(t);await tq(this.storage,this.storageKey,e)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await tB(this.storage,this.storageKey),await tB(this.storage,this.storageKey+"-code-verifier"),await tB(this.storage,this.storageKey+"-user"),this.userStorage&&await tB(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()"),this.visibilityChangedCallback,this.visibilityChangedCallback=null}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");let e=setInterval(()=>this._autoRefreshTokenTick(),3e4);this.autoRefreshTicker=e,e&&"object"==typeof e&&"function"==typeof e.unref?e.unref():"u">typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(e);let t=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=t,t&&"object"==typeof t&&"function"==typeof t.unref?t.unref():"u">typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(t)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");let e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e);let t=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,t&&clearTimeout(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{let e=Date.now();try{return await this._useSession(async t=>{let{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");let n=Math.floor((1e3*r.expires_at-e)/3e4);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),n<=3&&await this._callRefreshToken(r.refresh_token)})}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof rs)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){return this._debug("#_handleVisibilityChange()"),this.autoRefreshToken&&this.startAutoRefresh(),!1}async _onVisibilityChanged(e){let t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{"visible"!==document.visibilityState?this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting"):await this._recoverAndRefresh()}))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){let n=[`provider=${encodeURIComponent(t)}`];if((null==r?void 0:r.redirectTo)&&n.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),(null==r?void 0:r.scopes)&&n.push(`scopes=${encodeURIComponent(r.scopes)}`),"pkce"===this.flowType){let[e,t]=await tX(this.storage,this.storageKey),r=new URLSearchParams({code_challenge:`${encodeURIComponent(e)}`,code_challenge_method:`${encodeURIComponent(t)}`});n.push(r.toString())}if(null==r?void 0:r.queryParams){let e=new URLSearchParams(r.queryParams);n.push(e.toString())}return(null==r?void 0:r.skipBrowserRedirect)&&n.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;let{data:n,error:s}=t;return s?this._returnResult({data:null,error:s}):await t3(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:null==(r=null==n?void 0:n.session)?void 0:r.access_token})})}catch(e){if(tm(e))return this._returnResult({data:null,error:e});throw e}}async _enroll(e){try{return await this._useSession(async t=>{var r,n;let{data:s,error:a}=t;if(a)return this._returnResult({data:null,error:a});let i=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:"totp"===e.factorType?{issuer:e.issuer}:{}),{data:o,error:l}=await t3(this.fetch,"POST",`${this.url}/factors`,{body:i,headers:this.headers,jwt:null==(r=null==s?void 0:s.session)?void 0:r.access_token});return l?this._returnResult({data:null,error:l}):("totp"===e.factorType&&"totp"===o.type&&(null==(n=null==o?void 0:o.totp)?void 0:n.qr_code)&&(o.totp.qr_code=`data:image/svg+xml;utf-8,${o.totp.qr_code}`),this._returnResult({data:o,error:null}))})}catch(e){if(tm(e))return this._returnResult({data:null,error:e});throw e}}async _verify(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var r,n,s;let{data:a,error:i}=t;if(i)return this._returnResult({data:null,error:i});let o=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:"create"===e.webauthn.type?(n=e.webauthn.credential_response,"toJSON"in n&&"function"==typeof n.toJSON?n.toJSON():{id:n.id,rawId:n.id,response:{attestationObject:tU(new Uint8Array(n.response.attestationObject)),clientDataJSON:tU(new Uint8Array(n.response.clientDataJSON))},type:"public-key",clientExtensionResults:n.getClientExtensionResults(),authenticatorAttachment:null!=(s=n.authenticatorAttachment)?s:void 0}):function(e){var t;if("toJSON"in e&&"function"==typeof e.toJSON)return e.toJSON();let r=e.getClientExtensionResults(),n=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:tU(new Uint8Array(n.authenticatorData)),clientDataJSON:tU(new Uint8Array(n.clientDataJSON)),signature:tU(new Uint8Array(n.signature)),userHandle:n.userHandle?tU(new Uint8Array(n.userHandle)):void 0},type:"public-key",clientExtensionResults:r,authenticatorAttachment:null!=(t=e.authenticatorAttachment)?t:void 0}}(e.webauthn.credential_response)})}:{code:e.code}),{data:l,error:u}=await t3(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:o,headers:this.headers,jwt:null==(r=null==a?void 0:a.session)?void 0:r.access_token});return u?this._returnResult({data:null,error:u}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:u}))})}catch(e){if(tm(e))return this._returnResult({data:null,error:e});throw e}})}async _challenge(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var r;let{data:n,error:s}=t;if(s)return this._returnResult({data:null,error:s});let a=await t3(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:null==(r=null==n?void 0:n.session)?void 0:r.access_token});if(a.error)return a;let{data:i}=a;if("webauthn"!==i.type)return{data:i,error:null};switch(i.webauthn.type){case"create":return{data:Object.assign(Object.assign({},i),{webauthn:Object.assign(Object.assign({},i.webauthn),{credential_options:Object.assign(Object.assign({},i.webauthn.credential_options),{publicKey:function(e){if(!e)throw Error("Credential creation options are required");if("u">typeof PublicKeyCredential&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&"function"==typeof PublicKeyCredential.parseCreationOptionsFromJSON)return PublicKeyCredential.parseCreationOptionsFromJSON(e);let{challenge:t,user:r,excludeCredentials:n}=e,s=en(e,["challenge","user","excludeCredentials"]),a=tD(t).buffer,i=Object.assign(Object.assign({},r),{id:tD(r.id).buffer}),o=Object.assign(Object.assign({},s),{challenge:a,user:i});if(n&&n.length>0){o.excludeCredentials=Array(n.length);for(let e=0;e<n.length;e++){let t=n[e];o.excludeCredentials[e]=Object.assign(Object.assign({},t),{id:tD(t.id).buffer,type:t.type||"public-key",transports:t.transports})}}return o}(i.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},i),{webauthn:Object.assign(Object.assign({},i.webauthn),{credential_options:Object.assign(Object.assign({},i.webauthn.credential_options),{publicKey:function(e){if(!e)throw Error("Credential request options are required");if("u">typeof PublicKeyCredential&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&"function"==typeof PublicKeyCredential.parseRequestOptionsFromJSON)return PublicKeyCredential.parseRequestOptionsFromJSON(e);let{challenge:t,allowCredentials:r}=e,n=en(e,["challenge","allowCredentials"]),s=tD(t).buffer,a=Object.assign(Object.assign({},n),{challenge:s});if(r&&r.length>0){a.allowCredentials=Array(r.length);for(let e=0;e<r.length;e++){let t=r[e];a.allowCredentials[e]=Object.assign(Object.assign({},t),{id:tD(t.id).buffer,type:t.type||"public-key",transports:t.transports})}}return a}(i.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(e){if(tm(e))return this._returnResult({data:null,error:e});throw e}})}async _challengeAndVerify(e){let{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?this._returnResult({data:null,error:r}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;let{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};let n={all:[],phone:[],totp:[],webauthn:[]};for(let r of null!=(e=null==t?void 0:t.factors)?e:[])n.all.push(r),"verified"===r.status&&n[r.factor_type].push(r);return{data:n,error:null}}async _getAuthenticatorAssuranceLevel(e){var t,r,n,s;if(e)try{let{payload:n}=tF(e),s=null;n.aal&&(s=n.aal);let a=s,{data:{user:i},error:o}=await this.getUser(e);if(o)return this._returnResult({data:null,error:o});(null!=(r=null==(t=null==i?void 0:i.factors)?void 0:t.filter(e=>"verified"===e.status))?r:[]).length>0&&(a="aal2");let l=n.amr||[];return{data:{currentLevel:s,nextLevel:a,currentAuthenticationMethods:l},error:null}}catch(e){if(tm(e))return this._returnResult({data:null,error:e});throw e}let{data:{session:a},error:i}=await this.getSession();if(i)return this._returnResult({data:null,error:i});if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};let{payload:o}=tF(a.access_token),l=null;o.aal&&(l=o.aal);let u=l;return(null!=(s=null==(n=a.user.factors)?void 0:n.filter(e=>"verified"===e.status))?s:[]).length>0&&(u="aal2"),{data:{currentLevel:l,nextLevel:u,currentAuthenticationMethods:o.amr||[]},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{let{data:{session:r},error:n}=t;return n?this._returnResult({data:null,error:n}):r?await t3(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:r.access_token,xform:e=>({data:e,error:null})}):this._returnResult({data:null,error:new tv})})}catch(e){if(tm(e))return this._returnResult({data:null,error:e});throw e}}async _approveAuthorization(e,t){try{return await this._useSession(async t=>{let{data:{session:r},error:n}=t;if(n)return this._returnResult({data:null,error:n});if(!r)return this._returnResult({data:null,error:new tv});let s=await t3(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:r.access_token,body:{action:"approve"},xform:e=>({data:e,error:null})});return s.data&&s.data.redirect_url,s})}catch(e){if(tm(e))return this._returnResult({data:null,error:e});throw e}}async _denyAuthorization(e,t){try{return await this._useSession(async t=>{let{data:{session:r},error:n}=t;if(n)return this._returnResult({data:null,error:n});if(!r)return this._returnResult({data:null,error:new tv});let s=await t3(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:r.access_token,body:{action:"deny"},xform:e=>({data:e,error:null})});return s.data&&s.data.redirect_url,s})}catch(e){if(tm(e))return this._returnResult({data:null,error:e});throw e}}async _listOAuthGrants(){try{return await this._useSession(async e=>{let{data:{session:t},error:r}=e;return r?this._returnResult({data:null,error:r}):t?await t3(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:t.access_token,xform:e=>({data:e,error:null})}):this._returnResult({data:null,error:new tv})})}catch(e){if(tm(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async t=>{let{data:{session:r},error:n}=t;return n?this._returnResult({data:null,error:n}):r?(await t3(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new tv})})}catch(e){if(tm(e))return this._returnResult({data:null,error:e});throw e}}async fetchJwk(e,t={keys:[]}){let r=t.keys.find(t=>t.kid===e);if(r)return r;let n=Date.now();if((r=this.jwks.keys.find(t=>t.kid===e))&&this.jwks_cached_at+6e5>n)return r;let{data:s,error:a}=await t3(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;return s.keys&&0!==s.keys.length&&(this.jwks=s,this.jwks_cached_at=n,r=s.keys.find(t=>t.kid===e))?r:null}async getClaims(e,t={}){try{var r;let n,s=e;if(!s){let{data:e,error:t}=await this.getSession();if(t||!e.session)return this._returnResult({data:null,error:t});s=e.session.access_token}let{header:a,payload:i,signature:o,raw:{header:l,payload:u}}=tF(s);(null==t?void 0:t.allowExpired)||function(e){if(!e)throw Error("Missing exp claim");if(e<=Math.floor(Date.now()/1e3))throw Error("JWT has expired")}(i.exp);let c=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,(null==t?void 0:t.keys)?{keys:t.keys}:null==t?void 0:t.jwks);if(!c){let{error:e}=await this.getUser(s);if(e)throw e;return{data:{claims:i,header:a,signature:o},error:null}}let h=function(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw Error("Invalid alg claim")}}(a.alg),d=await crypto.subtle.importKey("jwk",c,h,!0,["verify"]);if(!await crypto.subtle.verify(h,d,o,(r=`${l}.${u}`,n=[],!function(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){let t=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|t)+65536,r+=1}!function(e,t){if(e<=127)return t(e);if(e<=2047){t(192|e>>6),t(128|63&e);return}if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|63&e);return}if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|63&e);return}throw Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}(n,t)}}(r,e=>n.push(e)),new Uint8Array(n))))throw new tC("Invalid JWT signature");return{data:{claims:i,header:a,signature:o},error:null}}catch(e){if(tm(e))return this._returnResult({data:null,error:e});throw e}}}r_.nextInstanceID={};let rv=r_,rw="";rw="u">typeof Deno?"deno":"u">typeof document?"web":"u">typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";let rE={headers:{"X-Client-Info":`supabase-js-${rw}/2.93.3`}},rS={schema:"public"},rR={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},rT={};function rO(e){return(rO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function rA(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?rk(Object(r),!0).forEach(function(t){!function(e,t,r){var n;(n=function(e,t){if("object"!=rO(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=rO(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==rO(n)?n:n+"")in e)?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rk(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var rC=class extends rv{constructor(e){super(e)}},rP=class{constructor(e,t,r){var n,s,a;this.supabaseUrl=e,this.supabaseKey=t;const i=function(e){let t=null==e?void 0:e.trim();if(!t)throw Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(t.endsWith("/")?t:t+"/")}catch(e){throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}(e);if(!t)throw Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",i),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",i),this.storageUrl=new URL("storage/v1",i),this.functionsUrl=new URL("functions/v1",i);const o=`sb-${i.hostname.split(".")[0]}-auth-token`,l=function(e,t){var r,n;let{db:s,auth:a,realtime:i,global:o}=e,{db:l,auth:u,realtime:c,global:h}=t,d={db:rA(rA({},l),s),auth:rA(rA({},u),a),realtime:rA(rA({},c),i),storage:{},global:rA(rA(rA({},h),o),{},{headers:rA(rA({},null!=(r=null==h?void 0:h.headers)?r:{}),null!=(n=null==o?void 0:o.headers)?n:{})}),accessToken:async()=>""};return e.accessToken?d.accessToken=e.accessToken:delete d.accessToken,d}(null!=r?r:{},{db:rS,realtime:rT,auth:rA(rA({},rR),{},{storageKey:o}),global:rE});this.storageKey=null!=(n=l.auth.storageKey)?n:"",this.headers=null!=(s=l.global.headers)?s:{},l.accessToken?(this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(t)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!=(a=l.auth)?a:{},this.headers,l.global.fetch),this.fetch=((e,t,r)=>{let n=r?(...e)=>r(...e):(...e)=>fetch(...e),s=Headers;return async(r,a)=>{var i;let o=null!=(i=await t())?i:e,l=new s(null==a?void 0:a.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization",`Bearer ${o}`),n(r,rA(rA({},a),{},{headers:l}))}})(t,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(rA({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(e=>this.realtime.setAuth(e)).catch(e=>console.warn("Failed to set initial Realtime auth token:",e)),this.rest=new eh(new URL("rest/v1",i).href,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),this.storage=new tu(this.storageUrl.href,this.headers,this.fetch,null==r?void 0:r.storage),l.accessToken||this._listenForAuthEvents()}get functions(){return new es(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,t;if(this.accessToken)return await this.accessToken();let{data:r}=await this.auth.getSession();return null!=(e=null==(t=r.session)?void 0:t.access_token)?e:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:s,storageKey:a,flowType:i,lock:o,debug:l,throwOnError:u},c,h){let d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new rC({url:this.authUrl.href,headers:rA(rA({},d),c),storageKey:a,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:s,flowType:i,lock:o,debug:l,throwOnError:u,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(e=>"authorization"===e.toLowerCase())})}_initRealtimeClient(e){return new ex(this.realtimeUrl.href,rA(rA({},e),{},{params:rA(rA({},{apikey:this.supabaseKey}),null==e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",null==t?void 0:t.access_token)})}_handleTokenChanged(e,t,r){("TOKEN_REFRESHED"===e||"SIGNED_IN"===e)&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0)}};(function(){let e=globalThis.process;if(!e)return!1;let t=e.version;if(null==t)return!1;let r=t.match(/^v(\d+)\./);return!!r&&18>=parseInt(r[1],10)})()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217"),e.i(8502);var rj=e.i(57174);let rx=async()=>{let e=await (0,rj.cookies)();return function(e,t,r){if(!e||!t)throw Error(`Your project's URL and Key are required to create a Supabase client!

Check your Supabase project's API settings to find these values

https://supabase.com/dashboard/project/_/settings/api`);let{storage:n,getAll:s,setAll:a,setItems:i,removedItems:o}=function(e,t){let r,n,s=e.cookies??null,a=e.cookieEncoding,i={},o={};if(s)if("get"in s){let e=async e=>{let t=e.flatMap(e=>[e,...Array.from({length:5}).map((t,r)=>`${e}.${r}`)]),r=[];for(let e=0;e<t.length;e+=1){let n=await s.get(t[e]);(n||"string"==typeof n)&&r.push({name:t[e],value:n})}return r};if(r=async t=>await e(t),"set"in s&&"remove"in s)n=async e=>{for(let t=0;t<e.length;t+=1){let{name:r,value:n,options:a}=e[t];n?await s.set(r,n,a):await s.remove(r,a)}};else if(t)n=async()=>{console.warn("@supabase/ssr: createServerClient was configured without set and remove cookie methods, but the client needs to set cookies. This can lead to issues such as random logouts, early session termination or increased token refresh requests. If in NextJS, check your middleware.ts file, route handlers and server actions for correctness. Consider switching to the getAll and setAll cookie methods instead of get, set and remove which are deprecated and can be difficult to use correctly.")};else throw Error("@supabase/ssr: createBrowserClient requires configuring a getAll and setAll cookie method (deprecated: alternatively both get, set and remove can be used)")}else if("getAll"in s)if(r=async()=>await s.getAll(),"setAll"in s)n=s.setAll;else if(t)n=async()=>{console.warn("@supabase/ssr: createServerClient was configured without the setAll cookie method, but the client needs to set cookies. This can lead to issues such as random logouts, early session termination or increased token refresh requests. If in NextJS, check your middleware.ts file, route handlers and server actions for correctness.")};else throw Error("@supabase/ssr: createBrowserClient requires configuring both getAll and setAll cookie methods (deprecated: alternatively both get, set and remove can be used)");else throw Error(`@supabase/ssr: ${t?"createServerClient":"createBrowserClient"} requires configuring getAll and setAll cookie methods (deprecated: alternatively use get, set and remove).`);else if(t||1)if(t)throw Error("@supabase/ssr: createServerClient must be initialized with cookie options that specify getAll and setAll functions (deprecated, not recommended: alternatively use get, set and remove)");else r=()=>[],n=()=>{throw Error("@supabase/ssr: createBrowserClient in non-browser runtimes (including Next.js pre-rendering mode) was not initialized cookie options that specify getAll and setAll functions (deprecated: alternatively use get, set and remove), but they were needed")};else r=()=>{let e;return Object.keys(e=(0,L.parse)(document.cookie)).map(t=>({name:t,value:e[t]??""}))},n=e=>{e.forEach(({name:e,value:t,options:r})=>{document.cookie=(0,L.serialize)(e,t,r)})};return t?{getAll:r,setAll:n,setItems:i,removedItems:o,storage:{isServer:!0,getItem:async e=>{if("string"==typeof i[e])return i[e];if(o[e])return null;let t=await r([e]),n=await K(e,async e=>{let r=t?.find(({name:t})=>t===e)||null;return r?r.value:null});if(!n)return null;let s=n;return"string"==typeof n&&n.startsWith(Y)&&(s=J(n.substring(Y.length))),s},setItem:async(t,s)=>{t.endsWith("-code-verifier")&&await Q({getAll:r,setAll:n,setItems:{[t]:s},removedItems:{}},{cookieOptions:e?.cookieOptions??null,cookieEncoding:a}),i[t]=s,delete o[t]},removeItem:async e=>{delete i[e],o[e]=!0}}}:{getAll:r,setAll:n,setItems:i,removedItems:o,storage:{isServer:!1,getItem:async e=>{let t=await r([e]),n=await K(e,async e=>{let r=t?.find(({name:t})=>t===e)||null;return r?r.value:null});if(!n)return null;let s=n;return n.startsWith(Y)&&(s=J(n.substring(Y.length))),s},setItem:async(t,s)=>{let i=await r([t]),o=new Set((i?.map(({name:e})=>e)||[]).filter(e=>F(e,t))),l=s;"base64url"===a&&(l=Y+V(s));let u=G(t,l);u.forEach(({name:e})=>{o.delete(e)});let c={...B,...e?.cookieOptions,maxAge:0},h={...B,...e?.cookieOptions,maxAge:B.maxAge};delete c.name,delete h.name;let d=[...[...o].map(e=>({name:e,value:"",options:c})),...u.map(({name:e,value:t})=>({name:e,value:t,options:h}))];d.length>0&&await n(d)},removeItem:async t=>{let s=await r([t]),a=(s?.map(({name:e})=>e)||[]).filter(e=>F(e,t)),i={...B,...e?.cookieOptions,maxAge:0};delete i.name,a.length>0&&await n(a.map(e=>({name:e,value:"",options:i})))}}}}({...r,cookieEncoding:r?.cookieEncoding??"base64url"},!0),l=new rP(e,t,{...r,global:{...r?.global,headers:{...r?.global?.headers,"X-Client-Info":"supabase-ssr/0.7.0 createServerClient"}},auth:{...r?.cookieOptions?.name?{storageKey:r.cookieOptions.name}:null,...r?.auth,flowType:"pkce",autoRefreshToken:!1,detectSessionInUrl:!1,persistSession:!0,storage:n}});return l.auth.onAuthStateChange(async e=>{(Object.keys(i).length>0||Object.keys(o).length>0)&&("SIGNED_IN"===e||"TOKEN_REFRESHED"===e||"USER_UPDATED"===e||"PASSWORD_RECOVERY"===e||"SIGNED_OUT"===e||"MFA_CHALLENGE_VERIFIED"===e)&&await Q({getAll:s,setAll:a,setItems:i,removedItems:o},{cookieOptions:r?.cookieOptions??null,cookieEncoding:r?.cookieEncoding??"base64url"})}),l}("https://jyjynjpznlvezjhnuwhi.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imp5anluanB6bmx2ZXpqaG51d2hpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc1MDYxMjYsImV4cCI6MjA3MzA4MjEyNn0.cZsOif1nBpU-WywHbdkEshxLr06HPagTM7CksAgmhuk",{cookies:{get:t=>e.get(t)?.value,set(t,r,n){try{e.set({name:t,value:r,...n})}catch(e){}},remove(t,r){try{e.set({name:t,value:"",...r})}catch(e){}}}})};var rN=e.i(75649),r$=e.i(69171),rI=e.i(68839);async function rD(){(0,rI.unstable_noStore)();let e=await rx(),{data:{user:t}}=await e.auth.getUser();if(!t)return null;let{data:r}=await e.from("profiles").select("*").eq("id",t.id).single();return{user:t,profile:r}}async function rU(e){(0,rI.unstable_noStore)();let t=await rx(),{data:r,error:n}=await t.from("profiles").select("username, display_name, date_of_birth, country, gender").eq("id",e).single();return!n&&!!r&&!!(r.username&&r.display_name&&r.date_of_birth&&r.country&&r.gender)}async function rM(e){(0,rI.unstable_noStore)();let t=await rx(),{data:r}=await t.from("profiles").select("*").eq("username",e).single();return r}async function rq(e,t){(0,rI.unstable_noStore)();let r=await rx(),{data:n,error:s}=await r.from("followers").select("follower_id").eq("follower_id",e).eq("following_id",t).maybeSingle();return s?(console.error("Follow status check error:",s),!1):null!==n}async function rL(e){(0,rI.unstable_noStore)();let t=await rx(),{data:r,error:n}=await t.from("followers").select("*, profiles:follower_id(*)").eq("following_id",e).eq("status","pending");return n?(console.error("Error fetching follow requests:",n),[]):r}async function rB(e){(0,rI.unstable_noStore)();let t=await rx(),{data:{user:r}}=await t.auth.getUser(),{data:n}=await t.from("profiles").select("*").eq("username",e).single();if(!n)return{profile:null,followStatus:"not_following"};if(!r||r.id===n.id)return{profile:n,followStatus:"not_following"};let{data:s}=await t.from("followers").select("status").eq("follower_id",r.id).eq("following_id",n.id).single();return{profile:n,followStatus:s?s.status:"not_following"}}async function rH(e){(0,rI.unstable_noStore)();let t=await rx(),{data:{user:r}}=await t.auth.getUser(),{data:n}=await t.from("profiles").select("*, timeline_count:timeline_entries!user_id(count)").eq("username",e).single();if(!n)return{profile:null,followStatus:"not_following",followerCount:0,followingCount:0,timelineCount:0,sections:[]};let{data:s}=await t.from("profile_sections").select(`
            *,
            items:section_items(
                *,
                movie:movies(*),
                series:series(*),
                person:people(*)
            )
        `).eq("user_id",n.id).order("rank",{ascending:!0}),a=(s||[]).map(e=>({...e,items:(e.items||[]).sort((e,t)=>e.rank-t.rank).map(e=>({...e,movie:Array.isArray(e.movie)?e.movie[0]:e.movie,series:Array.isArray(e.series)?e.series[0]:e.series,person:Array.isArray(e.person)?e.person[0]:e.person}))})),[i,o,l]=await Promise.all([t.from("followers").select("*",{count:"exact",head:!0}).eq("following_id",n.id).eq("status","accepted"),t.from("followers").select("*",{count:"exact",head:!0}).eq("follower_id",n.id).eq("status","accepted"),r&&r.id!==n.id?t.from("followers").select("status").eq("follower_id",r.id).eq("following_id",n.id).single():Promise.resolve({data:null})]);return{profile:n,followStatus:l.data?.status||"not_following",followerCount:i.count||0,followingCount:o.count||0,timelineCount:n.timeline_count?.[0]?.count||0,sections:a}}async function rF(){(0,rI.unstable_noStore)();let e=await rx(),{data:{user:t}}=await e.auth.getUser();if(!t)return null;let{data:r}=await e.from("profiles").select("*").eq("id",t.id).single();if(!r)return{user:t,profile:null,sections:[]};let{data:n}=await e.from("profile_sections").select(`
            *,
            items:section_items(
                *,
                movie:movies(*),
                series:series(*),
                person:people(*)
            )
        `).eq("user_id",t.id).order("rank",{ascending:!0});return{user:t,profile:r,sections:(n||[]).map(e=>({id:e.id,user_id:e.user_id,title:e.title,type:e.type,rank:e.rank,items:(e.items||[]).sort((e,t)=>e.rank-t.rank).map(e=>({id:e.id,section_id:e.section_id,item_type:e.item_type,rank:e.rank,movie:Array.isArray(e.movie)?e.movie[0]:e.movie,series:Array.isArray(e.series)?e.series[0]:e.series,person:Array.isArray(e.person)?e.person[0]:e.person}))}))}}async function rG(e){(0,rI.unstable_noStore)();let t=await rx(),{data:r,error:n}=await t.from("followers").select("profiles:follower_id(*)").eq("following_id",e).eq("status","accepted");return n?(console.error("Error fetching followers:",n),[]):r?r.map(e=>e.profiles).filter(Boolean):[]}async function rK(e){(0,rI.unstable_noStore)();let t=await rx(),{data:r,error:n}=await t.from("followers").select("profiles:following_id(*)").eq("follower_id",e).eq("status","accepted");return n?(console.error("Error fetching following list:",n),[]):r?r.map(e=>e.profiles).filter(Boolean):[]}async function rW(e){let t=await rx(),{data:r}=await t.from("profiles").select("*").eq("username",e).single();if(!r)return null;let{data:n,error:s}=await t.from("profile_sections").select(`
            *,
            items:section_items(
                *,
                movie:movies(*),
                series:series(*),
                person:people(*)
            )
        `).eq("user_id",r.id).order("rank",{ascending:!0});return s||!n?{profile:r,sections:[]}:{profile:r,sections:n.map(e=>({...e,items:(e.items||[]).sort((e,t)=>e.rank-t.rank).map(e=>({...e,movie:Array.isArray(e.movie)?e.movie[0]:e.movie,series:Array.isArray(e.series)?e.series[0]:e.series,person:Array.isArray(e.person)?e.person[0]:e.person}))}))}}async function rz(e){let{searchParams:t}=new URL(e.url),r=t.get("code"),n=t.get("next")??"/profile";if(r){let t=await rx(),{data:s,error:a}=await t.auth.exchangeCodeForSession(r);if(!a&&s.user)return await rU(s.user.id)||(n="/onboarding"),rN.NextResponse.redirect(new URL(n,e.url))}let s=new URL("/auth/error",e.url);return s.searchParams.set("error","Sorry, we couldn't confirm your authentication. Please try again."),rN.NextResponse.redirect(s)}(0,e.i(6288).ensureServerEntryExports)([rD,rU,rM,rq,rL,rB,rH,rF,rG,rK,rW]),(0,r$.registerServerReference)(rD,"00d0567cd8df0fc447dd1e815c2ddf184f0c18128e",null),(0,r$.registerServerReference)(rU,"4047dd0ce88f4279733a1b257efef3eef9f46b98fe",null),(0,r$.registerServerReference)(rM,"4014fbfdff9342dd0c42b9ff583a3342422dc0f22a",null),(0,r$.registerServerReference)(rq,"60c2b24991e2dd0ce0aa7dddb015e6a9b621b2c5e6",null),(0,r$.registerServerReference)(rL,"400bcb2c36f7c47e3731ae06dffd2224b3a2699e1e",null),(0,r$.registerServerReference)(rB,"401f2c77db66442cf38ce5a83c458e601f1c7b05c7",null),(0,r$.registerServerReference)(rH,"40cfbf6bd851b4c3c77831a2af2103b1bc31d65c9f",null),(0,r$.registerServerReference)(rF,"00683e089f24bf051dde09a3a6d87c7845379672d7",null),(0,r$.registerServerReference)(rG,"402c60c195c27d7e4ee6875efa618185b1ac3231fb",null),(0,r$.registerServerReference)(rK,"40bf4c0ef6c82b5f8fcdc9b4949d7d08040b4dd7de",null),(0,r$.registerServerReference)(rW,"40cfe719a5adbe13aa2b30a3a28352a6402447f1e9",null),e.s(["GET",()=>rz],33020);var rX=e.i(33020);let rV=new S.AppRouteRouteModule({definition:{kind:R.RouteKind.APP_ROUTE,page:"/auth/confirm/route",pathname:"/auth/confirm",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/app/auth/confirm/route.ts",nextConfigOutput:"standalone",userland:rX}),{workAsyncStorage:rJ,workUnitAsyncStorage:rY,serverHooks:rQ}=rV;function rZ(){return(0,T.patchFetch)({workAsyncStorage:rJ,workUnitAsyncStorage:rY})}async function r0(e,t,r){rV.isDev&&(0,O.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let n="/auth/confirm/route";n=n.replace(/\/index$/,"")||"/";let s=await rV.prepare(e,t,{srcPage:n,multiZoneDraftMode:!1});if(!s)return t.statusCode=400,t.end("Bad Request"),null==r.waitUntil||r.waitUntil.call(r,Promise.resolve()),null;let{buildId:a,params:i,nextConfig:o,parsedUrl:l,isDraftMode:u,prerenderManifest:c,routerServerContext:h,isOnDemandRevalidate:d,revalidateOnlyGenerated:f,resolvedPathname:p,clientReferenceManifest:g,serverActionsManifest:m}=s,y=(0,C.normalizeAppPath)(n),b=!!(c.dynamicRoutes[y]||c.routes[p]),_=async()=>((null==h?void 0:h.render404)?await h.render404(e,t,l,!1):t.end("This page could not be found"),null);if(b&&!u){let e=!!c.routes[p],t=c.dynamicRoutes[y];if(t&&!1===t.fallback&&!e){if(o.experimental.adapterPath)return await _();throw new M.NoFallbackError}}let v=null;!b||rV.isDev||u||(v="/index"===(v=p)?"/":v);let w=!0===rV.isDev||!b,E=b&&!w;m&&g&&(0,A.setManifestsSingleton)({page:n,clientReferenceManifest:g,serverActionsManifest:m});let S=e.method||"GET",T=(0,k.getTracer)(),L=T.getActiveScopeSpan(),B={params:i,prerenderManifest:c,renderOpts:{experimental:{authInterrupts:!!o.experimental.authInterrupts},cacheComponents:!!o.cacheComponents,supportsDynamicResponse:w,incrementalCache:(0,O.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:o.cacheLife,waitUntil:r.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,n,s)=>rV.onRequestError(e,t,n,s,h)},sharedContext:{buildId:a}},H=new P.NodeNextRequest(e),F=new P.NodeNextResponse(t),G=j.NextRequestAdapter.fromNodeNextRequest(H,(0,j.signalFromNodeResponse)(t));try{let s=async e=>rV.handle(G,B).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=T.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==x.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let s=r.get("next.route");if(s){let t=`${S} ${s}`;e.setAttributes({"next.route":s,"http.route":s,"next.span_name":t}),e.updateName(t)}else e.updateName(`${S} ${n}`)}),a=!!(0,O.getRequestMeta)(e,"minimalMode"),i=async i=>{var l,p;let g=async({previousCacheEntry:o})=>{try{if(!a&&d&&f&&!o)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let n=await s(i);e.fetchMetrics=B.renderOpts.fetchMetrics;let l=B.renderOpts.pendingWaitUntil;l&&r.waitUntil&&(r.waitUntil(l),l=void 0);let u=B.renderOpts.collectedTags;if(!b)return await (0,$.sendResponse)(H,F,n,B.renderOpts.pendingWaitUntil),null;{let e=await n.blob(),t=(0,I.toNodeOutgoingHttpHeaders)(n.headers);u&&(t[U.NEXT_CACHE_TAGS_HEADER]=u),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==B.renderOpts.collectedRevalidate&&!(B.renderOpts.collectedRevalidate>=U.INFINITE_CACHE)&&B.renderOpts.collectedRevalidate,s=void 0===B.renderOpts.collectedExpire||B.renderOpts.collectedExpire>=U.INFINITE_CACHE?void 0:B.renderOpts.collectedExpire;return{value:{kind:q.CachedRouteKind.APP_ROUTE,status:n.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:s}}}}catch(t){throw(null==o?void 0:o.isStale)&&await rV.onRequestError(e,t,{routerKind:"App Router",routePath:n,routeType:"route",revalidateReason:(0,N.getRevalidateReason)({isStaticGeneration:E,isOnDemandRevalidate:d})},!1,h),t}},m=await rV.handleResponse({req:e,nextConfig:o,cacheKey:v,routeKind:R.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:c,isRoutePPREnabled:!1,isOnDemandRevalidate:d,revalidateOnlyGenerated:f,responseGenerator:g,waitUntil:r.waitUntil,isMinimalMode:a});if(!b)return null;if((null==m||null==(l=m.value)?void 0:l.kind)!==q.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==m||null==(p=m.value)?void 0:p.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});a||t.setHeader("x-nextjs-cache",d?"REVALIDATED":m.isMiss?"MISS":m.isStale?"STALE":"HIT"),u&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let y=(0,I.fromNodeOutgoingHttpHeaders)(m.value.headers);return a&&b||y.delete(U.NEXT_CACHE_TAGS_HEADER),!m.cacheControl||t.getHeader("Cache-Control")||y.get("Cache-Control")||y.set("Cache-Control",(0,D.getCacheControlHeader)(m.cacheControl)),await (0,$.sendResponse)(H,F,new Response(m.value.body,{headers:y,status:m.value.status||200})),null};L?await i(L):await T.withPropagatedContext(e.headers,()=>T.trace(x.BaseServerSpan.handleRequest,{spanName:`${S} ${n}`,kind:k.SpanKind.SERVER,attributes:{"http.method":S,"http.target":e.url}},i))}catch(t){if(t instanceof M.NoFallbackError||await rV.onRequestError(e,t,{routerKind:"App Router",routePath:y,routeType:"route",revalidateReason:(0,N.getRevalidateReason)({isStaticGeneration:E,isOnDemandRevalidate:d})},!1,h),b)throw t;return await (0,$.sendResponse)(H,F,new Response(null,{status:500})),null}}e.s(["handler",()=>r0,"patchFetch",()=>rZ,"routeModule",()=>rV,"serverHooks",()=>rQ,"workAsyncStorage",()=>rJ,"workUnitAsyncStorage",()=>rY],74810)}];

//# sourceMappingURL=node_modules__pnpm_e991ae2b._.js.map