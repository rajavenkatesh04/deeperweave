module.exports=[76216,a=>{"use strict";var b=a.i(41063),c=a.i(38704),d=a.i(29024),e=a.i(38324),f=a.i(82472),g=a.i(72273);let h=(a,b=null)=>{let c=a.media_type||b;if("person"===c)return a.profile_path?{id:a.id,title:a.name||"Unknown",name:a.name,poster_path:a.profile_path,profile_path:a.profile_path,media_type:"person",department:a.known_for_department||"Artist",known_for_department:a.known_for_department}:null;if(!a.poster_path)return null;let d=a.title||a.name||"Unknown",e=a.release_date||a.first_air_date;return{id:a.id,title:d,name:a.name,release_date:e,poster_path:a.poster_path,profile_path:null,backdrop_path:a.backdrop_path,overview:a.overview,media_type:c||"movie",vote_count:a.vote_count,vote_average:a.vote_average}},i=(0,c.cache)(async()=>{try{let a=await (0,d.createClient)(),{data:{user:b}}=await a.auth.getUser();if(!b)return{country:"US",content_preference:"sfw",countryName:"United States"};let{data:c}=await a.from("profiles").select("country, content_preference").eq("id",b.id).single(),e="US",g="United States";if(c?.country){let a=f.countries.find(a=>a.name===c.country);a&&(e=a["alpha-2"],g=a.name)}return{country:e,countryName:g,content_preference:c?.content_preference||"sfw"}}catch(a){return{country:"US",content_preference:"sfw",countryName:"United States"}}});function j(a){let b=new Date,c=new Date;return c.setDate(b.getDate()-a),{gte:c.toISOString().split("T")[0],lte:b.toISOString().split("T")[0]}}async function k(a,b={}){let c=process.env.TMDB_API_KEY;if(!c)return console.error("TMDB API Key is not configured on the server."),[];let d=null;a.includes("/movie")?d="movie":a.includes("/tv")&&(d="tv");let e=b.region,f=b.include_adult;if(!e||!f){let a=await i();e||(e=a.country),f||(f="all"===a.content_preference?"true":"false")}let g=new URLSearchParams({api_key:c,include_adult:f,region:e,watch_region:e,...b});try{let b=await fetch(`https://api.themoviedb.org/3${a}?${g.toString()}`,{next:{revalidate:3600}});if(!b.ok)return console.error(`TMDB API Error [${b.status}]: ${b.statusText} at ${a}`),[];return(await b.json()).results.map(a=>h(a,d)).filter(a=>null!==a).filter(a=>"person"===a.media_type||!!a.backdrop_path).slice(0,20)}catch(b){return console.error(`TMDB Network Error for ${a}:`,b),[]}}async function l(a){let b={page:(a.page||1).toString(),sort_by:a.sort_by||"popularity.desc","vote_count.gte":a["vote_count.gte"]||"5"};return a.region&&(b.region=a.region),a.region&&"tv"===a.type&&(b.watch_region=a.region),a.with_original_language&&(b.with_original_language=a.with_original_language),a.with_genres&&(b.with_genres=a.with_genres),a.year&&("movie"===a.type?b.primary_release_year=a.year.toString():b.first_air_date_year=a.year.toString()),a.release_date_gte&&("movie"===a.type?b["primary_release_date.gte"]=a.release_date_gte:b["first_air_date.gte"]=a.release_date_gte),a.release_date_lte&&("movie"===a.type?b["primary_release_date.lte"]=a.release_date_lte:b["first_air_date.lte"]=a.release_date_lte),"anime"===a.with_genres&&(b.with_genres="16",b.with_original_language="ja"),k(`/discover/${a.type}`,b)}async function m(){let{country:a,countryName:b}=await i(),c=[],d=j(60);if("IN"===a){let[a,b,e,f,g,h,i,m]=await Promise.all([l({type:"movie",sort_by:"popularity.desc",with_original_language:"hi",region:"IN",release_date_gte:d.gte,release_date_lte:d.lte}),l({type:"movie",sort_by:"popularity.desc",with_original_language:"te",region:"IN",release_date_gte:d.gte,release_date_lte:d.lte}),l({type:"movie",sort_by:"popularity.desc",with_original_language:"ta",region:"IN",release_date_gte:d.gte,release_date_lte:d.lte}),l({type:"movie",sort_by:"popularity.desc",with_original_language:"ml",region:"IN",release_date_gte:d.gte,release_date_lte:d.lte}),l({type:"movie",sort_by:"popularity.desc",with_original_language:"kn",region:"IN",release_date_gte:d.gte,release_date_lte:d.lte}),k("/trending/all/day",{region:"IN"}),l({type:"movie",sort_by:"vote_average.desc",region:"IN",release_date_gte:`${new Date().getFullYear()}-01-01`}),l({type:"movie",with_genres:"28",region:"IN",sort_by:"popularity.desc",release_date_gte:j(90).gte})]);c.push({title:"Trending in India",items:h,href:"/discover/trending"}),c.push({title:"New in Bollywood (Hindi)",items:a,href:"/discover/movies?lang=hi"}),c.push({title:"Latest Telugu Hits",items:b,href:"/discover/movies?lang=te"}),c.push({title:"Best of Malayalam Cinema",items:f,href:"/discover/movies?lang=ml"}),c.push({title:"Tamil Blockbusters",items:e,href:"/discover/movies?lang=ta"}),c.push({title:"Kannada Action & Drama",items:g,href:"/discover/movies?lang=kn"}),c.push({title:"High Octane Indian Action",items:m,href:"/discover/movies?genre=action"});let n=i.filter(a=>a.vote_count&&a.vote_count>20).slice(0,10);n.length>0&&c.push({title:`Critically Acclaimed (${new Date().getFullYear()})`,items:n,href:"/discover/top-rated"})}else if("KR"===a){let[a,b]=await Promise.all([l({type:"movie",sort_by:"popularity.desc",with_original_language:"ko",region:"KR",release_date_gte:d.gte,release_date_lte:d.lte}),l({type:"tv",sort_by:"popularity.desc",with_original_language:"ko",region:"KR",release_date_gte:d.gte,release_date_lte:d.lte})]);c.push({title:"New Korean Movies",items:a,href:"/discover/movies"}),c.push({title:"Airing K-Dramas",items:b,href:"/discover/kdramas"})}else if("JP"===a){let[a,b]=await Promise.all([l({type:"tv",with_genres:"16",region:"JP",release_date_gte:d.gte,release_date_lte:d.lte}),l({type:"movie",with_original_language:"ja",region:"JP",release_date_gte:d.gte,release_date_lte:d.lte})]);c.push({title:"Airing Anime",items:a,href:"/discover/anime"}),c.push({title:"New Japanese Movies",items:b,href:"/discover/movies"})}else{let[d]=await Promise.all([k("/trending/all/day",{region:a})]);c.push({title:`Trending in ${b}`,items:d,href:"/discover/trending"})}return c}async function n(){let[a,b]=await Promise.all([k("/trending/movie/day"),k("/trending/tv/day")]),c=[],d=Math.min(a.length,b.length,5);for(let e=0;e<d;e++)c.push(a[e]),c.push(b[e]);return c}async function o(){return k("/trending/all/day",{language:"en-US"})}async function p(){return k("/movie/now_playing",{language:"en-US",page:"1"})}async function q(){return k("/tv/on_the_air",{language:"en-US",page:"1"})}async function r(){return l({type:"tv",with_genres:"anime"})}async function s(){return l({type:"tv",with_original_language:"ko"})}async function t(a){return a.trim().length<2?[]:k("/search/multi",{query:encodeURIComponent(a)})}async function u(a){let b=process.env.TMDB_API_KEY;if(!b)throw Error("TMDB API Key not configured.");try{let c=await fetch(`https://api.themoviedb.org/3/movie/${a}?api_key=${b}&append_to_response=videos,images,credits,recommendations,similar,keywords,external_ids,watch/providers,release_dates`,{next:{revalidate:3600}});if(!c.ok)throw Error("Failed to fetch movie details");let d=await c.json(),e=d.recommendations?.results||[],f=d.release_dates?.results?.find(a=>"US"===a.iso_3166_1),g=f?.release_dates?.[0]?.certification||"NR",i=d["watch/providers"]?.results?.IN||d["watch/providers"]?.results?.US||{},j=d.credits?.crew||[],k=a=>j.filter(b=>b.job===a).map(a=>({id:a.id,name:a.name,profile_path:a.profile_path,job:a.job,department:a.department})),l=[...k("Screenplay"),...k("Writer"),...k("Story")],m=Array.from(new Map(l.map(a=>[a.id,a])).values());return{id:d.id,title:d.title,original_title:d.original_title,media_type:"movie",adult:d.adult,overview:d.overview,poster_path:d.poster_path,backdrop_path:d.backdrop_path,release_date:d.release_date,genres:d.genres,runtime:d.runtime,tagline:d.tagline,vote_average:d.vote_average,certification:g,keywords:d.keywords?.keywords||[],social_ids:d.external_ids||{},director:k("Director")[0]?.name||void 0,original_language:d.original_language,spoken_languages:d.spoken_languages?.map(a=>a.english_name)||[],budget:d.budget,revenue:d.revenue,production_companies:d.production_companies||[],collection:d.belongs_to_collection,origin_country:d.origin_country||[],crew:{writers:m,cinematographers:k("Director of Photography"),editors:k("Editor"),composers:k("Original Music Composer"),producers:k("Producer")},cast:d.credits?.cast?.slice(0,16)||[],watch_providers:{flatrate:i.flatrate||[],rent:i.rent||[],buy:i.buy||[]},recommendations:e.map(a=>h(a,"movie")).filter(a=>null!==a).slice(0,10),videos:d.videos?.results||[],images:d.images||{backdrops:[]},similar:[]}}catch(a){throw console.error("TMDB Movie Fetch Error:",a),Error("Could not fetch movie details.")}}async function v(a){let b=process.env.TMDB_API_KEY;if(!b)throw Error("TMDB API Key not configured.");try{let c=await fetch(`https://api.themoviedb.org/3/tv/${a}?api_key=${b}&append_to_response=videos,images,aggregate_credits,recommendations,similar,keywords,external_ids,watch/providers,content_ratings`,{next:{revalidate:3600}});if(!c.ok)throw Error("Failed to fetch TV details");let d=await c.json(),e=d.recommendations?.results||[],f=d.created_by?.[0]?.name||null,g=d.content_ratings?.results?.find(a=>"US"===a.iso_3166_1),i=g?.rating||"NR",j=d["watch/providers"]?.results?.IN||d["watch/providers"]?.results?.US||{},k=(d.aggregate_credits?.cast||[]).slice(0,16).map(a=>({id:a.id,name:a.name,profile_path:a.profile_path,character:a.roles&&a.roles.length>0?a.roles[0].character:"Unknown"})),l=d.aggregate_credits?.crew||[],m=a=>l.filter(b=>b.jobs?.some(b=>b.job===a)).map(b=>({id:b.id,name:b.name,profile_path:b.profile_path,job:a,department:b.department}));return{id:d.id,title:d.name,original_title:d.original_name,media_type:"tv",adult:d.adult,overview:d.overview,poster_path:d.poster_path,backdrop_path:d.backdrop_path,release_date:d.first_air_date,genres:d.genres,number_of_seasons:d.number_of_seasons,status:d.status,tagline:d.tagline,vote_average:d.vote_average,creator:f,certification:i,keywords:d.keywords?.results||[],social_ids:d.external_ids||{},original_language:d.original_language,spoken_languages:d.spoken_languages?.map(a=>a.english_name)||[],production_companies:d.production_companies||[],networks:d.networks||[],type:d.type,origin_country:d.origin_country||[],next_episode_to_air:d.next_episode_to_air,last_episode_to_air:d.last_episode_to_air,seasons:d.seasons?.filter(a=>a.season_number>0)||[],crew:{writers:m("Writer"),cinematographers:m("Director of Photography"),editors:m("Editor"),composers:m("Original Music Composer"),producers:[...m("Executive Producer"),...m("Producer")]},cast:k,watch_providers:{flatrate:j.flatrate||[],rent:j.rent||[],buy:j.buy||[]},recommendations:e.map(a=>h(a,"tv")).filter(a=>null!==a).slice(0,10),videos:d.videos?.results||[],images:d.images||{backdrops:[]},similar:[]}}catch(a){throw console.error("TMDB TV Fetch Error:",a),Error("Could not fetch series details.")}}async function w(a){let b=process.env.TMDB_API_KEY;if(!b)throw Error("TMDB API Key not configured.");try{let c=await fetch(`https://api.themoviedb.org/3/person/${a}?api_key=${b}&append_to_response=combined_credits,images,tagged_images,external_ids`,{next:{revalidate:3600}});if(!c.ok)throw console.error(`TMDB Person Error ${c.status}: ${c.statusText}`),Error(`Failed to fetch person: ${c.status}`);let d=await c.json(),e=(d.combined_credits?.cast||[]).sort((a,b)=>(b.vote_count||0)-(a.vote_count||0)).map(a=>h(a)).filter(a=>null!==a).filter((a,b,c)=>b===c.findIndex(b=>b.id===a.id)).slice(0,20),f=(d.tagged_images?.results||[]).filter(a=>a.aspect_ratio>1.6).map(a=>({file_path:a.file_path}));return 0===f.length&&(f=e.filter(a=>a.backdrop_path).map(a=>({file_path:a.backdrop_path}))),{id:d.id,name:d.name,adult:d.adult,biography:d.biography,birthday:d.birthday,deathday:d.deathday,place_of_birth:d.place_of_birth,profile_path:d.profile_path,known_for_department:d.known_for_department,gender:d.gender,also_known_as:d.also_known_as||[],backdrop_path:f[0]?.file_path||null,social_ids:d.external_ids||{},images:d.images?.profiles||[],known_for:e,backdrops:f.slice(0,10)}}catch(a){throw console.error("TMDB Person Fetch Error:",a),a}}async function x(a){let b=await (0,e.createAdminClient)(),{data:c}=await b.from("movies").select("tmdb_id").eq("tmdb_id",a).maybeSingle();if(c)return;let d=await u(a);await b.from("movies").upsert({tmdb_id:d.id,title:d.title,adult:d.adult,poster_url:d.poster_path?`https://image.tmdb.org/t/p/w500${d.poster_path}`:null,backdrop_url:d.backdrop_path?`https://image.tmdb.org/t/p/original${d.backdrop_path}`:null,release_date:d.release_date,director:d.director,overview:d.overview,genres:d.genres,cast:d.cast,runtime:d.runtime,budget:d.budget,revenue:d.revenue,original_language:d.original_language,production_companies:d.production_companies,crew:d.crew},{onConflict:"tmdb_id"})}async function y(a){let b=await (0,e.createAdminClient)(),{data:c}=await b.from("series").select("tmdb_id").eq("tmdb_id",a).maybeSingle();if(c)return;let d=await v(a);await b.from("series").upsert({tmdb_id:d.id,adult:d.adult,title:d.title,poster_url:d.poster_path?`https://image.tmdb.org/t/p/w500${d.poster_path}`:null,backdrop_url:d.backdrop_path?`https://image.tmdb.org/t/p/original${d.backdrop_path}`:null,release_date:d.release_date,creator:d.creator,number_of_seasons:d.number_of_seasons,overview:d.overview,genres:d.genres,cast:d.cast,status:d.status,original_language:d.original_language,networks:d.networks,production_companies:d.production_companies,crew:d.crew,last_air_date:d.last_episode_to_air?.air_date||null,next_episode_date:d.next_episode_to_air?.air_date||null},{onConflict:"tmdb_id"})}async function z(a){let b=await (0,e.createAdminClient)(),{data:c}=await b.from("people").select("tmdb_id, updated_at").eq("tmdb_id",a).maybeSingle();if(!(!c||!c.updated_at||Date.now()-new Date(c.updated_at).getTime()>6048e5))return;let d=await w(a);await b.from("people").upsert({tmdb_id:d.id,name:d.name,adult:d.adult,biography:d.biography,birthday:d.birthday||null,deathday:d.deathday||null,place_of_birth:d.place_of_birth,profile_path:d.profile_path,known_for_department:d.known_for_department,gender:d.gender,also_known_as:d.also_known_as,updated_at:new Date().toISOString()},{onConflict:"tmdb_id"})}(0,g.ensureServerEntryExports)([k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z]),(0,b.registerServerReference)(k,"60e8b872f629aa0faabbb3ca96b548897d1733ef31",null),(0,b.registerServerReference)(l,"405874440a1b09bc8e4b129305e5e968566e7cd436",null),(0,b.registerServerReference)(m,"003e8b396fa0a6461ff46d1f980f0f3e445e689b86",null),(0,b.registerServerReference)(n,"00a999dd3a2ed866392a2daecbf6615075f1c00a72",null),(0,b.registerServerReference)(o,"00fdca6daa5e04389180b37535e8274fa77914a78e",null),(0,b.registerServerReference)(p,"0069116b61067c2a5f8dd123ea37c09c7b43899146",null),(0,b.registerServerReference)(q,"007ef9010c76a0a35f1c51b8800bed2350a67fa999",null),(0,b.registerServerReference)(r,"00eb7c54fe2cf91eb54bd5fa902a34910b66c49f4d",null),(0,b.registerServerReference)(s,"00965b16e469e1226fd945267c2682d2c72c20d17c",null),(0,b.registerServerReference)(t,"405e463565a416ddc436c5e3f95a4089cc71100a55",null),(0,b.registerServerReference)(u,"402603549cdfd9882438516ae21e193481ebd6860c",null),(0,b.registerServerReference)(v,"40a5cd89d9bb290a544cbc62c297de5defda4be1ab",null),(0,b.registerServerReference)(w,"401eedccfe768d7030b1d49e8f092b2f44eaa41678",null),(0,b.registerServerReference)(x,"403a6fad28aa92529a7090c2ea0a51aada25351958",null),(0,b.registerServerReference)(y,"401909457587245232eaca27671fff58b3c730d6f1",null),(0,b.registerServerReference)(z,"40fb56760a01431cb2e97982c2fa791381c0a1f8e2",null),a.s(["cacheMovie",()=>x,"cachePerson",()=>z,"cacheSeries",()=>y,"discoverMedia",()=>l,"fetchTmdbList",()=>k,"getDiscoverAnime",()=>r,"getDiscoverKdramas",()=>s,"getMovieDetails",()=>u,"getPersonDetails",()=>w,"getPopularMovies",()=>p,"getPopularTv",()=>q,"getRegionalDiscoverSections",()=>m,"getSeriesDetails",()=>v,"getTrendingAll",()=>o,"getTrendingHero",()=>n,"searchCinematic",()=>t])}];

//# sourceMappingURL=lib_actions_cinematic-actions_ts_b50f15fa._.js.map